{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///medium-editor-insert.min.js","webpack:///webpack/bootstrap 2696e09bc5e1b516dcb2","webpack:///./src/js/Plugin.js","webpack:///./src/js/utils.js","webpack:///./src/js/Toolbar.js","webpack:///./src/js/Core.js","webpack:///./src/js/ToolbarButton.js","webpack:///./src/js/addons/Embeds.js","webpack:///./src/js/addons/Images.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_Core","_Core2","MediumEditorInsert","MediumEditor","Extension","extend","name","addons","images","embeds","_initializedAddons","init","prototype","apply","arguments","core","destroy","removeButtons","getCore","getAddons","getAddon","utils","ucfirst","str","charAt","toUpperCase","slice","generateRandomString","length","undefined","Math","random","toString","substr","getClosestWithClassName","el","className","util","traverseUp","element","classList","contains","isChildOf","parent","getElementsByClassName","parents","results","Array","forEach","editor","elements","push","getElementsByTagName","tagName","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","descriptor","key","protoProps","staticProps","_utils","_utils2","_ToolbarButton","_ToolbarButton2","MediumEditorToolbar","extensions","toolbar","Toolbar","_MediumEditorToolbar","options","_this","getPrototypeOf","type","buttons","buttonOptions","button","assign","window","plugin","document","base","createElement","getEditorId","static","relativeContainer","appendChild","createToolbarButtons","forEachExtension","extension","hasForm","getForm","attachEventHandlers","_this2","ul","li","btn","buttonName","buttonOpts","style","display","addBuiltInExtension","getButton","isElement","innerHTML","querySelectorAll","add","firstButtonClass","lastButtonClass","_this3","activeElements","preventSelectionUpdates","setTimeout","getEditorElements","activeClassName","hideToolbar","showAndUpdateToolbar","container","anchorPreview","showToolbar","positionStaticToolbar","getExtensionByName","hidePreview","_Images","_Images2","_Embeds","_Embeds2","Core","_plugin","_editor","initAddons","addButtons","events","addonActions","on","toggleButtons","bind","toggleAddons","action","handleAddonClick","positionButtons","keys","addonOptions","console","error","html","setAttribute","addon","label","body","remove","elPosition","addonButton","addonsStyle","addonButtonStyle","position","getSelectedParentElement","getBoundingClientRect","getComputedStyle","top","scrollY","left","scrollX","parseInt","marginLeft","shouldDisplayButtonsOnElement","selectElement","showButtons","hideButtons","addonClassNames","isAddon","belongsToEditor","innerText","trim","addonName","elementClassName","selectedElement","toggle","e","currentTarget","getAttribute","preventDefault","handleClick","ToolbarButton","onClick","_Toolbar","_Toolbar2","Embeds","placeholder","oembedProxy","captions","captionPlaceholder","storeMeta","styles","wide","right","actions","clicked","parseOnPaste","onChange","log","placeholderClassName","loadingClassName","descriptionContainerClassName","descriptionClassName","overlayClassName","alignLeftClassName","alignRightClassName","alignCenterClassName","alignCenterWideClassName","alignCenterFullClassName","descriptionPlaceholder","initToolbar","unselectEmbed","handleKey","selectEmbed","selectEmbedCore","selectedEl","activeEmbedElement","clickedEmbed","embed","nextSiblingDOM","nextSibling","nextSiblingParagraphDOM","isDescriptionElement","keyCode","ENTER","indexOf","which","BACKSPACE","DELETE","removeEmbed","selectedEmbedDOM","querySelector","getSiblingParagraph","paragraph","insertAdjacentElement","getSelection","removeAllRanges","selection","clearSelection","instanceHandlePaste","handlePaste","instanceHandleKeyDown","handleKeyDown","handleBlur","focus","evt","cancelEmbed","pastedUrl","clipboardData","getData","linkRegEx","RegExp","linkRegEx2","test","oembed","parseUrl","changeAlign","setToolbarPosition","url","pasted","_this4","urlOut","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","data","JSON","parse","responseText","send","join","replace","info","figure","descriptionContainer","description","metacontainer","overlay","lastEl","contentEditable","dataset","replaceWith","parentNode","lastChild","nodeType","previousSibling","lastP","FB","XFBML","onInsert","removeAttribute","hidePlaceholder","off","instanceHandleKeyUp","Images","preview","uploadUrl","deleteUrl","deleteMethod","deleteData","activeImageElement","unselectImage","selectImage","onInsertButtonClick","uid","imageUrl","insertImage","_input","multiple","uploadFiles","click","title","selectImageCore","files","file","upload","_this5","reader","FileReader","onload","result","readAsDataURL","FormData","append","isLoader","nodeName","toLowerCase","div","insertBefore","image","replaceImage","addImage","_this6","img","domImage","alt","match","src","Image","addParagraph","_this7","clickedImage","activeImage","removeImage","selectedImageDOM","selectedImageParentDOM","_this8","selectedHtml","rangeCount","range","getSelectionRange","focusedElement","caretPosition","getCaretOffsets","sibling","previousElementSibling","nextElementSibling","newImages","getSelectionHtml","temp","wrappers","wrapper","deleteFile","childElementCount","next","prev","moveCursor","textContent"],"mappings":"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","file":"medium-editor-insert.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MediumEditorInsert\"] = factory();\n\telse\n\t\troot[\"MediumEditorInsert\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MediumEditorInsert\"] = factory();\n\telse\n\t\troot[\"MediumEditorInsert\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _Core = __webpack_require__(3);\n\t\n\tvar _Core2 = _interopRequireDefault(_Core);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar MediumEditorInsert = MediumEditor.Extension.extend({\n\t    name: 'insert',\n\t\n\t    addons: {\n\t        images: true,\n\t        embeds: true\n\t    },\n\t\n\t    _initializedAddons: {},\n\t\n\t    init: function init() {\n\t        MediumEditor.Extension.prototype.init.apply(this, arguments);\n\t\n\t        this.core = new _Core2.default(this);\n\t    },\n\t\n\t    destroy: function destroy() {\n\t        this.core.removeButtons();\n\t    },\n\t\n\t    getCore: function getCore() {\n\t        return this.core;\n\t    },\n\t\n\t    getAddons: function getAddons() {\n\t        return this._initializedAddons;\n\t    },\n\t\n\t    getAddon: function getAddon(name) {\n\t        return this._initializedAddons[name];\n\t    }\n\t});\n\t\n\texports.default = MediumEditorInsert;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar utils = {\n\t    ucfirst: function ucfirst(str) {\n\t        return str.charAt(0).toUpperCase() + str.slice(1);\n\t    },\n\t\n\t    generateRandomString: function generateRandomString() {\n\t        var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 15;\n\t\n\t        return Math.random().toString(36).substr(2, length);\n\t    },\n\t\n\t    getClosestWithClassName: function getClosestWithClassName(el, className) {\n\t        return MediumEditor.util.traverseUp(el, function (element) {\n\t            return element.classList.contains(className);\n\t        });\n\t    },\n\t\n\t    isChildOf: function isChildOf(el, parent) {\n\t        return MediumEditor.util.traverseUp(el, function (element) {\n\t            return element === parent;\n\t        }) ? true : false;\n\t    },\n\t\n\t    getElementsByClassName: function getElementsByClassName(parents, className) {\n\t        var results = [];\n\t\n\t        Array.prototype.forEach.call(parents, function (editor) {\n\t            var elements = editor.getElementsByClassName(className);\n\t\n\t            Array.prototype.forEach.call(elements, function (element) {\n\t                results.push(element);\n\t            });\n\t        });\n\t\n\t        return results;\n\t    },\n\t\n\t    getElementsByTagName: function getElementsByTagName(parents, tagName) {\n\t        var results = [];\n\t\n\t        Array.prototype.forEach.call(parents, function (editor) {\n\t            var elements = editor.getElementsByTagName(tagName);\n\t\n\t            Array.prototype.forEach.call(elements, function (element) {\n\t                results.push(element);\n\t            });\n\t        });\n\t\n\t        return results;\n\t    }\n\t};\n\t\n\texports.default = utils;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _ToolbarButton = __webpack_require__(4);\n\t\n\tvar _ToolbarButton2 = _interopRequireDefault(_ToolbarButton);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar MediumEditorToolbar = MediumEditor.extensions.toolbar;\n\t\n\tvar Toolbar = function (_MediumEditorToolbar) {\n\t    _inherits(Toolbar, _MediumEditorToolbar);\n\t\n\t    function Toolbar(options) {\n\t        _classCallCheck(this, Toolbar);\n\t\n\t        var _this = _possibleConstructorReturn(this, (Toolbar.__proto__ || Object.getPrototypeOf(Toolbar)).call(this, options));\n\t\n\t        _this.name = options.type + 'Toolbar';\n\t\n\t        options.buttons.forEach(function (buttonOptions) {\n\t            var button = new _ToolbarButton2.default(Object.assign({}, {\n\t                window: _this.plugin.window,\n\t                document: _this.plugin.document,\n\t                base: _this.plugin.base\n\t            }, buttonOptions));\n\t\n\t            button.init();\n\t            _this.plugin.base.extensions.push(button);\n\t        });\n\t\n\t        _this.window = options.plugin.window;\n\t        _this.document = options.plugin.document;\n\t        _this.base = options.plugin.base;\n\t\n\t        _this.init();\n\t        return _this;\n\t    }\n\t\n\t    _createClass(Toolbar, [{\n\t        key: 'createToolbar',\n\t        value: function createToolbar() {\n\t            var toolbar = this.document.createElement('div');\n\t\n\t            toolbar.id = 'medium-editor-insert-' + this.type + '-toolbar-' + this.getEditorId();\n\t            toolbar.className = 'medium-editor-toolbar';\n\t\n\t            if (this.static) {\n\t                toolbar.className += ' static-toolbar';\n\t            } else if (this.relativeContainer) {\n\t                toolbar.className += ' medium-editor-relative-toolbar';\n\t            } else {\n\t                toolbar.className += ' medium-editor-stalker-toolbar';\n\t            }\n\t\n\t            toolbar.appendChild(this.createToolbarButtons());\n\t\n\t            // Add any forms that extensions may have\n\t            this.forEachExtension(function (extension) {\n\t                if (extension.hasForm) {\n\t                    toolbar.appendChild(extension.getForm());\n\t                }\n\t            });\n\t\n\t            this.attachEventHandlers();\n\t\n\t            return toolbar;\n\t        }\n\t    }, {\n\t        key: 'createToolbarButtons',\n\t        value: function createToolbarButtons() {\n\t            var _this2 = this;\n\t\n\t            var ul = this.document.createElement('ul');\n\t            var li = void 0,\n\t                btn = void 0,\n\t                buttons = void 0,\n\t                extension = void 0,\n\t                buttonName = void 0,\n\t                buttonOpts = void 0;\n\t\n\t            ul.id = 'medium-editor-insert-' + this.type + '-toolbar-actions' + this.getEditorId();\n\t            ul.className = 'medium-editor-toolbar-actions';\n\t            ul.style.display = 'block';\n\t\n\t            this.buttons.forEach(function (button) {\n\t                if (typeof button === 'string') {\n\t                    buttonName = button;\n\t                    buttonOpts = null;\n\t                } else {\n\t                    buttonName = button.name;\n\t                    buttonOpts = button;\n\t                }\n\t\n\t                // If the button already exists as an extension, it'll be returned\n\t                // othwerise it'll create the default built-in button\n\t                extension = _this2.base.addBuiltInExtension(buttonName, buttonOpts);\n\t\n\t                if (extension && typeof extension.getButton === 'function') {\n\t                    btn = extension.getButton(_this2.base);\n\t                    li = _this2.document.createElement('li');\n\t                    if (MediumEditor.util.isElement(btn)) {\n\t                        li.appendChild(btn);\n\t                    } else {\n\t                        li.innerHTML = btn;\n\t                    }\n\t                    ul.appendChild(li);\n\t                }\n\t            }, this);\n\t\n\t            buttons = ul.querySelectorAll('button');\n\t            if (buttons.length > 0) {\n\t                buttons[0].classList.add(this.firstButtonClass);\n\t                buttons[buttons.length - 1].classList.add(this.lastButtonClass);\n\t            }\n\t\n\t            return ul;\n\t        }\n\t    }, {\n\t        key: 'checkState',\n\t        value: function checkState() {\n\t            var _this3 = this;\n\t\n\t            var activeElements = void 0;\n\t\n\t            if (this.base.preventSelectionUpdates) {\n\t                return;\n\t            }\n\t\n\t            // Wait for elements to be selected\n\t            setTimeout(function () {\n\t                activeElements = _utils2.default.getElementsByClassName(_this3.getEditorElements(), _this3.activeClassName);\n\t\n\t                // Hide toolbar when no elements are selected\n\t                if (activeElements.length === 0) {\n\t                    return _this3.hideToolbar();\n\t                }\n\t\n\t                // Now we know there's a focused editable with a selection\n\t                _this3.showAndUpdateToolbar();\n\t            }, 10);\n\t        }\n\t    }, {\n\t        key: 'setToolbarPosition',\n\t        value: function setToolbarPosition() {\n\t            var container = _utils2.default.getElementsByClassName(this.getEditorElements(), this.activeClassName)[0];\n\t            var anchorPreview = void 0;\n\t\n\t            // If there isn't a valid selection, bail\n\t            if (!container) {\n\t                return this;\n\t            }\n\t\n\t            this.showToolbar();\n\t            this.positionStaticToolbar(container);\n\t\n\t            anchorPreview = this.base.getExtensionByName('anchor-preview');\n\t\n\t            if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n\t                anchorPreview.hidePreview();\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return Toolbar;\n\t}(MediumEditorToolbar);\n\t\n\texports.default = Toolbar;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Images = __webpack_require__(6);\n\t\n\tvar _Images2 = _interopRequireDefault(_Images);\n\t\n\tvar _Embeds = __webpack_require__(5);\n\t\n\tvar _Embeds2 = _interopRequireDefault(_Embeds);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Core = function () {\n\t    function Core(plugin) {\n\t        _classCallCheck(this, Core);\n\t\n\t        this._plugin = plugin;\n\t        this._editor = this._plugin.base;\n\t\n\t        this.initAddons();\n\t        this.addButtons();\n\t        this.events();\n\t    }\n\t\n\t    _createClass(Core, [{\n\t        key: 'events',\n\t        value: function events() {\n\t            var _this = this;\n\t\n\t            var addonActions = void 0;\n\t\n\t            // This could be chained when medium-editor 5.15.2 is released\n\t            // https://github.com/yabwe/medium-editor/pull/1046\n\t            this._plugin.on(document, 'click', this.toggleButtons.bind(this));\n\t            this._plugin.on(document, 'keyup', this.toggleButtons.bind(this));\n\t            this._plugin.on(this.buttons.getElementsByClassName('medium-editor-insert-buttons-show')[0], 'click', this.toggleAddons.bind(this));\n\t\n\t            // This could be written in one statement when medium-editor 5.15.2 is released\n\t            // https://github.com/yabwe/medium-editor/pull/1046\n\t            addonActions = this.buttons.getElementsByClassName('medium-editor-insert-action');\n\t            Array.prototype.forEach.call(addonActions, function (action) {\n\t                _this._plugin.on(action, 'click', _this.handleAddonClick.bind(_this));\n\t            });\n\t\n\t            this._plugin.on(window, 'resize', this.positionButtons.bind(this));\n\t        }\n\t    }, {\n\t        key: 'initAddons',\n\t        value: function initAddons() {\n\t            var _this2 = this;\n\t\n\t            // Initialize all default addons, we'll delete ones we don't need later\n\t            this._plugin._initializedAddons = {\n\t                images: new _Images2.default(this._plugin, this._plugin.addons.images),\n\t                embeds: new _Embeds2.default(this._plugin, this._plugin.addons.embeds)\n\t            };\n\t\n\t            Object.keys(this._plugin.addons).forEach(function (name) {\n\t                var addonOptions = _this2._plugin.addons[name];\n\t\n\t                // If the addon is custom one\n\t                if (!_this2._plugin._initializedAddons[name]) {\n\t                    if (typeof addonOptions === 'function') {\n\t                        _this2._plugin._initializedAddons[name] = new addonOptions(_this2._plugin);\n\t                    } else {\n\t                        window.console.error('I don\\'t know how to initialize custom \"' + name + '\" addon!');\n\t                    }\n\t                }\n\t\n\t                // Delete disabled addon\n\t                if (!addonOptions) {\n\t                    delete _this2._plugin._initializedAddons[name];\n\t                }\n\t            });\n\t        }\n\t    }, {\n\t        key: 'addButtons',\n\t        value: function addButtons() {\n\t            var addons = this._plugin.getAddons();\n\t            var html = void 0;\n\t\n\t            this.buttons = document.createElement('div');\n\t            this.buttons.id = 'medium-editor-insert-' + this._plugin.getEditorId();\n\t            this.buttons.classList.add('medium-editor-insert-buttons');\n\t            this.buttons.setAttribute('contentediable', false);\n\t\n\t            html = '<a class=\"medium-editor-insert-buttons-show\">+</a>\\n            <ul class=\"medium-editor-insert-buttons-addons\">';\n\t\n\t            Object.keys(addons).forEach(function (name) {\n\t                var addon = addons[name];\n\t\n\t                html += '<li><a class=\"medium-editor-insert-action\" data-addon=\"' + name + '\">' + addon.label + '</a></li>';\n\t            });\n\t\n\t            html += '</ul>';\n\t\n\t            this.buttons.innerHTML = html;\n\t\n\t            document.body.appendChild(this.buttons);\n\t        }\n\t    }, {\n\t        key: 'removeButtons',\n\t        value: function removeButtons() {\n\t            this.buttons.remove();\n\t        }\n\t    }, {\n\t        key: 'positionButtons',\n\t        value: function positionButtons() {\n\t            var el = void 0,\n\t                elPosition = void 0,\n\t                addons = void 0,\n\t                addonButton = void 0,\n\t                addonsStyle = void 0,\n\t                addonButtonStyle = void 0,\n\t                position = void 0;\n\t\n\t            // Don't position buttons if they aren't active\n\t            if (this.buttons.classList.contains('medium-editor-insert-buttons-active') === false) {\n\t                return;\n\t            }\n\t\n\t            el = this._editor.getSelectedParentElement();\n\t            elPosition = el.getBoundingClientRect();\n\t            addons = this.buttons.getElementsByClassName('medium-editor-insert-buttons-addons')[0];\n\t            addonButton = this.buttons.getElementsByClassName('medium-editor-insert-action')[0];\n\t            addonsStyle = window.getComputedStyle(addons);\n\t            addonButtonStyle = window.getComputedStyle(addonButton);\n\t\n\t            // Calculate position\n\t            position = {\n\t                top: window.scrollY + elPosition.top,\n\t                left: window.scrollX + elPosition.left - parseInt(addonsStyle.left, 10) - parseInt(addonButtonStyle.marginLeft, 10)\n\t            };\n\t\n\t            // If left position is lower than 0, the buttons would be out of the viewport.\n\t            // In that case, align buttons with the editor\n\t            position.left = position.left < 0 ? elPosition.left : position.left;\n\t\n\t            this.buttons.style.left = position.left + 'px';\n\t            this.buttons.style.top = position.top + 'px';\n\t        }\n\t    }, {\n\t        key: 'toggleButtons',\n\t        value: function toggleButtons() {\n\t            var el = this._editor.getSelectedParentElement();\n\t\n\t            if (this.shouldDisplayButtonsOnElement(el)) {\n\t                this.selectElement(el);\n\t                this.showButtons();\n\t            } else {\n\t                this.hideButtons();\n\t            }\n\t        }\n\t    }, {\n\t        key: 'shouldDisplayButtonsOnElement',\n\t        value: function shouldDisplayButtonsOnElement(el) {\n\t            var addons = this._plugin.getAddons(),\n\t                addonClassNames = [];\n\t            var isAddon = false,\n\t                belongsToEditor = false;\n\t\n\t            // Don't show buttons when the element has text\n\t            if (el.innerText.trim() !== '') {\n\t                return false;\n\t            }\n\t\n\t            // Don't show buttons when the editor doesn't belong to editor\n\t            this._plugin.getEditorElements().forEach(function (editor) {\n\t                if (_utils2.default.isChildOf(el, editor)) {\n\t                    belongsToEditor = true;\n\t                    return;\n\t                }\n\t            });\n\t\n\t            if (!belongsToEditor) {\n\t                return false;\n\t            }\n\t\n\t            // Get class names used by addons\n\t            Object.keys(addons).forEach(function (addonName) {\n\t                var addon = addons[addonName];\n\t                if (addon.elementClassName) {\n\t                    addonClassNames.push(addon.elementClassName);\n\t                }\n\t            });\n\t\n\t            // Don't show buttons if the element is an addon element\n\t            // - when the element has an addon class, or some of its parents have it\n\t            addonClassNames.forEach(function (className) {\n\t                if (el.classList.contains(className) || _utils2.default.getClosestWithClassName(el, className)) {\n\t                    isAddon = true;\n\t                    return;\n\t                }\n\t            });\n\t\n\t            return !isAddon;\n\t        }\n\t    }, {\n\t        key: 'selectElement',\n\t        value: function selectElement(el) {\n\t            this.selectedElement = el;\n\t        }\n\t    }, {\n\t        key: 'showButtons',\n\t        value: function showButtons() {\n\t            this.buttons.classList.add('medium-editor-insert-buttons-active');\n\t            this.positionButtons();\n\t        }\n\t    }, {\n\t        key: 'hideButtons',\n\t        value: function hideButtons() {\n\t            this.buttons.classList.remove('medium-editor-insert-buttons-active');\n\t            this.buttons.classList.remove('medium-editor-insert-addons-active');\n\t        }\n\t    }, {\n\t        key: 'toggleAddons',\n\t        value: function toggleAddons() {\n\t            this.buttons.classList.toggle('medium-editor-insert-addons-active');\n\t        }\n\t    }, {\n\t        key: 'handleAddonClick',\n\t        value: function handleAddonClick(e) {\n\t            var name = e.currentTarget.getAttribute('data-addon');\n\t            e.preventDefault();\n\t\n\t            this._plugin.getAddon(name).handleClick(e);\n\t            this.hideButtons();\n\t        }\n\t    }]);\n\t\n\t    return Core;\n\t}();\n\t\n\texports.default = Core;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar ToolbarButton = MediumEditor.extensions.button.extend({\n\t    init: function init() {\n\t        this.button = this.document.createElement('button');\n\t        this.button.classList.add('medium-editor-action');\n\t        this.button.classList.add(this.className);\n\t        this.button.innerHTML = '<b>' + this.label + '</b>';\n\t\n\t        this.on(this.button, 'click', this.handleClick.bind(this));\n\t    },\n\t\n\t    getButton: function getButton() {\n\t        return this.button;\n\t    },\n\t\n\t    handleClick: function handleClick() {\n\t        this.onClick();\n\t    }\n\t});\n\t\n\texports.default = ToolbarButton;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Embeds = function () {\n\t  function Embeds(plugin, options) {\n\t    _classCallCheck(this, Embeds);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-youtube-play\"></span>',\n\t      placeholder: 'Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter',\n\t      oembedProxy: 'http://medium.iframe.ly/api/oembed?omit_script=1&iframe=1',\n\t      captions: true,\n\t      captionPlaceholder: 'Type caption (optional)',\n\t      storeMeta: false,\n\t      styles: {\n\t        wide: {\n\t          label: '<span class=\"fa fa-align-justify\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        },\n\t        left: {\n\t          label: '<span class=\"fa fa-align-left\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        },\n\t        right: {\n\t          label: '<span class=\"fa fa-align-right\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        }\n\t      },\n\t      actions: {\n\t        remove: {\n\t          label: '<span class=\"fa fa-times\"></span>',\n\t          clicked: function clicked() {\n\t            // var $event = $.Event('keydown');\n\t\n\t            // $event.which = 8;\n\t            // $(document).trigger($event);\n\t          }\n\t        }\n\t      },\n\t      parseOnPaste: false,\n\t      onChange: function onChange(action) {\n\t        console.log('Embed change: ', action);\n\t      }\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t\n\t    this.activeClassName = 'medium-editor-insert-embeds-active';\n\t    this.placeholderClassName = 'medium-editor-insert-embeds-placeholder';\n\t    this.elementClassName = 'medium-editor-insert-embeds';\n\t    this.loadingClassName = 'medium-editor-insert-embeds-loading';\n\t    this.activeClassName = 'medium-editor-insert-embed-active';\n\t    this.descriptionContainerClassName = 'medium-editor-embed-embed-description-container';\n\t    this.descriptionClassName = 'medium-editor-embed-embed-description';\n\t    this.overlayClassName = 'medium-editor-insert-embeds-overlay';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignRightClassName = 'align-right';\n\t    this.alignCenterClassName = 'align-center';\n\t    this.alignCenterWideClassName = 'align-center-wide';\n\t    this.alignCenterFullClassName = 'align-center-full';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t\n\t    this.initToolbar();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Embeds, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectEmbed.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'selectEmbed',\n\t    value: function selectEmbed(e) {\n\t      var el = e.target;\n\t      this.selectEmbedCore(el);\n\t    }\n\t  }, {\n\t    key: 'selectEmbedCore',\n\t    value: function selectEmbedCore(el) {\n\t      if (el.classList.contains(this.overlayClassName)) {\n\t        var selectedEl = _utils2.default.getClosestWithClassName(el, this.elementClassName);\n\t        if (!selectedEl.classList.contains(this.loadingClassName)) {\n\t          selectedEl.classList.add(this.activeClassName);\n\t          this._editor.selectElement(selectedEl);\n\t          this.activeEmbedElement = selectedEl;\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'unselectEmbed',\n\t    value: function unselectEmbed(e) {\n\t      var _this2 = this;\n\t\n\t      var el = e.target;\n\t      var clickedEmbed = void 0,\n\t          clickedEmbedPlaceholder = void 0,\n\t          embeds = void 0,\n\t          embedsPlaceholders = void 0;\n\t\n\t      if (el.classList.contains(this.descriptionClassName)) return false;\n\t\n\t      embeds = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\t\n\t      if (!embeds || !embeds.length) {\n\t        return false;\n\t      }\n\t\n\t      // Unselect all selected images. If an image is clicked, unselect all except this one.\n\t      if (el.classList.contains(this.overlayClassName)) {\n\t        clickedEmbed = _utils2.default.getClosestWithClassName(el, this.elementClassName);\n\t      }\n\t\n\t      if (embeds) {\n\t        Array.prototype.forEach.call(embeds, function (embed) {\n\t          if (embed !== clickedEmbed) {\n\t            embed.classList.remove(_this2.activeClassName);\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t      var isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\t\n\t      // Enter key in description\n\t      if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n\t        if (isDescriptionElement) {\n\t          e.preventDefault();\n\t        }\n\t      }\n\t\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n\t        this.removeEmbed(e);\n\t      }\n\t\n\t      // Down, enter\n\t      if (e.which === 40 || e.which === 13) {\n\t        // Detect selected image\n\t        var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t\n\t        if (selectedEmbedDOM) {\n\t          var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (!nextSiblingParagraphDOM) {\n\t            // Insert paragraph and focus\n\t            var paragraph = document.createElement('p');\n\t            paragraph.innerHTML = '<br>';\n\t            selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n\t          }\n\t\n\t          // Focus next paragraph\n\t          nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (nextSiblingParagraphDOM) {\n\t            if (!nextSiblingParagraphDOM.innerHTML) {\n\t              nextSiblingParagraphDOM.innerHTML = '<br>';\n\t            }\n\t            window.getSelection().removeAllRanges();\n\t            this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n\t            selectedEmbedDOM.classList.remove(this.activeClassName);\n\t            MediumEditor.selection.clearSelection(document, true);\n\t            selectedEmbedDOM.classList.remove(this.activeClassName);\n\t            e.preventDefault();\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      this.el = this._plugin.getCore().selectedElement;\n\t      this.el.classList.add(this.loadingClassName);\n\t      this.el.classList.add(this.placeholderClassName);\n\t      this.el.setAttribute('data-placeholder', this.options.placeholder);\n\t\n\t      this.instanceHandlePaste = this.handlePaste.bind(this);\n\t      this.instanceHandleKeyDown = this.handleKeyDown.bind(this);\n\t\n\t      this._plugin.on(document, 'paste', this.instanceHandlePaste);\n\t      this._plugin.on(document, 'keydown', this.instanceHandleKeyDown);\n\t\n\t      // FIXME: it doesn't work yet.  :(\n\t      this._plugin.on(this.el, 'blur', this.handleBlur.bind(this));\n\t\n\t      // this._plugin.getCore().hideButtons();\n\t\n\t      // return focus to element, allow user to cancel embed by start writing\n\t      this._editor.elements[0].focus();\n\t      this.el.focus();\n\t\n\t      // this._editor.selectElement(this.el);\n\t      // console.log( this._editor.selection );\n\t    }\n\t  }, {\n\t    key: 'handleKeyDown',\n\t    value: function handleKeyDown(evt) {\n\t      if (evt.which !== 17 && evt.which !== 91 && evt.which !== 224 // Cmd or Ctrl pressed (user probably preparing to paste url via hot keys)\n\t      && (evt.which === 27 || this._plugin.selectedElement !== this.el)) {\n\t        // Escape\n\t        this.cancelEmbed();\n\t        return false;\n\t      }\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'handlePaste',\n\t    value: function handlePaste(evt) {\n\t      var pastedUrl = evt.clipboardData.getData('text');\n\t      var linkRegEx = new RegExp('^(http(s?):)?\\/\\/', 'i');\n\t      var linkRegEx2 = new RegExp('^(www\\.)?', 'i');\n\t\n\t      if (linkRegEx.test(pastedUrl) || linkRegEx2.test(pastedUrl)) {\n\t        var html = this.options.oembedProxy ? this.oembed(pastedUrl, true) : this.parseUrl(pastedUrl, true);\n\t      }\n\t\n\t      this.cancelEmbed();\n\t    }\n\t  }, {\n\t    key: 'removeEmbed',\n\t    value: function removeEmbed(e) {\n\t      var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t      if (selectedEmbedDOM) {\n\t        selectedEmbedDOM.remove();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Init Toolbar for tuning embed position\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {\n\t      this.toolbar = new _Toolbar2.default({\n\t        plugin: this._plugin,\n\t        type: 'embeds',\n\t        activeClassName: this.activeClassName,\n\t        buttons: [{\n\t          name: 'embed-align-left',\n\t          action: 'align-left',\n\t          className: 'btn-align-left',\n\t          label: 'Left',\n\t          onClick: function () {\n\t            this.changeAlign(this.alignLeftClassName, 'embed-align-left');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center',\n\t          action: 'align-center',\n\t          className: 'btn-align-center',\n\t          label: 'Center',\n\t          onClick: function () {\n\t            this.changeAlign(this.alignCenterClassName, 'embed-align-center');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center-wide',\n\t          action: 'align-center-wide',\n\t          className: 'btn-align-center-wide',\n\t          label: 'Wide',\n\t          onClick: function () {\n\t            this.changeAlign(this.alignCenterWideClassName, 'embed-align-center-wide');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center-full',\n\t          action: 'align-center-full',\n\t          className: 'btn-align-center-full',\n\t          label: 'Full',\n\t          onClick: function () {\n\t            this.changeAlign(this.alignCenterFullClassName, 'embed-align-center-full');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-right',\n\t          action: 'align-right',\n\t          className: 'btn-align-right',\n\t          label: 'Right',\n\t          onClick: function () {\n\t            this.changeAlign(this.alignRightClassName, 'embed-align-right');\n\t          }.bind(this)\n\t        }]\n\t      });\n\t\n\t      this._editor.extensions.push(this.toolbar);\n\t    }\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action) {\n\t      var _this3 = this;\n\t\n\t      var el = this.activeEmbedElement;\n\t      el.classList.remove(this.alignLeftClassName, this.alignRightClassName, this.alignCenterClassName, this.alignCenterWideClassName, this.alignCenterFullClassName);\n\t      el.classList.add(className);\n\t\n\t      this.toolbar.setToolbarPosition();\n\t      setTimeout(function () {\n\t        _this3.selectEmbedCore(el.querySelector('.' + _this3.overlayClassName));\n\t      }, 0);\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Get HTML via oEmbed proxy\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'oembed',\n\t    value: function oembed(url, pasted) {\n\t      var _this4 = this;\n\t\n\t      var urlOut = this.options.oembedProxy + '&url=' + url;\n\t      var xhr = new XMLHttpRequest();\n\t\n\t      // console.log(urlOut);\n\t      xhr.open(\"GET\", urlOut, true);\n\t      xhr.onreadystatechange = function () {\n\t        if (xhr.readyState === 4 && xhr.status === 200) {\n\t          var data = JSON.parse(xhr.responseText);\n\t          _this4.embed(data.html, url, data);\n\t        }\n\t      };\n\t\n\t      xhr.send();\n\t\n\t      return true;\n\t    }\n\t\n\t    /**\n\t     * Get HTML using regexp\n\t     *\n\t     * @param {string} url\n\t     * @param {bool} pasted\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'parseUrl',\n\t    value: function parseUrl(url, pasted) {\n\t      var html = void 0;\n\t\n\t      if (!new RegExp(['youtube', 'youtu.be', 'vimeo', 'instagram', 'twitter', 'facebook'].join('|')).test(url)) {\n\t        // $.proxy(this, 'convertBadEmbed', url)();\n\t        return false;\n\t      }\n\t\n\t      html = url.replace(/\\n?/g, '').replace(/^((http(s)?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be)\\/(watch\\?v=|v\\/)?)([a-zA-Z0-9\\-_]+)(.*)?$/, '<div class=\"video video-youtube\"><iframe width=\"420\" height=\"315\" src=\"//www.youtube.com/embed/$7\" frameborder=\"0\" allowfullscreen></iframe></div>').replace(/^https?:\\/\\/vimeo\\.com(\\/.+)?\\/([0-9]+)$/, '<div class=\"video video-vimeo\"><iframe src=\"//player.vimeo.com/video/$2\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').replace(/^https:\\/\\/twitter\\.com\\/(\\w+)\\/status\\/(\\d+)\\/?$/, '<blockquote class=\"twitter-tweet\" align=\"center\" lang=\"en\"><a href=\"https://twitter.com/$1/statuses/$2\"></a></blockquote><script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>').replace(/^(https:\\/\\/www\\.facebook\\.com\\/(.*))$/, '<script src=\"//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2\" async></script><div class=\"fb-post\" data-href=\"$1\"><div class=\"fb-xfbml-parse-ignore\"><a href=\"$1\">Loading Facebook post...</a></div></div>').replace(/^https?:\\/\\/instagram\\.com\\/p\\/(.+)\\/?$/, '<span class=\"instagram\"><iframe src=\"//instagram.com/p/$1/embed/\" width=\"612\" height=\"710\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe></span>');\n\t\n\t      if (/<(\"[^\"]*\"|'[^']*'|[^'\">])*>/.test(html) === false) {\n\t        // $.proxy(this, 'convertBadEmbed', url)();\n\t        return false;\n\t      }\n\t\n\t      if (pasted) {\n\t        return this.embed(html, url);\n\t      } else {\n\t        return this.embed(html);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'embed',\n\t\n\t\n\t    /**\n\t     * Add html to page\n\t     *\n\t     * @param {string} html\n\t     * @param {string} pastedUrl\n\t     * @return {void}\n\t     */\n\t\n\t    value: function embed(html, pastedUrl, info) {\n\t      var el = void 0,\n\t          figure = void 0,\n\t          descriptionContainer = void 0,\n\t          description = void 0,\n\t          metacontainer = void 0,\n\t          container = void 0,\n\t          overlay = void 0,\n\t          lastEl = void 0,\n\t          paragraph = void 0;\n\t\n\t      if (!html) {\n\t        console.error('Incorrect URL format specified: ', pastedUrl);\n\t        return false;\n\t      }\n\t\n\t      if (info && info.type === 'link') {\n\t        console.error('Just common link  no any embeds to insert: ', pastedUrl);\n\t        return false;\n\t      }\n\t\n\t      el = this._plugin.getCore().selectedElement;\n\t      figure = document.createElement('figure');\n\t      figure.classList.add('medium-editor-insert-embeds-item');\n\t\n\t      descriptionContainer = document.createElement('div');\n\t      descriptionContainer.classList.add(this.descriptionContainerClassName);\n\t\n\t      description = document.createElement('figcaption');\n\t      description.classList.add(this.descriptionClassName);\n\t      description.setAttribute('contenteditable', true);\n\t      description.setAttribute('data-placeholder', 'Type caption for embed (optional)');\n\t\n\t      metacontainer = document.createElement('div');\n\t      metacontainer.classList.add(this.elementClassName);\n\t      metacontainer.classList.add(this.alignCenterClassName);\n\t      paragraph = document.createElement('p');\n\t      paragraph.innerHTML = '<br>';\n\t\n\t      // metacontainer.classList.add(this.activeClassName);\n\t\n\t      metacontainer.setAttribute('contenteditable', false);\n\t\n\t      container = document.createElement('div');\n\t      container.classList.add('medium-editor-insert-embeds-item-container');\n\t\n\t      overlay = document.createElement('div');\n\t      overlay.classList.add(this.overlayClassName);\n\t\n\t      metacontainer.appendChild(figure);\n\t      figure.appendChild(container);\n\t      figure.appendChild(overlay);\n\t\n\t      descriptionContainer.classList.add(this.descriptionContainerClassName);\n\t      description.contentEditable = true;\n\t      description.classList.add(this.descriptionClassName);\n\t      description.dataset.placeholder = this.descriptionPlaceholder;\n\t\n\t      el.replaceWith(metacontainer);\n\t      // Insert a empty paragraph\n\t      if (!el.nextSibling) {\n\t        el.insertAdjacentElement('afterend', paragraph);\n\t      }\n\t\n\t      // check if embed is last element, then add one more p after it\n\t      lastEl = metacontainer.parentNode.lastChild;\n\t\n\t      while (lastEl && lastEl.nodeType !== 1) {\n\t        lastEl = lastEl.previousSibling;\n\t      }\n\t\n\t      if (lastEl === metacontainer) {\n\t        var lastP = document.createElement('p');\n\t        lastP.appendChild(document.createElement('br'));\n\t        metacontainer.parentNode.appendChild(lastP);\n\t      }\n\t\n\t      container.innerHTML = html;\n\t\n\t      this._editor.selectElement(metacontainer);\n\t\n\t      // console.log(html);\n\t      // this.core.triggerInput();\n\t\n\t      if (html.indexOf('facebook') !== -1) {\n\t        if (typeof FB !== 'undefined') {\n\t          setTimeout(function () {\n\t            FB.XFBML.parse();\n\t          }, 2000);\n\t        }\n\t      }\n\t\n\t      this.options.onInsert && this.options.onInsert(html);\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'handleBlur',\n\t    value: function handleBlur() {\n\t      console.log('blur');\n\t      // this.cancelEmbed();\n\t    }\n\t  }, {\n\t    key: 'hidePlaceholder',\n\t    value: function hidePlaceholder() {\n\t      this.el.removeAttribute('data-placeholder');\n\t      this.el.classList.remove('medium-editor-insert-embeds-placeholder');\n\t    }\n\t  }, {\n\t    key: 'cancelEmbed',\n\t    value: function cancelEmbed() {\n\t      this.hidePlaceholder();\n\t      this.el.classList.remove('medium-editor-insert-embeds-active');\n\t\n\t      this._plugin.off(document, 'paste', this.instanceHandlePaste);\n\t      this._plugin.off(document, 'keyup', this.instanceHandleKeyUp);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this.cancelEmbed();\n\t    }\n\t  }]);\n\t\n\t  return Embeds;\n\t}();\n\t\n\texports.default = Embeds;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Images = function () {\n\t  function Images(plugin, options) {\n\t    _classCallCheck(this, Images);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-camera\"></span>',\n\t      preview: true,\n\t      uploadUrl: 'upload.php',\n\t      deleteUrl: 'delete.php',\n\t      deleteMethod: 'DELETE',\n\t      deleteData: {},\n\t      onChange: function onChange(action) {\n\t        console.log('Image change: ', action);\n\t      }\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t    this.elementClassName = 'medium-editor-insert-images';\n\t    this.loadingClassName = 'medium-editor-insert-images-loading';\n\t    this.activeClassName = 'medium-editor-insert-image-active';\n\t    this.descriptionContainerClassName = 'medium-editor-embed-image-description-container';\n\t    this.descriptionClassName = 'medium-editor-embed-image-description';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignRightClassName = 'align-right';\n\t    this.alignCenterClassName = 'align-center';\n\t    this.alignCenterWideClassName = 'align-center-wide';\n\t    this.alignCenterFullClassName = 'align-center-full';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t    this.activeImageElement = null;\n\t    this.initToolbar();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Images, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectImage.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectImage.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      var _this2 = this;\n\t\n\t      if (this.options.onInsertButtonClick) {\n\t        var uid = _utils2.default.generateRandomString();\n\t        this.options.onInsertButtonClick(function (imageUrl) {\n\t          return _this2.insertImage(imageUrl, uid);\n\t        }, function (imageUrl) {\n\t          return _this2.insertImage(imageUrl, uid, true);\n\t        });\n\t      } else {\n\t        this._input = document.createElement('input');\n\t        this._input.type = 'file';\n\t        this._input.multiple = true;\n\t        this._plugin.on(this._input, 'change', this.uploadFiles.bind(this));\n\t        this._input.click();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {\n\t      this.toolbar = new _Toolbar2.default({\n\t        plugin: this._plugin,\n\t        type: 'images',\n\t        activeClassName: this.activeClassName,\n\t        buttons: [{\n\t          name: 'image-align-left',\n\t          action: 'align-left',\n\t          className: 'btn-align-left',\n\t          label: 'Left',\n\t          title: 'Left',\n\t          onClick: function () {\n\t            this.changeAlign('align-left', 'image-align-left');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center',\n\t          action: 'align-center',\n\t          className: 'btn-align-center',\n\t          label: 'Center',\n\t          title: 'Center',\n\t          onClick: function () {\n\t            this.changeAlign('align-center', 'image-align-center');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center-wide',\n\t          action: 'align-center-wide',\n\t          className: 'btn-align-center-wide',\n\t          label: 'Wide',\n\t          title: 'Wide',\n\t          onClick: function () {\n\t            this.changeAlign('align-center-wide', 'image-align-center-wide');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center-full',\n\t          action: 'align-center-full',\n\t          className: 'btn-align-center-full',\n\t          label: 'Full',\n\t          title: 'Full wide',\n\t          onClick: function () {\n\t            this.changeAlign('align-center-full', 'image-align-center-full');\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-right',\n\t          action: 'align-right',\n\t          className: 'btn-align-right',\n\t          label: 'Right',\n\t          title: 'Right',\n\t          onClick: function () {\n\t            this.changeAlign('align-right', 'image-align-right');\n\t          }.bind(this)\n\t        }]\n\t      });\n\t\n\t      this._editor.extensions.push(this.toolbar);\n\t    }\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action) {\n\t      var _this3 = this;\n\t\n\t      var el = this.activeImageElement;\n\t      el.classList.remove(this.alignLeftClassName, this.alignRightClassName, this.alignCenterClassName, this.alignCenterWideClassName, this.alignCenterFullClassName);\n\t\n\t      el.classList.add(className);\n\t\n\t      this.toolbar.setToolbarPosition();\n\t      setTimeout(function () {\n\t        _this3.selectImageCore(el.querySelector('img'));\n\t      }, 0);\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'uploadFiles',\n\t    value: function uploadFiles() {\n\t      var _this4 = this;\n\t\n\t      Array.prototype.forEach.call(this._input.files, function (file) {\n\t        // Generate uid for this image, so we can identify it later\n\t        // and we can replace preview image with uploaded one\n\t        var uid = _utils2.default.generateRandomString();\n\t\n\t        if (_this4.options.preview) {\n\t          _this4.preview(file, uid);\n\t        }\n\t\n\t        _this4.upload(file, uid);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'preview',\n\t    value: function preview(file, uid) {\n\t      var _this5 = this;\n\t\n\t      var reader = new FileReader();\n\t\n\t      reader.onload = function (e) {\n\t        _this5.insertImage(e.target.result, uid);\n\t      };\n\t\n\t      reader.readAsDataURL(file);\n\t    }\n\t  }, {\n\t    key: 'upload',\n\t    value: function upload(file, uid) {\n\t      var xhr = new XMLHttpRequest(),\n\t          data = new FormData();\n\t      var insertImage = this.insertImage.bind(this);\n\t\n\t      xhr.open(\"POST\", this.options.uploadUrl, true);\n\t      xhr.onreadystatechange = function () {\n\t        if (xhr.readyState === 4 && xhr.status === 200) {\n\t          insertImage(xhr.responseText, _utils2.default.generateRandomString());\n\t        }\n\t      };\n\t\n\t      data.append(\"file\", file);\n\t      xhr.send(data);\n\t    }\n\t  }, {\n\t    key: 'insertImage',\n\t    value: function insertImage(imageUrl, uid, isLoader) {\n\t      var paragraph = this._plugin.getCore().selectedElement;\n\t\n\t      // Replace paragraph with div, because figure is a block element\n\t      // and can't be nested inside paragraphs\n\t      if (paragraph.nodeName.toLowerCase() === 'p') {\n\t        var div = document.createElement('div');\n\t\n\t        paragraph.parentNode.insertBefore(div, paragraph);\n\t        this._plugin.getCore().selectElement(div);\n\t        paragraph.remove();\n\t      }\n\t      var image = this._plugin.getCore().selectedElement.querySelector('[data-uid=\"' + uid + '\"]');\n\t\n\t      if (image) {\n\t        this.replaceImage(image, imageUrl);\n\t      } else {\n\t        this.addImage(imageUrl, uid, isLoader);\n\t      }\n\t\n\t      this._plugin.getCore().hideButtons();\n\t    }\n\t  }, {\n\t    key: 'addParagraph',\n\t    value: function addParagraph(el) {\n\t      var paragraph = document.createElement('p');\n\t      paragraph.innerHTML = '<br>';\n\t      el.insertAdjacentElement('afterend', paragraph);\n\t    }\n\t  }, {\n\t    key: 'addImage',\n\t    value: function addImage(url, uid, isLoader) {\n\t      var _this6 = this;\n\t\n\t      var el = this._plugin.getCore().selectedElement,\n\t          figure = document.createElement('figure'),\n\t          img = document.createElement('img'),\n\t          descriptionContainer = document.createElement('div'),\n\t          description = document.createElement('figcaption');\n\t      var domImage = void 0;\n\t\n\t      img.alt = '';\n\t\n\t      if (uid) {\n\t        img.setAttribute('data-uid', uid);\n\t      }\n\t\n\t      descriptionContainer.classList.add(this.descriptionContainerClassName);\n\t      description.contentEditable = true;\n\t      description.classList.add(this.descriptionClassName);\n\t      description.dataset.placeholder = this.descriptionPlaceholder;\n\t\n\t      // If we're dealing with a preview image,\n\t      // we don't have to preload it before displaying\n\t      if (url.match(/^data:/)) {\n\t        img.src = url;\n\t        figure.appendChild(img);\n\t        el.appendChild(figure);\n\t      } else {\n\t        domImage = new Image();\n\t        domImage.onload = function () {\n\t          img.src = domImage.src;\n\t          if (!isLoader) {\n\t            img.classList.add(_this6.activeClassName);\n\t          }\n\t          figure.appendChild(img);\n\t          descriptionContainer.appendChild(description);\n\t          figure.appendChild(descriptionContainer);\n\t          el.appendChild(figure);\n\t\n\t          if ((!el.nextSibling || !el.nextSibling.nextSibling) && !isLoader) {\n\t            _this6.addParagraph(el);\n\t          }\n\t        };\n\t\n\t        domImage.src = url;\n\t        if (isLoader) {\n\t          el.classList.add(this.loadingClassName);\n\t        }\n\t      }\n\t\n\t      el.classList.add(this.elementClassName);\n\t      el.classList.add(this.alignCenterClassName);\n\t\n\t      el.contentEditable = false;\n\t\n\t      // Return domImage so we can test this function easily\n\t      return domImage;\n\t    }\n\t  }, {\n\t    key: 'replaceImage',\n\t    value: function replaceImage(image, url) {\n\t      var domImage = new Image();\n\t      var el = this._plugin.getCore().selectedElement;\n\t\n\t      el.querySelector('img').classList.add(this.activeClassName);\n\t      el.classList.remove(this.loadingClassName);\n\t      if (!el.nextSibling || !el.nextSibling.nextSibling) {\n\t        this.addParagraph(el);\n\t      }\n\t\n\t      domImage.onload = function () {\n\t        image.src = domImage.src;\n\t        image.removeAttribute('data-uid');\n\t      };\n\t\n\t      domImage.src = url;\n\t\n\t      // Return domImage so we can test this function easily\n\t      return domImage;\n\t    }\n\t  }, {\n\t    key: 'selectImage',\n\t    value: function selectImage(e) {\n\t      var el = e.target;\n\t      this.selectImageCore(el);\n\t    }\n\t  }, {\n\t    key: 'selectImageCore',\n\t    value: function selectImageCore(el) {\n\t      if (el.nodeName.toLowerCase() === 'img' && _utils2.default.getClosestWithClassName(el, this.elementClassName)) {\n\t        var parentNode = el.parentNode.parentNode;\n\t\n\t        if (!parentNode.classList.contains(this.loadingClassName)) {\n\t          el.classList.add(this.activeClassName);\n\t          // parentNode.classList.add(this.activeClassName);\n\t          // TODO: The value is correct, but the medium sometimes change\n\t          this._editor.selectElement(parentNode);\n\t          this.activeImageElement = parentNode;\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'unselectImage',\n\t    value: function unselectImage(e) {\n\t      var _this7 = this;\n\t\n\t      var el = e.target;\n\t      var clickedImage = void 0,\n\t          images = void 0;\n\t\n\t      if (el.classList.contains(this.descriptionClassName)) return false;\n\t\n\t      // Unselect all selected images. If an image is clicked, unselect all except this one.\n\t      if (el.nodeName.toLowerCase() === 'img' && el.classList.contains(this.activeClassName)) {\n\t        clickedImage = el;\n\t      }\n\t\n\t      images = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName);\n\t      Array.prototype.forEach.call(images, function (image) {\n\t        if (image !== clickedImage) {\n\t          image.classList.remove(_this7.activeClassName);\n\t        }\n\t      });\n\t      this.activeImage = null;\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t      var isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\t\n\t      // Enter key in description\n\t      if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n\t        if (isDescriptionElement) {\n\t          return e.preventDefault();\n\t        }\n\t      }\n\t\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n\t        this.removeImage(e);\n\t      }\n\t\n\t      // Down, enter\n\t      if (e.which === 40 || e.which === 13) {\n\t        // Detect selected image\n\t        var selectedImageDOM = document.querySelector('.' + this.activeClassName);\n\t        var selectedImageParentDOM = selectedImageDOM && selectedImageDOM.parentNode.parentNode;\n\t        if (selectedImageParentDOM) {\n\t          var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\t\n\t          if (!nextSiblingParagraphDOM) {\n\t            // Insert paragraph and focus\n\t            this.addParagraph(selectedImageParentDOM);\n\t          }\n\t\n\t          // Focus next paragraph\n\t          nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\t\n\t          if (nextSiblingParagraphDOM) {\n\t            if (!nextSiblingParagraphDOM.innerHTML) {\n\t              nextSiblingParagraphDOM.innerHTML = '<br>';\n\t            }\n\t            window.getSelection().removeAllRanges();\n\t            this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n\t            MediumEditor.selection.clearSelection(document, true);\n\t            selectedImageDOM.classList.remove(this.activeClassName);\n\t            e.preventDefault();\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'removeImage',\n\t    value: function removeImage(e) {\n\t      var _this8 = this;\n\t\n\t      var images = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName),\n\t          selection = window.getSelection();\n\t      var selectedHtml = void 0;\n\t\n\t      // Remove image even if it's not selected, but backspace/del is pressed in text\n\t      if (selection && selection.rangeCount) {\n\t        var range = MediumEditor.selection.getSelectionRange(document),\n\t            focusedElement = MediumEditor.selection.getSelectedParentElement(range),\n\t            caretPosition = MediumEditor.selection.getCaretOffsets(focusedElement).left;\n\t        var sibling = void 0;\n\t\n\t        // Is backspace pressed and caret is at the beginning of a paragraph, get previous element\n\t        if (e.which === MediumEditor.util.keyCode.BACKSPACE && caretPosition === 0) {\n\t          sibling = focusedElement.previousElementSibling;\n\t          // Is del pressed and caret is at the end of a paragraph, get next element\n\t        } else if (e.which === MediumEditor.util.keyCode.DELETE && caretPosition === focusedElement.innerText.length) {\n\t          sibling = focusedElement.nextElementSibling;\n\t        }\n\t\n\t        if (sibling && sibling.classList.contains('medium-editor-insert-images')) {\n\t          var newImages = sibling.getElementsByTagName('img');\n\t          Array.prototype.forEach.call(newImages, function (image) {\n\t            images.push(image);\n\t          });\n\t        }\n\t\n\t        // If text is selected, find images in the selection\n\t        selectedHtml = MediumEditor.selection.getSelectionHtml(document);\n\t        if (selectedHtml) {\n\t          var temp = document.createElement('div');\n\t          var wrappers = void 0,\n\t              _newImages = void 0;\n\t          temp.innerHTML = selectedHtml;\n\t\n\t          wrappers = temp.getElementsByClassName('medium-editor-insert-images');\n\t          _newImages = _utils2.default.getElementsByTagName(wrappers, 'img');\n\t\n\t          Array.prototype.forEach.call(_newImages, function (image) {\n\t            images.push(image);\n\t          });\n\t        }\n\t      }\n\t\n\t      if (images.length) {\n\t        if (!selectedHtml) {\n\t          e.preventDefault();\n\t        }\n\t\n\t        images.forEach(function (image) {\n\t          var wrapper = _utils2.default.getClosestWithClassName(image, 'medium-editor-insert-images');\n\t          _this8.deleteFile(image.src);\n\t\n\t          image.parentNode.remove();\n\t\n\t          // If wrapper has no images anymore, remove it\n\t          if (wrapper.childElementCount === 0) {\n\t            var next = wrapper.nextElementSibling,\n\t                prev = wrapper.previousElementSibling;\n\t\n\t            wrapper.remove();\n\t\n\t            // If there is no selection, move cursor at the beginning of next paragraph (if delete is pressed),\n\t            // or nove it at the end of previous paragraph (if backspace is pressed)\n\t            if (!selectedHtml) {\n\t              if (next || prev) {\n\t                if (next && e.which === MediumEditor.util.keyCode.DELETE || !prev) {\n\t                  MediumEditor.selection.moveCursor(document, next, 0);\n\t                } else {\n\t                  MediumEditor.selection.moveCursor(document, prev.lastChild, prev.lastChild.textContent.length);\n\t                }\n\t              }\n\t            }\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'deleteFile',\n\t    value: function deleteFile(image) {\n\t      if (this.options.deleteUrl) {\n\t        var xhr = new XMLHttpRequest(),\n\t            data = Object.assign({}, {\n\t          file: image\n\t        }, this.options.deleteData);\n\t\n\t        xhr.open(this.options.deleteMethod, this.options.deleteUrl, true);\n\t        xhr.send(data);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {}\n\t  }]);\n\t\n\t  return Images;\n\t}();\n\t\n\texports.default = Images;\n\tmodule.exports = exports['default'];\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// medium-editor-insert.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2696e09bc5e1b516dcb2","import Core from './Core';\n\nconst MediumEditorInsert = MediumEditor.Extension.extend({\n    name: 'insert',\n\n    addons: {\n        images: true,\n        embeds: true\n    },\n\n    _initializedAddons: {},\n\n    init: function() {\n        MediumEditor.Extension.prototype.init.apply(this, arguments);\n\n        this.core = new Core(this);\n    },\n\n    destroy: function() {\n        this.core.removeButtons();\n    },\n\n    getCore: function() {\n        return this.core;\n    },\n\n    getAddons: function () {\n        return this._initializedAddons;\n    },\n\n    getAddon: function(name) {\n        return this._initializedAddons[name];\n    }\n});\n\nexport default MediumEditorInsert;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/Plugin.js","const utils = {\n    ucfirst: (str) => {\n        return str.charAt(0).toUpperCase() + str.slice(1);\n    },\n\n    generateRandomString: (length = 15) => {\n        return Math.random().toString(36).substr(2, length);\n    },\n\n    getClosestWithClassName: (el, className) => {\n        return MediumEditor.util.traverseUp(el, (element) => {\n            return element.classList.contains(className);\n        });\n    },\n\n    isChildOf: (el, parent) => {\n        return MediumEditor.util.traverseUp(el, (element) => {\n            return element === parent;\n        }) ? true : false;\n    },\n\n    getElementsByClassName: (parents, className) => {\n        const results = [];\n\n        Array.prototype.forEach.call(parents, (editor) => {\n            const elements = editor.getElementsByClassName(className);\n\n            Array.prototype.forEach.call(elements, (element) => {\n                results.push(element);\n            });\n        });\n\n        return results;\n    },\n\n    getElementsByTagName: (parents, tagName) => {\n        const results = [];\n\n        Array.prototype.forEach.call(parents, (editor) => {\n            const elements = editor.getElementsByTagName(tagName);\n\n            Array.prototype.forEach.call(elements, (element) => {\n                results.push(element);\n            });\n        });\n\n        return results;\n    }\n};\n\nexport default utils;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils.js","import utils from './utils';\nimport ToolbarButton from './ToolbarButton';\n\nconst MediumEditorToolbar = MediumEditor.extensions.toolbar;\n\nexport default class Toolbar extends MediumEditorToolbar {\n\n    constructor(options) {\n        super(options);\n\n        this.name = `${options.type}Toolbar`;\n\n        options.buttons.forEach((buttonOptions) => {\n            const button = new ToolbarButton(Object.assign({}, {\n                window: this.plugin.window,\n                document: this.plugin.document,\n                base: this.plugin.base\n            }, buttonOptions));\n\n            button.init();\n            this.plugin.base.extensions.push(button);\n        });\n\n        this.window = options.plugin.window;\n        this.document = options.plugin.document;\n        this.base = options.plugin.base;\n\n        this.init();\n    }\n\n    createToolbar() {\n        const toolbar = this.document.createElement('div');\n\n        toolbar.id = `medium-editor-insert-${this.type}-toolbar-${this.getEditorId()}`;\n        toolbar.className = 'medium-editor-toolbar';\n\n        if (this.static) {\n            toolbar.className += ' static-toolbar';\n        } else if (this.relativeContainer) {\n            toolbar.className += ' medium-editor-relative-toolbar';\n        } else {\n            toolbar.className += ' medium-editor-stalker-toolbar';\n        }\n\n        toolbar.appendChild(this.createToolbarButtons());\n\n        // Add any forms that extensions may have\n        this.forEachExtension((extension) => {\n            if (extension.hasForm) {\n                toolbar.appendChild(extension.getForm());\n            }\n        });\n\n        this.attachEventHandlers();\n\n        return toolbar;\n    }\n\n    createToolbarButtons() {\n        const ul = this.document.createElement('ul');\n        let li,\n            btn,\n            buttons,\n            extension,\n            buttonName,\n            buttonOpts;\n\n        ul.id = `medium-editor-insert-${this.type}-toolbar-actions${this.getEditorId()}`;\n        ul.className = 'medium-editor-toolbar-actions';\n        ul.style.display = 'block';\n\n        this.buttons.forEach((button) => {\n            if (typeof button === 'string') {\n                buttonName = button;\n                buttonOpts = null;\n            } else {\n                buttonName = button.name;\n                buttonOpts = button;\n            }\n\n            // If the button already exists as an extension, it'll be returned\n            // othwerise it'll create the default built-in button\n            extension = this.base.addBuiltInExtension(buttonName, buttonOpts);\n\n            if (extension && typeof extension.getButton === 'function') {\n                btn = extension.getButton(this.base);\n                li = this.document.createElement('li');\n                if (MediumEditor.util.isElement(btn)) {\n                    li.appendChild(btn);\n                } else {\n                    li.innerHTML = btn;\n                }\n                ul.appendChild(li);\n            }\n        }, this);\n\n        buttons = ul.querySelectorAll('button');\n        if (buttons.length > 0) {\n            buttons[0].classList.add(this.firstButtonClass);\n            buttons[buttons.length - 1].classList.add(this.lastButtonClass);\n        }\n\n        return ul;\n    }\n\n    checkState() {\n        let activeElements;\n\n        if (this.base.preventSelectionUpdates) {\n            return;\n        }\n\n        // Wait for elements to be selected\n        setTimeout(() => {\n            activeElements = utils.getElementsByClassName(this.getEditorElements(), this.activeClassName);\n\n            // Hide toolbar when no elements are selected\n            if (activeElements.length === 0) {\n                return this.hideToolbar();\n            }\n\n            // Now we know there's a focused editable with a selection\n            this.showAndUpdateToolbar();\n        }, 10);\n    }\n\n    setToolbarPosition() {\n        const container = utils.getElementsByClassName(this.getEditorElements(), this.activeClassName)[0];\n        let anchorPreview;\n\n        // If there isn't a valid selection, bail\n        if (!container) {\n            return this;\n        }\n\n        this.showToolbar();\n        this.positionStaticToolbar(container);\n\n        anchorPreview = this.base.getExtensionByName('anchor-preview');\n\n        if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n            anchorPreview.hidePreview();\n        }\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/Toolbar.js","import utils from './utils';\nimport Images from './addons/Images';\nimport Embeds from './addons/Embeds';\n\nexport default class Core {\n\n    constructor(plugin) {\n        this._plugin = plugin;\n        this._editor = this._plugin.base;\n\n        this.initAddons();\n        this.addButtons();\n        this.events();\n    }\n\n    events() {\n        let addonActions;\n\n        // This could be chained when medium-editor 5.15.2 is released\n        // https://github.com/yabwe/medium-editor/pull/1046\n        this._plugin.on(document, 'click', this.toggleButtons.bind(this));\n        this._plugin.on(document, 'keyup', this.toggleButtons.bind(this));\n        this._plugin.on(this.buttons.getElementsByClassName('medium-editor-insert-buttons-show')[0], 'click', this.toggleAddons.bind(this));\n\n        // This could be written in one statement when medium-editor 5.15.2 is released\n        // https://github.com/yabwe/medium-editor/pull/1046\n        addonActions = this.buttons.getElementsByClassName('medium-editor-insert-action');\n        Array.prototype.forEach.call(addonActions, (action) => {\n            this._plugin.on(action, 'click', this.handleAddonClick.bind(this));\n        });\n\n        this._plugin.on(window, 'resize', this.positionButtons.bind(this));\n    }\n\n    initAddons() {\n        // Initialize all default addons, we'll delete ones we don't need later\n        this._plugin._initializedAddons = {\n            images: new Images(this._plugin, this._plugin.addons.images),\n            embeds: new Embeds(this._plugin, this._plugin.addons.embeds)\n        };\n\n        Object.keys(this._plugin.addons).forEach((name) => {\n            const addonOptions = this._plugin.addons[name];\n\n            // If the addon is custom one\n            if (!this._plugin._initializedAddons[name]) {\n                if (typeof addonOptions === 'function') {\n                    this._plugin._initializedAddons[name] = new addonOptions(this._plugin);\n                } else {\n                    window.console.error(`I don't know how to initialize custom \"${name}\" addon!`);\n                }\n            }\n\n            // Delete disabled addon\n            if (!addonOptions) {\n                delete this._plugin._initializedAddons[name];\n            }\n        });\n    }\n\n    addButtons() {\n        const addons = this._plugin.getAddons();\n        let html;\n\n        this.buttons = document.createElement('div');\n        this.buttons.id = `medium-editor-insert-${this._plugin.getEditorId()}`;\n        this.buttons.classList.add('medium-editor-insert-buttons');\n        this.buttons.setAttribute('contentediable', false);\n\n        html = `<a class=\"medium-editor-insert-buttons-show\">+</a>\n            <ul class=\"medium-editor-insert-buttons-addons\">`;\n\n        Object.keys(addons).forEach((name) => {\n            const addon = addons[name];\n\n            html += `<li><a class=\"medium-editor-insert-action\" data-addon=\"${name}\">${addon.label}</a></li>`;\n        });\n\n        html += `</ul>`;\n\n        this.buttons.innerHTML = html;\n\n        document.body.appendChild(this.buttons);\n    }\n\n    removeButtons() {\n        this.buttons.remove();\n    }\n\n    positionButtons() {\n        let el, elPosition, addons, addonButton, addonsStyle, addonButtonStyle, position;\n\n        // Don't position buttons if they aren't active\n        if (this.buttons.classList.contains('medium-editor-insert-buttons-active') === false) {\n            return;\n        }\n\n        el = this._editor.getSelectedParentElement();\n        elPosition = el.getBoundingClientRect();\n        addons = this.buttons.getElementsByClassName('medium-editor-insert-buttons-addons')[0];\n        addonButton = this.buttons.getElementsByClassName('medium-editor-insert-action')[0];\n        addonsStyle = window.getComputedStyle(addons);\n        addonButtonStyle = window.getComputedStyle(addonButton);\n\n        // Calculate position\n        position = {\n            top: window.scrollY + elPosition.top,\n            left: window.scrollX + elPosition.left - parseInt(addonsStyle.left, 10) - parseInt(addonButtonStyle.marginLeft, 10)\n        };\n\n        // If left position is lower than 0, the buttons would be out of the viewport.\n        // In that case, align buttons with the editor\n        position.left = position.left < 0 ? elPosition.left : position.left;\n\n        this.buttons.style.left = `${position.left}px`;\n        this.buttons.style.top = `${position.top}px`;\n    }\n\n    toggleButtons() {\n        const el = this._editor.getSelectedParentElement();\n\n        if (this.shouldDisplayButtonsOnElement(el)) {\n            this.selectElement(el);\n            this.showButtons();\n        } else {\n            this.hideButtons();\n        }\n    }\n\n    shouldDisplayButtonsOnElement(el) {\n        const addons = this._plugin.getAddons(),\n            addonClassNames = [];\n        let isAddon = false,\n            belongsToEditor = false;\n\n        // Don't show buttons when the element has text\n        if (el.innerText.trim() !== '') {\n            return false;\n        }\n\n        // Don't show buttons when the editor doesn't belong to editor\n        this._plugin.getEditorElements().forEach((editor) => {\n            if (utils.isChildOf(el, editor)) {\n                belongsToEditor = true;\n                return;\n            }\n        });\n\n        if (!belongsToEditor) {\n            return false;\n        }\n\n        // Get class names used by addons\n        Object.keys(addons).forEach((addonName) => {\n            const addon = addons[addonName];\n            if (addon.elementClassName) {\n                addonClassNames.push(addon.elementClassName);\n            }\n        });\n\n        // Don't show buttons if the element is an addon element\n        // - when the element has an addon class, or some of its parents have it\n        addonClassNames.forEach((className) => {\n            if (el.classList.contains(className) || utils.getClosestWithClassName(el, className)) {\n                isAddon = true;\n                return;\n            }\n        });\n\n        return !isAddon;\n    }\n\n    selectElement(el) {\n        this.selectedElement = el;\n    }\n\n    showButtons() {\n        this.buttons.classList.add('medium-editor-insert-buttons-active');\n        this.positionButtons();\n    }\n\n    hideButtons() {\n        this.buttons.classList.remove('medium-editor-insert-buttons-active');\n        this.buttons.classList.remove('medium-editor-insert-addons-active');\n    }\n\n    toggleAddons() {\n        this.buttons.classList.toggle('medium-editor-insert-addons-active');\n    }\n\n    handleAddonClick(e) {\n        const name = e.currentTarget.getAttribute('data-addon');\n        e.preventDefault();\n\n        this._plugin.getAddon(name).handleClick(e);\n        this.hideButtons();\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/Core.js","const ToolbarButton = MediumEditor.extensions.button.extend({\n    init: function() {\n        this.button = this.document.createElement('button');\n        this.button.classList.add('medium-editor-action');\n        this.button.classList.add(this.className);\n        this.button.innerHTML = `<b>${this.label}</b>`;\n\n        this.on(this.button, 'click', this.handleClick.bind(this));\n    },\n\n    getButton: function() {\n      return this.button;\n    },\n\n    handleClick: function() {\n        this.onClick();\n    }\n});\n\nexport default ToolbarButton;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/ToolbarButton.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class Embeds {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-youtube-play\"></span>',\n      placeholder: 'Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter',\n      oembedProxy: 'http://medium.iframe.ly/api/oembed?omit_script=1&iframe=1',\n      captions: true,\n      captionPlaceholder: 'Type caption (optional)',\n      storeMeta: false,\n      styles: {\n        wide: {\n          label: '<span class=\"fa fa-align-justify\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        },\n        left: {\n          label: '<span class=\"fa fa-align-left\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        },\n        right: {\n          label: '<span class=\"fa fa-align-right\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        }\n      },\n      actions: {\n        remove: {\n          label: '<span class=\"fa fa-times\"></span>',\n          clicked: function() {\n            // var $event = $.Event('keydown');\n\n            // $event.which = 8;\n            // $(document).trigger($event);\n          }\n        }\n      },\n      parseOnPaste: false,\n      onChange: (action) => {\n        console.log('Embed change: ', action);\n      },\n    };\n\n    Object.assign(this.options, options);\n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n\n    this.activeClassName = 'medium-editor-insert-embeds-active';\n    this.placeholderClassName = 'medium-editor-insert-embeds-placeholder';\n    this.elementClassName = 'medium-editor-insert-embeds';\n    this.loadingClassName = 'medium-editor-insert-embeds-loading';\n    this.activeClassName = 'medium-editor-insert-embed-active';\n    this.descriptionContainerClassName = 'medium-editor-embed-embed-description-container';\n    this.descriptionClassName = 'medium-editor-embed-embed-description';\n    this.overlayClassName = 'medium-editor-insert-embeds-overlay';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignRightClassName = 'align-right';\n    this.alignCenterClassName = 'align-center';\n    this.alignCenterWideClassName = 'align-center-wide';\n    this.alignCenterFullClassName = 'align-center-full';\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\n    this.initToolbar();\n    this.events();\n\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectEmbed.bind(this));\n    });\n  }\n\n\n  selectEmbed(e) {\n    const el = e.target;\n    this.selectEmbedCore(el);\n  }\n\n  selectEmbedCore(el) {\n    if (el.classList.contains(this.overlayClassName)) {\n      const selectedEl = utils.getClosestWithClassName(el, this.elementClassName);\n      if (!selectedEl.classList.contains(this.loadingClassName)) {\n        selectedEl.classList.add(this.activeClassName);\n        this._editor.selectElement(selectedEl);\n        this.activeEmbedElement = selectedEl;\n      }\n    }\n  }\n\n  unselectEmbed(e) {\n    const el = e.target;\n    let clickedEmbed, clickedEmbedPlaceholder, embeds, embedsPlaceholders;\n\n    if (el.classList.contains(this.descriptionClassName)) return false;\n\n    embeds = utils.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\n    if (!embeds || !embeds.length) {\n      return false;\n    }\n\n    // Unselect all selected images. If an image is clicked, unselect all except this one.\n    if (el.classList.contains(this.overlayClassName)) {\n      clickedEmbed = utils.getClosestWithClassName(el, this.elementClassName);\n    }\n\n    if (embeds) {\n      Array.prototype.forEach.call(embeds, (embed) => {\n        if (embed !== clickedEmbed) {\n          embed.classList.remove(this.activeClassName);\n        }\n      });\n    }\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n    const isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\n    // Enter key in description\n    if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n      if (isDescriptionElement) {\n        e.preventDefault();\n      }\n    }\n\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n      this.removeEmbed(e);\n    }\n\n    // Down, enter\n    if (e.which === 40 || e.which === 13) {\n      // Detect selected image\n      const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n\n      if (selectedEmbedDOM) {\n        let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (!nextSiblingParagraphDOM) {\n          // Insert paragraph and focus\n          const paragraph = document.createElement('p');\n          paragraph.innerHTML = '<br>';\n            selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n        }\n\n        // Focus next paragraph\n        nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (nextSiblingParagraphDOM) {\n          if (!nextSiblingParagraphDOM.innerHTML) {\n              nextSiblingParagraphDOM.innerHTML = '<br>';\n          }\n          window.getSelection().removeAllRanges();\n          this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n            selectedEmbedDOM.classList.remove(this.activeClassName);\n          MediumEditor.selection.clearSelection(document, true);\n            selectedEmbedDOM.classList.remove(this.activeClassName);\n          e.preventDefault();\n        }\n      }\n    }\n  }\n\n  handleClick() {\n    this.el = this._plugin.getCore().selectedElement;\n    this.el.classList.add(this.loadingClassName);\n    this.el.classList.add(this.placeholderClassName);\n    this.el.setAttribute('data-placeholder', this.options.placeholder);\n\n    this.instanceHandlePaste = this.handlePaste.bind(this);\n    this.instanceHandleKeyDown = this.handleKeyDown.bind(this);\n\n    this._plugin.on(document, 'paste', this.instanceHandlePaste);\n    this._plugin.on(document, 'keydown', this.instanceHandleKeyDown);\n\n    // FIXME: it doesn't work yet.  :(\n    this._plugin.on(this.el, 'blur', this.handleBlur.bind(this));\n\n    // this._plugin.getCore().hideButtons();\n\n    // return focus to element, allow user to cancel embed by start writing\n    this._editor.elements[0].focus();\n    this.el.focus();\n\n    // this._editor.selectElement(this.el);\n    // console.log( this._editor.selection );\n  }\n\n  handleKeyDown(evt) {\n    if (evt.which !== 17 && evt.which !== 91 && evt.which !== 224 // Cmd or Ctrl pressed (user probably preparing to paste url via hot keys)\n      &&\n      (evt.which === 27 || this._plugin.selectedElement !== this.el)\n    ) {\n      // Escape\n      this.cancelEmbed();\n      return false;\n    }\n    return true;\n  }\n\n  handlePaste(evt) {\n    const pastedUrl = evt.clipboardData.getData('text');\n    const linkRegEx = new RegExp('^(http(s?):)?\\/\\/', 'i');\n    const linkRegEx2 = new RegExp('^(www\\.)?', 'i');\n\n    if (linkRegEx.test(pastedUrl) || linkRegEx2.test(pastedUrl)) {\n      const html = (this.options.oembedProxy) ? this.oembed(pastedUrl, true) : this.parseUrl(pastedUrl, true);\n    }\n\n    this.cancelEmbed();\n  }\n\n\n  removeEmbed(e) {\n      const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n      if (selectedEmbedDOM) {\n          selectedEmbedDOM.remove();\n      }\n  }\n\n  /**\n   * Init Toolbar for tuning embed position\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n  initToolbar() {\n    this.toolbar = new Toolbar({\n      plugin: this._plugin,\n      type: 'embeds',\n      activeClassName: this.activeClassName,\n      buttons: [{\n        name: 'embed-align-left',\n        action: 'align-left',\n        className: 'btn-align-left',\n        label: 'Left',\n        onClick: (function() {\n          this.changeAlign(this.alignLeftClassName, 'embed-align-left');\n        }).bind(this),\n      }, {\n        name: 'embed-align-center',\n        action: 'align-center',\n        className: 'btn-align-center',\n        label: 'Center',\n        onClick: (function() {\n          this.changeAlign(this.alignCenterClassName, 'embed-align-center');\n        }).bind(this),\n      }, {\n        name: 'embed-align-center-wide',\n        action: 'align-center-wide',\n        className: 'btn-align-center-wide',\n        label: 'Wide',\n        onClick: (function() {\n          this.changeAlign(this.alignCenterWideClassName, 'embed-align-center-wide');\n        }).bind(this),\n      }, {\n        name: 'embed-align-center-full',\n        action: 'align-center-full',\n        className: 'btn-align-center-full',\n        label: 'Full',\n        onClick: (function() {\n          this.changeAlign(this.alignCenterFullClassName, 'embed-align-center-full');\n        }).bind(this),\n      }, {\n        name: 'embed-align-right',\n        action: 'align-right',\n        className: 'btn-align-right',\n        label: 'Right',\n        onClick: (function() {\n          this.changeAlign(this.alignRightClassName, 'embed-align-right');\n        }).bind(this),\n      }, ]\n    });\n\n    this._editor.extensions.push(this.toolbar);\n  }\n\n  changeAlign(className, action) {\n    const el = this.activeEmbedElement;\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignRightClassName,\n      this.alignCenterClassName,\n      this.alignCenterWideClassName,\n      this.alignCenterFullClassName\n    );\n    el.classList.add(className);\n\n    this.toolbar.setToolbarPosition();\n    setTimeout( () => {\n      this.selectEmbedCore( el.querySelector(`.${this.overlayClassName}`) );\n    }, 0);\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n\n  }\n\n  /**\n   * Get HTML via oEmbed proxy\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n\n  oembed(url, pasted) {\n\n    const urlOut = this.options.oembedProxy + '&url=' + url;\n    const xhr = new XMLHttpRequest();\n\n    // console.log(urlOut);\n    xhr.open(\"GET\", urlOut, true);\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        const data = JSON.parse(xhr.responseText);\n        this.embed(data.html, url, data);\n      }\n    };\n\n    xhr.send();\n\n    return true;\n  }\n\n  /**\n   * Get HTML using regexp\n   *\n   * @param {string} url\n   * @param {bool} pasted\n   * @return {void}\n   */\n\n  parseUrl(url, pasted) {\n    let html;\n\n    if (!(new RegExp(['youtube', 'youtu.be', 'vimeo', 'instagram', 'twitter', 'facebook'].join('|')).test(url))) {\n      // $.proxy(this, 'convertBadEmbed', url)();\n      return false;\n    }\n\n    html = url.replace(/\\n?/g, '')\n      .replace(/^((http(s)?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be)\\/(watch\\?v=|v\\/)?)([a-zA-Z0-9\\-_]+)(.*)?$/, '<div class=\"video video-youtube\"><iframe width=\"420\" height=\"315\" src=\"//www.youtube.com/embed/$7\" frameborder=\"0\" allowfullscreen></iframe></div>')\n      .replace(/^https?:\\/\\/vimeo\\.com(\\/.+)?\\/([0-9]+)$/, '<div class=\"video video-vimeo\"><iframe src=\"//player.vimeo.com/video/$2\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>')\n      .replace(/^https:\\/\\/twitter\\.com\\/(\\w+)\\/status\\/(\\d+)\\/?$/, '<blockquote class=\"twitter-tweet\" align=\"center\" lang=\"en\"><a href=\"https://twitter.com/$1/statuses/$2\"></a></blockquote><script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>')\n      .replace(/^(https:\\/\\/www\\.facebook\\.com\\/(.*))$/, '<script src=\"//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2\" async></script><div class=\"fb-post\" data-href=\"$1\"><div class=\"fb-xfbml-parse-ignore\"><a href=\"$1\">Loading Facebook post...</a></div></div>')\n      .replace(/^https?:\\/\\/instagram\\.com\\/p\\/(.+)\\/?$/, '<span class=\"instagram\"><iframe src=\"//instagram.com/p/$1/embed/\" width=\"612\" height=\"710\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe></span>');\n\n    if ((/<(\"[^\"]*\"|'[^']*'|[^'\">])*>/).test(html) === false) {\n      // $.proxy(this, 'convertBadEmbed', url)();\n      return false;\n    }\n\n\n    if (pasted) {\n      return this.embed(html, url);\n    } else {\n      return this.embed(html);\n    }\n  };\n\n\n  /**\n   * Add html to page\n   *\n   * @param {string} html\n   * @param {string} pastedUrl\n   * @return {void}\n   */\n\n  embed(html, pastedUrl, info) {\n    let el, figure, descriptionContainer, description, metacontainer, container, overlay, lastEl, paragraph;\n\n    if (!html) {\n      console.error('Incorrect URL format specified: ', pastedUrl);\n      return false;\n    }\n\n    if (info && info.type === 'link') {\n      console.error('Just common link  no any embeds to insert: ', pastedUrl);\n      return false;\n    }\n\n    el = this._plugin.getCore().selectedElement;\n    figure = document.createElement('figure');\n    figure.classList.add('medium-editor-insert-embeds-item');\n\n    descriptionContainer = document.createElement('div');\n    descriptionContainer.classList.add(this.descriptionContainerClassName);\n\n    description = document.createElement('figcaption');\n    description.classList.add(this.descriptionClassName);\n    description.setAttribute('contenteditable', true);\n    description.setAttribute('data-placeholder', 'Type caption for embed (optional)');\n\n    metacontainer = document.createElement('div');\n    metacontainer.classList.add(this.elementClassName);\n    metacontainer.classList.add(this.alignCenterClassName);\n    paragraph = document.createElement('p');\n    paragraph.innerHTML = '<br>';\n\n    // metacontainer.classList.add(this.activeClassName);\n\n    metacontainer.setAttribute('contenteditable', false);\n\n    container = document.createElement('div');\n    container.classList.add('medium-editor-insert-embeds-item-container');\n\n    overlay = document.createElement('div');\n    overlay.classList.add(this.overlayClassName);\n\n    metacontainer.appendChild(figure);\n    figure.appendChild(container);\n    figure.appendChild(overlay);\n\n    descriptionContainer.classList.add(this.descriptionContainerClassName);\n    description.contentEditable = true;\n    description.classList.add(this.descriptionClassName);\n    description.dataset.placeholder = this.descriptionPlaceholder;\n\n    el.replaceWith(metacontainer);\n    // Insert a empty paragraph\n    if (!el.nextSibling) {\n      el.insertAdjacentElement('afterend', paragraph);\n    }\n\n    // check if embed is last element, then add one more p after it\n    lastEl = metacontainer.parentNode.lastChild;\n\n    while (lastEl && lastEl.nodeType !== 1) {\n      lastEl = lastEl.previousSibling;\n    }\n\n    if (lastEl === metacontainer) {\n      const lastP = document.createElement('p');\n      lastP.appendChild(document.createElement('br'));\n      metacontainer.parentNode.appendChild(lastP);\n    }\n\n    container.innerHTML = html;\n\n    this._editor.selectElement(metacontainer);\n\n    // console.log(html);\n    // this.core.triggerInput();\n\n    if (html.indexOf('facebook') !== -1) {\n      if (typeof(FB) !== 'undefined') {\n        setTimeout(function() {\n          FB.XFBML.parse();\n        }, 2000);\n      }\n    }\n\n    this.options.onInsert && this.options.onInsert(html);\n\n    return true;\n  }\n\n  handleBlur() {\n    console.log('blur');\n    // this.cancelEmbed();\n  }\n\n  hidePlaceholder() {\n    this.el.removeAttribute('data-placeholder');\n    this.el.classList.remove('medium-editor-insert-embeds-placeholder');\n  }\n\n  cancelEmbed() {\n    this.hidePlaceholder();\n    this.el.classList.remove('medium-editor-insert-embeds-active');\n\n    this._plugin.off(document, 'paste', this.instanceHandlePaste);\n    this._plugin.off(document, 'keyup', this.instanceHandleKeyUp);\n  }\n\n  destroy() {\n    this.cancelEmbed();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/Embeds.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class Images {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-camera\"></span>',\n      preview: true,\n      uploadUrl: 'upload.php',\n      deleteUrl: 'delete.php',\n      deleteMethod: 'DELETE',\n      deleteData: {},\n      onChange: (action) => {\n        console.log('Image change: ', action);\n      },\n    };\n\n    Object.assign(this.options, options); \n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n    this.elementClassName = 'medium-editor-insert-images';\n    this.loadingClassName = 'medium-editor-insert-images-loading';\n    this.activeClassName = 'medium-editor-insert-image-active';\n    this.descriptionContainerClassName = 'medium-editor-embed-image-description-container';\n    this.descriptionClassName = 'medium-editor-embed-image-description';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignRightClassName = 'align-right';\n    this.alignCenterClassName = 'align-center';\n    this.alignCenterWideClassName = 'align-center-wide';\n    this.alignCenterFullClassName = 'align-center-full';\n\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n    this.activeImageElement = null;\n    this.initToolbar();\n    this.events();\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectImage.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectImage.bind(this));\n    });\n  }\n\n  handleClick() {\n    if (this.options.onInsertButtonClick) {\n      const uid = utils.generateRandomString();\n      this.options.onInsertButtonClick(\n        (imageUrl) => this.insertImage(imageUrl, uid),\n        (imageUrl) => this.insertImage(imageUrl, uid, true)\n      );\n    } else {\n      this._input = document.createElement('input');\n      this._input.type = 'file';\n      this._input.multiple = true;\n      this._plugin.on(this._input, 'change', this.uploadFiles.bind(this));\n      this._input.click();\n    }\n  }\n\n  initToolbar() {\n    this.toolbar = new Toolbar({\n      plugin: this._plugin,\n      type: 'images',\n      activeClassName: this.activeClassName,\n      buttons: [{\n        name: 'image-align-left',\n        action: 'align-left',\n        className: 'btn-align-left',\n        label: 'Left',\n        title: 'Left',\n        onClick: (function() {\n          this.changeAlign('align-left', 'image-align-left');\n        }).bind(this),\n      }, {\n        name: 'image-align-center',\n        action: 'align-center',\n        className: 'btn-align-center',\n        label: 'Center',\n        title: 'Center',\n        onClick: (function() {\n          this.changeAlign('align-center', 'image-align-center');\n        }).bind(this),\n      }, {\n        name: 'image-align-center-wide',\n        action: 'align-center-wide',\n        className: 'btn-align-center-wide',\n        label: 'Wide',\n        title: 'Wide',\n        onClick: (function() {\n          this.changeAlign('align-center-wide', 'image-align-center-wide');\n        }).bind(this),\n      }, {\n        name: 'image-align-center-full',\n        action: 'align-center-full',\n        className: 'btn-align-center-full',\n        label: 'Full',\n        title: 'Full wide',\n        onClick: (function() {\n          this.changeAlign('align-center-full', 'image-align-center-full');\n        }).bind(this),\n      }, {\n        name: 'image-align-right',\n        action: 'align-right',\n        className: 'btn-align-right',\n        label: 'Right',\n        title: 'Right',\n        onClick: (function() {\n          this.changeAlign('align-right', 'image-align-right');          \n        }).bind(this),\n      }, ]\n    });\n\n    this._editor.extensions.push(this.toolbar);\n  }\n\n  changeAlign(className, action) {\n    const el = this.activeImageElement;\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignRightClassName,\n      this.alignCenterClassName,\n      this.alignCenterWideClassName,\n      this.alignCenterFullClassName\n    );\n\n    el.classList.add(className);\n\n    this.toolbar.setToolbarPosition();\n    setTimeout( () => {\n      this.selectImageCore( el.querySelector('img') );      \n    }, 0);\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n  }\n\n  uploadFiles() {\n    Array.prototype.forEach.call(this._input.files, (file) => {\n      // Generate uid for this image, so we can identify it later\n      // and we can replace preview image with uploaded one\n      const uid = utils.generateRandomString();\n\n      if (this.options.preview) {\n        this.preview(file, uid);\n      }\n\n      this.upload(file, uid);\n    });\n  }\n\n  preview(file, uid) {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      this.insertImage(e.target.result, uid);\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  upload(file, uid) {\n    const xhr = new XMLHttpRequest(),\n      data = new FormData();\n    const insertImage = this.insertImage.bind(this);\n\n    xhr.open(\"POST\", this.options.uploadUrl, true);\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        insertImage(xhr.responseText, utils.generateRandomString());\n      }\n    };\n\n    data.append(\"file\", file);\n    xhr.send(data);\n  }\n\n  insertImage(imageUrl, uid, isLoader) {\n    const paragraph = this._plugin.getCore().selectedElement;\n\n    // Replace paragraph with div, because figure is a block element\n    // and can't be nested inside paragraphs\n    if (paragraph.nodeName.toLowerCase() === 'p') {\n      const div = document.createElement('div');\n\n      paragraph.parentNode.insertBefore(div, paragraph);\n      this._plugin.getCore().selectElement(div);\n      paragraph.remove();\n    }\n    const image = this._plugin.getCore().selectedElement.querySelector(`[data-uid=\"${uid}\"]`);\n\n    if (image) {\n      this.replaceImage(image, imageUrl);\n    } else {\n      this.addImage(imageUrl, uid, isLoader);\n    }\n\n    this._plugin.getCore().hideButtons();\n  }\n\n  addParagraph(el) {\n      const paragraph = document.createElement('p');\n      paragraph.innerHTML = '<br>';\n      el.insertAdjacentElement('afterend', paragraph);\n  }\n\n  addImage(url, uid, isLoader) {\n    const el = this._plugin.getCore().selectedElement,\n      figure = document.createElement('figure'),\n      img = document.createElement('img'),\n      descriptionContainer = document.createElement('div'),\n      description = document.createElement('figcaption');\n    let domImage;\n\n    img.alt = '';\n\n    if (uid) {\n      img.setAttribute('data-uid', uid);\n    }\n\n    descriptionContainer.classList.add(this.descriptionContainerClassName);\n    description.contentEditable = true;\n    description.classList.add(this.descriptionClassName);\n    description.dataset.placeholder = this.descriptionPlaceholder;\n\n    // If we're dealing with a preview image,\n    // we don't have to preload it before displaying\n    if (url.match(/^data:/)) {\n      img.src = url;\n      figure.appendChild(img);\n      el.appendChild(figure);\n    } else {\n      domImage = new Image();\n      domImage.onload = () => {\n        img.src = domImage.src;\n        if (!isLoader) {\n          img.classList.add(this.activeClassName);\n        }\n        figure.appendChild(img);\n        descriptionContainer.appendChild(description);\n        figure.appendChild(descriptionContainer);\n        el.appendChild(figure);\n\n        if ((!el.nextSibling || !el.nextSibling.nextSibling) && !isLoader) {\n            this.addParagraph(el);\n        }\n      };\n\n      domImage.src = url;\n      if (isLoader) {\n        el.classList.add(this.loadingClassName);\n      }\n    }\n\n    el.classList.add(this.elementClassName);\n    el.classList.add(this.alignCenterClassName);\n\n    el.contentEditable = false;\n\n\n    // Return domImage so we can test this function easily\n    return domImage;\n  }\n\n  replaceImage(image, url) {\n    const domImage = new Image();\n    const el = this._plugin.getCore().selectedElement;\n\n    el.querySelector('img').classList.add(this.activeClassName);\n    el.classList.remove(this.loadingClassName);\n    if (!el.nextSibling || !el.nextSibling.nextSibling) {\n        this.addParagraph(el);\n    }\n\n    domImage.onload = () => {\n      image.src = domImage.src;\n      image.removeAttribute('data-uid');\n    };\n\n    domImage.src = url;\n\n    // Return domImage so we can test this function easily\n    return domImage;\n  }\n\n  selectImage(e) {\n    const el = e.target;\n    this.selectImageCore(el);\n  }\n  \n  selectImageCore(el){\n    if (el.nodeName.toLowerCase() === 'img' && utils.getClosestWithClassName(el, this.elementClassName)) {\n      const parentNode = el.parentNode.parentNode;\n\n      if (!parentNode.classList.contains(this.loadingClassName)) {\n        el.classList.add(this.activeClassName);\n        // parentNode.classList.add(this.activeClassName);\n        // TODO: The value is correct, but the medium sometimes change\n        this._editor.selectElement(parentNode);\n        this.activeImageElement = parentNode;\n      }\n    }\n  }\n\n\n  unselectImage(e) {\n    const el = e.target;\n    let clickedImage, images;\n\n    if (el.classList.contains(this.descriptionClassName)) return false;\n\n    // Unselect all selected images. If an image is clicked, unselect all except this one.\n    if (el.nodeName.toLowerCase() === 'img' && el.classList.contains(this.activeClassName)) {\n      clickedImage = el;\n    }\n\n    images = utils.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName);\n    Array.prototype.forEach.call(images, (image) => {\n      if (image !== clickedImage) {\n        image.classList.remove(this.activeClassName);\n      }\n    });\n    this.activeImage = null;\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n    const isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\n    // Enter key in description\n    if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n      if (isDescriptionElement) {\n        return e.preventDefault();\n      }\n    }\n\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n      this.removeImage(e);\n    }\n\n    // Down, enter\n    if (e.which === 40 || e.which === 13) {\n      // Detect selected image\n      const selectedImageDOM = document.querySelector(`.${this.activeClassName}`);\n      const selectedImageParentDOM = selectedImageDOM && selectedImageDOM.parentNode.parentNode;\n      if (selectedImageParentDOM) {\n        let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\n        if (!nextSiblingParagraphDOM) {\n          // Insert paragraph and focus\n          this.addParagraph(selectedImageParentDOM);\n        }\n\n        // Focus next paragraph\n        nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\n        if (nextSiblingParagraphDOM) {\n          if (!nextSiblingParagraphDOM.innerHTML) {\n              nextSiblingParagraphDOM.innerHTML = '<br>';\n          }\n          window.getSelection().removeAllRanges();\n          this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n          MediumEditor.selection.clearSelection(document, true);\n          selectedImageDOM.classList.remove(this.activeClassName);\n          e.preventDefault();\n        }\n      }\n    }\n  }\n\n  removeImage(e) {\n    const images = utils.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName),\n      selection = window.getSelection();\n    let selectedHtml;\n\n    // Remove image even if it's not selected, but backspace/del is pressed in text\n    if (selection && selection.rangeCount) {\n      const range = MediumEditor.selection.getSelectionRange(document),\n        focusedElement = MediumEditor.selection.getSelectedParentElement(range),\n        caretPosition = MediumEditor.selection.getCaretOffsets(focusedElement).left;\n      let sibling;\n\n      // Is backspace pressed and caret is at the beginning of a paragraph, get previous element\n      if (e.which === MediumEditor.util.keyCode.BACKSPACE && caretPosition === 0) {\n        sibling = focusedElement.previousElementSibling;\n        // Is del pressed and caret is at the end of a paragraph, get next element\n      } else if (e.which === MediumEditor.util.keyCode.DELETE && caretPosition === focusedElement.innerText.length) {\n        sibling = focusedElement.nextElementSibling;\n      }\n\n      if (sibling && sibling.classList.contains('medium-editor-insert-images')) {\n        const newImages = sibling.getElementsByTagName('img');\n        Array.prototype.forEach.call(newImages, (image) => {\n          images.push(image);\n        });\n      }\n\n      // If text is selected, find images in the selection\n      selectedHtml = MediumEditor.selection.getSelectionHtml(document);\n      if (selectedHtml) {\n        const temp = document.createElement('div');\n        let wrappers, newImages;\n        temp.innerHTML = selectedHtml;\n\n        wrappers = temp.getElementsByClassName('medium-editor-insert-images');\n        newImages = utils.getElementsByTagName(wrappers, 'img');\n\n        Array.prototype.forEach.call(newImages, (image) => {\n          images.push(image);\n        });\n      }\n    }\n\n    if (images.length) {\n      if (!selectedHtml) {\n        e.preventDefault();\n      }\n\n      images.forEach((image) => {\n        const wrapper = utils.getClosestWithClassName(image, 'medium-editor-insert-images');\n        this.deleteFile(image.src);\n\n        image.parentNode.remove();\n\n        // If wrapper has no images anymore, remove it\n        if (wrapper.childElementCount === 0) {\n          const next = wrapper.nextElementSibling,\n            prev = wrapper.previousElementSibling;\n\n          wrapper.remove();\n\n          // If there is no selection, move cursor at the beginning of next paragraph (if delete is pressed),\n          // or nove it at the end of previous paragraph (if backspace is pressed)\n          if (!selectedHtml) {\n            if (next || prev) {\n              if ((next && e.which === MediumEditor.util.keyCode.DELETE) || !prev) {\n                MediumEditor.selection.moveCursor(document, next, 0);\n              } else {\n                MediumEditor.selection.moveCursor(document, prev.lastChild, prev.lastChild.textContent.length);\n              }\n            }\n          }\n        }\n      });\n    }\n  }\n\n  deleteFile(image) {\n    if (this.options.deleteUrl) {\n      const xhr = new XMLHttpRequest(),\n        data = Object.assign({}, {\n          file: image\n        }, this.options.deleteData);\n\n      xhr.open(this.options.deleteMethod, this.options.deleteUrl, true);\n      xhr.send(data);\n    }\n  }\n\n  destroy() {\n\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/Images.js"],"sourceRoot":""}