{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///medium-editor-insert.min.js","webpack:///webpack/bootstrap d91b91cba537fb3f4b23","webpack:///./src/js/Plugin.js","webpack:///./src/js/utils.js","webpack:///./src/js/Toolbar.js","webpack:///./src/js/Core.js","webpack:///./src/js/ToolbarButton.js","webpack:///./src/js/addons/Chapters.js","webpack:///./src/js/addons/Embeds.js","webpack:///./src/js/addons/Images.js","webpack:///./src/js/addons/PayWall.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_Core","_Core2","MediumEditorInsert","MediumEditor","Extension","extend","name","addons","images","embeds","chapters","paywall","_initializedAddons","init","prototype","apply","arguments","core","destroy","removeButtons","getCore","getAddons","getAddon","utils","ucfirst","str","charAt","toUpperCase","slice","generateRandomString","length","undefined","Math","random","toString","substr","getClosestWithClassName","el","className","util","traverseUp","element","classList","contains","isChildOf","parent","getElementsByClassName","parents","results","Array","forEach","editor","elements","push","getElementsByTagName","tagName","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","i","descriptor","key","protoProps","staticProps","_utils","_utils2","_ToolbarButton","_ToolbarButton2","MediumEditorToolbar","extensions","toolbar","Toolbar","_MediumEditorToolbar","options","_this","getPrototypeOf","type","buttons","buttonOptions","button","assign","window","plugin","document","base","createElement","getEditorId","static","relativeContainer","appendChild","createToolbarButtons","forEachExtension","extension","hasForm","getForm","attachEventHandlers","_this2","ul","li","btn","buttonName","buttonOpts","style","display","addBuiltInExtension","getButton","isElement","innerHTML","querySelectorAll","add","firstButtonClass","lastButtonClass","_this3","activeElements","preventSelectionUpdates","setTimeout","getEditorElements","activeClassName","hideToolbar","showAndUpdateToolbar","container","anchorPreview","showToolbar","positionStaticToolbar","getExtensionByName","hidePreview","_Images","_Images2","_Embeds","_Embeds2","_Chapters","_Chapters2","_PayWall","_PayWall2","Core","_plugin","_editor","initAddons","addButtons","events","addonActions","on","toggleButtons","bind","toggleAddons","action","handleAddonClick","positionButtons","keys","addonOptions","console","error","html","setAttribute","addon","label","body","remove","elPosition","addonButton","addonsStyle","addonButtonStyle","position","getSelectedParentElement","getBoundingClientRect","getComputedStyle","top","scrollY","left","scrollX","parseInt","marginLeft","shouldDisplayButtonsOnElement","selectElement","showButtons","hideButtons","addonClassNames","isAddon","belongsToEditor","innerText","trim","addonName","elementClassName","selectedElement","toggle","e","currentTarget","getAttribute","preventDefault","handleClick","ToolbarButton","evt","onClick","_Toolbar","_Toolbar2","Chapters","captions","storeMeta","styles","wide","actions","clicked","parseOnPaste","alignLeftClassName","alignCenterClassName","descriptionPlaceholder","initToolbar","unselectEmbed","handleKey","selectEmbed","getClosestElementByClassName","selectEmbedCore","event","stopPropagation","parentNode","getSelection","unselectEmbedCore","clickedEmbed","nextSiblingDOM","nextSibling","nextSiblingParagraphDOM","which","selectedEmbedDOM","querySelector","getSiblingParagraph","paragraph","insertAdjacentElement","removeAllRanges","selection","clearSelection","keyCode","BACKSPACE","DELETE","indexOf","removeEmbed","currentSelection","range","createRange","setStart","addRange","setFocusOnElement","embedChapter","changeAlign","setToolbarPosition","onChange","chapter","contentHTML","replaceWith","onInsert","cancelEmbed","Embeds","placeholder","oembedProxy","captionPlaceholder","right","log","placeholderClassName","loadingClassName","descriptionContainerClassName","descriptionClassName","overlayClassName","alignRightClassName","alignCenterWideClassName","alignCenterFullClassName","selectedEl","activeEmbedElement","embed","isDescriptionElement","ENTER","instanceHandlePaste","handlePaste","instanceHandleKeyDown","handleKeyDown","handleBlur","pastedUrl","clipboardData","getData","linkRegEx","RegExp","linkRegEx2","test","oembed","parseUrl","url","pasted","urlOut","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","data","JSON","parse","responseText","send","join","replace","info","figure","descriptionContainer","description","metacontainer","overlay","lastEl","contentEditable","dataset","lastChild","nodeType","previousSibling","lastP","FB","XFBML","click","removeAttribute","hidePlaceholder","off","instanceHandleKeyUp","Images","preview","uploadUrl","deleteUrl","deleteMethod","deleteData","activeImageElement","isLoaderShowing","unselectImage","selectImage","onInsertButtonClick","uid","imageUrl","insertImage","_input","multiple","uploadFiles","title","files","file","upload","_this4","reader","FileReader","onload","result","readAsDataURL","FormData","append","isLoader","nodeName","toLowerCase","div","insertBefore","addImage","_this5","Promise","resolve","reject","img","domImage","alt","match","src","Image","addParagraph","image","selectImageCore","_this6","clickedImage","activeImage","getRangeAt","br","textNode","createTextNode","deleteContents","insertNode","collapse","selectNodeContents","removeImage","selectedImageDOM","selectedImageParentDOM","_this7","selectedHtml","rangeCount","getSelectionRange","focusedElement","caretPosition","getCaretOffsets","sibling","previousElementSibling","nextElementSibling","newImages","getSelectionHtml","temp","wrappers","wrapper","deleteFile","childElementCount","next","prev","moveCursor","textContent","PayWall","embedPaywall","prevPaywallDOM"],"mappings":"CAAA,SAAAA,EAAAC,GACA,gBAAAC,UAAA,gBAAAC,QACAA,OAAAD,QAAAD,IACA,kBAAAG,gBAAAC,IACAD,UAAAH,GACA,gBAAAC,SACAA,QAAA,mBAAAD,IAEAD,EAAA,mBAAAC,KACCK,KAAA,WACD,MCAgB,UAAUC,GCN1B,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAP,OAGA,IAAAC,GAAAO,EAAAD,IACAP,WACAS,GAAAF,EACAG,QAAA,EAUA,OANAL,GAAAE,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAS,QAAA,EAGAT,EAAAD,QAvBA,GAAAQ,KAqCA,OATAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,GAGAR,EAAA,KDgBM,SAAUL,EAAQD,EAASM,GAEhC,YAUA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GARvFG,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GE3DV,IAAAC,GAAAhB,EAAA,GFgEKiB,EAASR,EAAuBO,GE9D/BE,EAAqBC,aAAaC,UAAUC,QAChDC,KAAM,SAENC,QACEC,QAAQ,EACRC,QAAQ,EACRC,UAAU,EACVC,SAAS,GAGXC,sBAEAC,KAAM,WACJV,aAAaC,UAAUU,UAAUD,KAAKE,MAAMjC,KAAMkC,WAElDlC,KAAKmC,KAAO,GAAAhB,GAAAL,QAASd,OAGvBoC,QAAS,WACPpC,KAAKmC,KAAKE,iBAGZC,QAAS,WACP,MAAOtC,MAAKmC,MAGdI,UAAW,WACT,MAAOvC,MAAK8B,oBAGdU,SAAU,SAAShB,GACjB,MAAOxB,MAAK8B,mBAAmBN,KFsElC5B,GAAQkB,QElEMM,EFmEdvB,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,GAEvB,YAEAmB,QAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GGjHV,IAAMwB,IACJC,QAAS,SAACC,GACR,MAAOA,GAAIC,OAAO,GAAGC,cAAgBF,EAAIG,MAAM,IAGjDC,qBAAsB,WAAiB,GAAhBC,GAAgBd,UAAAc,OAAA,GAAAC,SAAAf,UAAA,GAAAA,UAAA,GAAP,EAC9B,OAAOgB,MAAKC,SAASC,SAAS,IAAIC,OAAO,EAAGL,IAG9CM,wBAAyB,SAACC,EAAIC,GAC5B,MAAOnC,cAAaoC,KAAKC,WAAWH,EAAI,SAACI,GACvC,MAAOA,GAAQC,UAAUC,SAASL,MAItCM,UAAW,SAACP,EAAIQ,GACd,QAAO1C,aAAaoC,KAAKC,WAAWH,EAAI,SAACI,GACvC,MAAOA,KAAYI,KAIvBC,uBAAwB,SAACC,EAAST,GAChC,GAAMU,KAUN,OARAC,OAAMnC,UAAUoC,QAAQ7D,KAAK0D,EAAS,SAACI,GACrC,GAAMC,GAAWD,EAAOL,uBAAuBR,EAE/CW,OAAMnC,UAAUoC,QAAQ7D,KAAK+D,EAAU,SAACX,GACtCO,EAAQK,KAAKZ,OAIVO,GAGTM,qBAAsB,SAACP,EAASQ,GAC9B,GAAMP,KAUN,OARAC,OAAMnC,UAAUoC,QAAQ7D,KAAK0D,EAAS,SAACI,GACrC,GAAMC,GAAWD,EAAOG,qBAAqBC,EAE7CN,OAAMnC,UAAUoC,QAAQ7D,KAAK+D,EAAU,SAACX,GACtCO,EAAQK,KAAKZ,OAIVO,GHyHVtE,GAAQkB,QGrHM2B,EHsHd5C,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMxE,GAAQ,IAAKwE,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOzE,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BwE,EAAPxE,EAElO,QAAS0E,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASlD,UAAYjB,OAAOqE,OAAOD,GAAcA,EAAWnD,WAAaqD,aAAepE,MAAOiE,EAAUI,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeL,IAAYpE,OAAO0E,eAAiB1E,OAAO0E,eAAeP,EAAUC,GAAcD,EAASQ,UAAYP,GApBjepE,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MIpLjiBwB,EAAAlG,EAAA,GJwLKmG,EAAU1F,EAAuByF,GIvLtCE,EAAApG,EAAA,GJ2LKqG,EAAkB5F,EAAuB2F,GIzLxCE,EAAsBnF,aAAaoF,WAAWC,QAE/BC,EJmMN,SAAUC,GIjMvB,QAAAD,GAAYE,GAASnC,EAAA1E,KAAA2G,EAAA,IAAAG,GAAAhC,EAAA9E,MAAA2G,EAAAjB,WAAA3E,OAAAgG,eAAAJ,IAAApG,KAAAP,KACb6G,GADa,OAGnBC,GAAKtF,KAAUqF,EAAQG,KAAvB,UAEAH,EAAQI,QAAQ7C,QAAQ,SAAC8C,GACvB,GAAMC,GAAS,GAAAZ,GAAAzF,QAAkBC,OAAOqG,WACtCC,OAAQP,EAAKQ,OAAOD,OACpBE,SAAUT,EAAKQ,OAAOC,SACtBC,KAAMV,EAAKQ,OAAOE,MACjBN,GAEHC,GAAOpF,OACP+E,EAAKQ,OAAOE,KAAKf,WAAWlC,KAAK4C,KAGnCL,EAAKO,OAASR,EAAQS,OAAOD,OAC7BP,EAAKS,SAAWV,EAAQS,OAAOC,SAC/BT,EAAKU,KAAOX,EAAQS,OAAOE,KAE3BV,EAAK/E,OApBc+E,EJ2VpB,MAzJA7B,GAAU0B,EAASC,GA4BnBjB,EAAagB,IACXV,IAAK,gBACLhF,MAAO,WIxMR,GAAMyF,GAAU1G,KAAKuH,SAASE,cAAc,MAwB5C,OAtBAf,GAAQrG,GAAR,wBAAqCL,KAAKgH,KAA1C,YAA0DhH,KAAK0H,cAC/DhB,EAAQlD,UAAY,wBAEhBxD,KAAK2H,OACPjB,EAAQlD,WAAa,kBACZxD,KAAK4H,kBACdlB,EAAQlD,WAAa,kCAErBkD,EAAQlD,WAAa,iCAGvBkD,EAAQmB,YAAY7H,KAAK8H,wBAGzB9H,KAAK+H,iBAAiB,SAACC,GACjBA,EAAUC,SACZvB,EAAQmB,YAAYG,EAAUE,aAIlClI,KAAKmI,sBAEEzB,KJ4MNT,IAAK,uBACLhF,MAAO,WI1Ma,GAAAmH,GAAApI,KACfqI,EAAKrI,KAAKuH,SAASE,cAAc,MACnCa,SACFC,SACAtB,SACAe,SACAQ,SACAC,QAqCF,OAnCAJ,GAAGhI,GAAH,wBAAgCL,KAAKgH,KAArC,mBAA4DhH,KAAK0H,cACjEW,EAAG7E,UAAY,gCACf6E,EAAGK,MAAMC,QAAU,QAEnB3I,KAAKiH,QAAQ7C,QAAQ,SAAC+C,GACE,gBAAXA,IACTqB,EAAarB,EACbsB,EAAa,OAEbD,EAAarB,EAAO3F,KACpBiH,EAAatB,GAKfa,EAAYI,EAAKZ,KAAKoB,oBAAoBJ,EAAYC,GAElDT,GAA4C,kBAAxBA,GAAUa,YAChCN,EAAMP,EAAUa,UAAUT,EAAKZ,MAC/Bc,EAAKF,EAAKb,SAASE,cAAc,MAC7BpG,aAAaoC,KAAKqF,UAAUP,GAC9BD,EAAGT,YAAYU,GAEfD,EAAGS,UAAYR,EAEjBF,EAAGR,YAAYS,KAEhBtI,MAEHiH,EAAUoB,EAAGW,iBAAiB,UAC1B/B,EAAQjE,OAAS,IACnBiE,EAAQ,GAAGrD,UAAUqF,IAAIjJ,KAAKkJ,kBAC9BjC,EAAQA,EAAQjE,OAAS,GAAGY,UAAUqF,IAAIjJ,KAAKmJ,kBAG1Cd,KJ+MNpC,IAAK,aACLhF,MAAO,WI7MG,GAAAmI,GAAApJ,KACPqJ,QAEArJ,MAAKwH,KAAK8B,yBAKdC,WAAW,WAIT,MAHAF,GAAiBhD,EAAAvF,QAAMkD,uBAAuBoF,EAAKI,oBAAqBJ,EAAKK,iBAG/C,IAA1BJ,EAAerG,OACVoG,EAAKM,kBAIdN,GAAKO,wBACJ,OJkNF1D,IAAK,qBACLhF,MAAO,WI/MR,GAAM2I,GAAYvD,EAAAvF,QAAMkD,uBAAuBhE,KAAKwJ,oBAAqBxJ,KAAKyJ,iBAAiB,GAC3FI,QAGJ,OAAKD,IAIL5J,KAAK8J,cACL9J,KAAK+J,sBAAsBH,GAE3BC,EAAgB7J,KAAKwH,KAAKwC,mBAAmB,uBAEzCH,GAAsD,kBAA9BA,GAAcI,aACxCJ,EAAcI,gBATPjK,SJ8NH2G,GI7V2BH,EJgWpC5G,GAAQkB,QIhWY6F,EJiWpB9G,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YA4BA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA5BhH9D,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MKlXjiBwB,EAAAlG,EAAA,GLsXKmG,EAAU1F,EAAuByF,GKrXtC8D,EAAAhK,EAAA,GLyXKiK,EAAWxJ,EAAuBuJ,GKxXvCE,EAAAlK,EAAA,GL4XKmK,EAAW1J,EAAuByJ,GK3XvCE,EAAApK,EAAA,GL+XKqK,EAAa5J,EAAuB2J,GK9XzCE,EAAAtK,EAAA,GLkYKuK,EAAY9J,EAAuB6J,GKhYnBE,ELsYT,WKpYV,QAAAA,GAAYpD,GAAQ5C,EAAA1E,KAAA0K,GAClB1K,KAAK2K,QAAUrD,EACftH,KAAK4K,QAAU5K,KAAK2K,QAAQnD,KAE5BxH,KAAK6K,aACL7K,KAAK8K,aACL9K,KAAK+K,SLomBN,MA1NApF,GAAa+E,IACXzE,IAAK,SACLhF,MAAO,WKzYD,GAAA6F,GAAA9G,KACHgL,QAIJhL,MAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKkL,cAAcC,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKkL,cAAcC,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAGjL,KAAKiH,QAAQjD,uBAAuB,qCAAqC,GAAI,QAAShE,KAAKoL,aAAaD,KAAKnL,OAI7HgL,EAAehL,KAAKiH,QAAQjD,uBAAuB,+BACnDG,MAAMnC,UAAUoC,QAAQ7D,KAAKyK,EAAc,SAACK,GAE1CvE,EAAK6D,QAAQM,GAAGI,EAAQ,QAASvE,EAAKwE,iBAAiBH,KAAtBrE,MAGnC9G,KAAK2K,QAAQM,GAAG5D,OAAQ,SAAUrH,KAAKuL,gBAAgBJ,KAAKnL,UL8Y3DiG,IAAK,aACLhF,MAAO,WK5YG,GAAAmH,GAAApI,IAEXA,MAAK2K,QAAQ7I,oBACXJ,OAAQ,GAAAyI,GAAArJ,QAAWd,KAAK2K,QAAS3K,KAAK2K,QAAQlJ,OAAOC,QACrDC,OAAQ,GAAA0I,GAAAvJ,QAAWd,KAAK2K,QAAS3K,KAAK2K,QAAQlJ,OAAOE,QACrDC,SAAU,GAAA2I,GAAAzJ,QAAad,KAAK2K,QAAS3K,KAAK2K,QAAQlJ,OAAOG,UACzDC,QAAS,GAAA4I,GAAA3J,QAAYd,KAAK2K,QAAS3K,KAAK2K,QAAQlJ,OAAOI,UAGzDd,OAAOyK,KAAKxL,KAAK2K,QAAQlJ,QAAQ2C,QAAQ,SAAC5C,GACxC,GAAMiK,GAAerD,EAAKuC,QAAQlJ,OAAOD,EAGpC4G,GAAKuC,QAAQ7I,mBAAmBN,KACP,kBAAjBiK,GACTrD,EAAKuC,QAAQ7I,mBAAmBN,GAAQ,GAAIiK,GAAarD,EAAKuC,SAE9DtD,OAAOqE,QAAQC,MAAf,2CAA+DnK,EAA/D,aAKCiK,SACIrD,GAAKuC,QAAQ7I,mBAAmBN,QLmZ1CyE,IAAK,aACLhF,MAAO,WK9YR,GAAMQ,GAASzB,KAAK2K,QAAQpI,YACxBqJ,QAEJ5L,MAAKiH,QAAUM,SAASE,cAAc,OACtCzH,KAAKiH,QAAQ5G,GAAb,wBAA0CL,KAAK2K,QAAQjD,cACvD1H,KAAKiH,QAAQrD,UAAUqF,IAAI,gCAC3BjJ,KAAKiH,QAAQ4E,aAAa,kBAAkB,GAE5CD,qHAGA7K,OAAOyK,KAAK/J,GAAQ2C,QAAQ,SAAC5C,GAC3B,GAAMsK,GAAQrK,EAAOD,EAErBoK,8DAAkEpK,EAAlE,KAA2EsK,EAAMC,MAAjF,cAGFH,WAEA5L,KAAKiH,QAAQ8B,UAAY6C,EAEzBrE,SAASyE,KAAKnE,YAAY7H,KAAKiH,YLiZ9BhB,IAAK,gBACLhF,MAAO,WK9YRjB,KAAKiH,QAAQgF,YLkZZhG,IAAK,kBACLhF,MAAO,WK/YR,GAAIsC,UAAI2I,SAAYzK,SAAQ0K,SAAaC,SAAaC,SAAkBC,QAGpEtM,MAAKiH,QAAQrD,UAAUC,SAAS,0CAA2C,IAI/EN,EAAKvD,KAAK4K,QAAQ2B,2BAClBL,EAAa3I,EAAGiJ,wBAChB/K,EAASzB,KAAKiH,QAAQjD,uBAAuB,uCAAuC,GACpFmI,EAAcnM,KAAKiH,QAAQjD,uBAAuB,+BAA+B,GACjFoI,EAAc/E,OAAOoF,iBAAiBhL,GACtC4K,EAAmBhF,OAAOoF,iBAAiBN,GAG3CG,GACEI,IAAKrF,OAAOsF,QAAUT,EAAWQ,IACjCE,KAAMvF,OAAOwF,QAAUX,EAAWU,KAAOE,SAASV,EAAYQ,KAAM,IAAME,SAAST,EAAiBU,WAAY,KAKlHT,EAASM,KAAON,EAASM,KAAO,EAAIV,EAAWU,KAAON,EAASM,KAE/D5M,KAAKiH,QAAQyB,MAAMkE,KAAUN,EAASM,KAAtC,KACA5M,KAAKiH,QAAQyB,MAAMgE,IAASJ,EAASI,IAArC,SLyZCzG,IAAK,gBACLhF,MAAO,WKtZR,GAAMsC,GAAKvD,KAAK4K,QAAQ2B,0BAEpBvM,MAAKgN,8BAA8BzJ,IACrCvD,KAAKiN,cAAc1J,GACnBvD,KAAKkN,eAELlN,KAAKmN,iBL2ZNlH,IAAK,gCACLhF,MAAO,SKxZoBsC,GAC5B,GAAM9B,GAASzB,KAAK2K,QAAQpI,YAC1B6K,KACEC,GAAU,EACZC,GAAkB,CAGpB,OAA4B,KAAxB/J,EAAGgK,UAAUC,SAKjBxN,KAAK2K,QAAQnB,oBAAoBpF,QAAQ,SAACC,GACxC,GAAIgC,EAAAvF,QAAMgD,UAAUP,EAAIc,GAEtB,YADAiJ,GAAkB,OAKjBA,IAKLvM,OAAOyK,KAAK/J,GAAQ2C,QAAQ,SAACqJ,GAC3B,GAAM3B,GAAQrK,EAAOgM,EACjB3B,GAAM4B,kBACRN,EAAgB7I,KAAKuH,EAAM4B,oBAM/BN,EAAgBhJ,QAAQ,SAACZ,GACvB,GAAID,EAAGK,UAAUC,SAASL,IAAc6C,EAAAvF,QAAMwC,wBAAwBC,EAAIC,GAExE,YADA6J,GAAU,MAKNA,OL2ZPpH,IAAK,gBACLhF,MAAO,SKzZIsC,GACZvD,KAAK2N,gBAAkBpK,KL4ZtB0C,IAAK,cACLhF,MAAO,WKzZRjB,KAAKiH,QAAQrD,UAAUqF,IAAI,uCAC3BjJ,KAAKuL,qBL6ZJtF,IAAK,cACLhF,MAAO,WK1ZRjB,KAAKiH,QAAQrD,UAAUqI,OAAO,uCAC9BjM,KAAKiH,QAAQrD,UAAUqI,OAAO,yCL8Z7BhG,IAAK,eACLhF,MAAO,WK3ZRjB,KAAKiH,QAAQrD,UAAUgK,OAAO,yCLwa7B3H,IAAK,mBACLhF,MAAO,SK9ZO4M,GACf,GAAMrM,GAAOqM,EAAEC,cAAcC,aAAa,aAC1CF,GAAEG,iBAEFhO,KAAK2K,QAAQnI,SAAShB,GAAMyM,YAAYJ,GACxC7N,KAAKmN,kBLkaCzC,IAGT9K,GAAQkB,QK/mBY4J,ELgnBpB7K,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,GAEvB,YAEAmB,QAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GM/nBV,IAAMiN,GAAgB7M,aAAaoF,WAAWU,OAAO5F,QACnDQ,KAAM,WACJ/B,KAAKmH,OAASnH,KAAKuH,SAASE,cAAc,UAC1CzH,KAAKmH,OAAOvD,UAAUqF,IAAI,wBAC1BjJ,KAAKmH,OAAOvD,UAAUqF,IAAIjJ,KAAKwD,WAC/BxD,KAAKmH,OAAO4B,UAAZ,MAA8B/I,KAAK+L,MAAnC,OAEA/L,KAAKiL,GAAGjL,KAAKmH,OAAQ,QAASnH,KAAKiO,YAAY9C,KAAKnL,QAGtD6I,UAAW,WACT,MAAO7I,MAAKmH,QAGd8G,YAAa,SAASE,GACpBnO,KAAKoO,QAAQD,KNqoBhBvO,GAAQkB,QMjoBMoN,ENkoBdrO,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhBhH9D,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MOjqBjiBwB,EAAAlG,EAAA,GPqqBKmG,EAAU1F,EAAuByF,GOpqBtCiI,EAAAnO,EAAA,GPwqBKoO,EAAY3N,EAAuB0N,GOtqBnBE,EP4qBL,WO1qBd,QAAAA,GAAYjH,EAAQT,GAASnC,EAAA1E,KAAAuO,GAC3BvO,KAAK6G,SACHkF,MAAO,mCACPyC,UAAU,EACVC,WAAW,EACXC,QACE9B,MACEb,MAAO,0CAET4C,MACE5C,MAAO,8CAGX6C,SACE3C,QACEF,MAAO,oCACP8C,QAAS,eAQbC,cAAc,GAGhB/N,OAAOqG,OAAOpH,KAAK6G,QAASA,GAE5B7G,KAAK2K,QAAUrD,EACftH,KAAK4K,QAAU5K,KAAK2K,QAAQnD,KAE5BxH,KAAKyJ,gBAAkB,6CACvBzJ,KAAK0N,iBAAmB,sCAExB1N,KAAK+O,mBAAqB,aAC1B/O,KAAKgP,qBAAuB,oBAE5BhP,KAAK+L,MAAQ/L,KAAK6G,QAAQkF,MAC1B/L,KAAKiP,uBAAyBjP,KAAK6G,QAAQoI,uBAE3CjP,KAAKkP,cACLlP,KAAK+K,SP46BN,MA5PApF,GAAa4I,IACXtI,IAAK,SACLhF,MAAO,WO9qBD,GAAA6F,GAAA9G,IACPA,MAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKmP,cAAchE,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAG1D,SAAU,UAAWvH,KAAKoP,UAAUjE,KAAKnL,OAEzDA,KAAK2K,QAAQnB,oBAAoBpF,QAAQ,SAACC,GACxCyC,EAAK6D,QAAQM,GAAG5G,EAAQ,QAASyC,EAAKuI,YAAYlE,KAAjBrE,SPorBlCb,IAAK,cACLhF,MAAO,SOjrBE4M,GACV,GAAMtK,GAAKsK,EAAEhI,MACT7F,MAAKsP,6BAA6B/L,EAAIvD,KAAK0N,oBAC7C1N,KAAKuP,gBAAgBhM,EAAIiM,OACzB3B,GAAKA,EAAE4B,kBACP5B,GAAKA,EAAEG,qBPqrBR/H,IAAK,+BACLhF,MAAO,SOlrBmBsC,EAAIC,GAC/B,KAAOD,GAAI,CACT,GAAIA,EAAGK,WAAaL,EAAGK,UAAUC,SAASL,GAAY,MAAOD,EAC7DA,GAAKA,EAAGmM,ePsrBTzJ,IAAK,kBACLhF,MAAO,SOlrBMsC,GACd,GAAMI,GAAU3D,KAAKsP,6BAA6B/L,EAAIvD,KAAK0N,iBAC3D/J,GAAQC,UAAUqF,IAAIjJ,KAAKyJ,gBACFpC,QAAOsI,kBPqrB/B1J,IAAK,gBACLhF,MAAO,SOnrBI4M,GACZ,GAAMtK,GAAKsK,EAAEhI,MACb7F,MAAK4P,kBAAkBrM,MPsrBtB0C,IAAK,oBACLhF,MAAO,SOprBQsC,GAAI,GAAA6E,GAAApI,KAChB6P,SAAuCjO,QAG3C,OADAA,GAAWyE,EAAAvF,QAAMkD,uBAAuBhE,KAAK2K,QAAQnB,oBAAqBxJ,KAAK0N,qBAC1E9L,IAAaA,EAASoB,cAIvBpB,GACFuC,MAAMnC,UAAUoC,QAAQ7D,KAAKqB,EAAU,SAACA,GAClCA,IAAaiO,GACfjO,EAASgC,UAAUqI,OAAO7D,EAAKqB,uBP+rBpCxD,IAAK,sBACLhF,MAAO,SO1rBUsC,GAClB,IAAKA,EAAI,OAAO,CAKhB,KAHA,GAAIuM,GAAiBvM,EAAGwM,YACpBC,SAEGF,IAAmBE,GACpBF,GAA6C,MAA3BA,EAAerL,QACnCuL,EAA0BF,EAE1BA,EAAiBA,EAAeC,WAIpC,OAAOC,MP6rBN/J,IAAK,YACLhF,MAAO,SO3rBA4M,GACOA,EAAEhI,MAIjB,IAAgB,KAAZgI,EAAEoC,OAA4B,KAAZpC,EAAEoC,MAAc,CAEpC,GAAMC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBAEzD,IAAIyG,EAAkB,CACpB,GAAIF,GAA0BhQ,KAAKoQ,oBAAoBF,EAEvD,KAAKF,EAAyB,CAE5B,GAAMK,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBmH,EAAiBI,sBAAsB,WAAYD,GAIrDL,EAA0BhQ,KAAKoQ,oBAAoBF,GAE/CF,IACGA,EAAwBjH,YAC3BiH,EAAwBjH,UAAY,QAEtC1B,OAAOsI,eAAeY,kBACtBvQ,KAAK2K,QAAQrI,UAAUsI,QAAQqC,cAAc+C,GAC7CE,EAAiBtM,UAAUqI,OAAOjM,KAAKyJ,iBACvCpI,aAAamP,UAAUC,eAAelJ,UAAU,GAChD2I,EAAiBtM,UAAUqI,OAAOjM,KAAKyJ,iBACvCoE,EAAEG,oBAKH3M,aAAaoC,KAAKiN,QAAQC,UAAWtP,aAAaoC,KAAKiN,QAAQE,QAAQC,QAAQhD,EAAEoC,QAAS,EAC7FjQ,KAAK8Q,YAAYjD,GACRtG,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,kBAEzCoE,EAAEG,oBP8rBH/H,IAAK,oBACLhF,MAAO,SO3rBQsC,GAEhBgG,WAAW,WACT,GAAMwH,GAAmB1J,OAAOsI,eAC1BqB,EAAQzJ,SAAS0J,aACvBD,GAAME,SAAS3N,EAAI,GACnBwN,EAAiBR,kBACjBQ,EAAiBI,SAASH,IACzB,QP8rBF/K,IAAK,cACLhF,MAAO,WO3rBRjB,KAAKuD,GAAKvD,KAAK2K,QAAQrI,UAAUqL,gBACjC3N,KAAKoR,kBAAkBpR,KAAKuD,IAC5BvD,KAAKqR,aAAarR,KAAKuD,OP+rBtB0C,IAAK,cACLhF,MAAO,SO7rBE4M,GACV,GAAMqC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBACrDyG,KACFA,EAAiBjE,SACjB4B,EAAEG,iBACFH,EAAE4B,sBP0sBHxJ,IAAK,cACLhF,MAAO,WO/rBRjB,KAAK0G,QAAU,GAAA4H,GAAAxN,SACbwG,OAAQtH,KAAK2K,QACb3D,KAAM,WACNyC,gBAAiBzJ,KAAKyJ,gBACtBxC,UACIzF,KAAM,sBACN6J,OAAQ,aACR7H,UAAW,iBACXuI,MAAO,OACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAK+O,mBAAoB,sBAAuBZ,IAChEhD,KAAKnL,QAGRwB,KAAM,6BACN6J,OAAQ,oBACR7H,UAAW,wBACXuI,MAAO,SACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAKgP,qBAAsB,wBAAyBb,IACpEhD,KAAKnL,UAKdA,KAAK4K,QAAQnE,WAAWlC,KAAKvE,KAAK0G,YPisBjCT,IAAK,cACLhF,MAAO,SO/rBEuC,EAAW6H,EAAQ8C,GACzBA,IACFA,EAAIH,iBACJG,EAAIsB,kBAGN,IAAMlM,GAAKgE,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBAC3ClG,GAAGK,UAAUqI,OACXjM,KAAK+O,mBACL/O,KAAKgP,sBAEPzL,EAAGK,UAAUqF,IAAIzF,GAEjBxD,KAAK0G,QAAQ6K,qBAETvR,KAAK6G,QAAQ2K,UACfxR,KAAK6G,QAAQ2K,SAASnG,MPysBvBpF,IAAK,eACLhF,MAAO,SO7rBGsC,GACX,GAAMkO,GAAUlK,SAASE,cAAc,MACvCgK,GAAQ7N,UAAUqF,IAAIjJ,KAAK0N,iBAE3B,IAAIgE,SAgBJ,OAfI1R,MAAK6G,QAAQ6K,cAEbA,EADsC,kBAA7B1R,MAAK6G,QAAQ6K,YACR1R,KAAK6G,QAAQ6K,cAEb1R,KAAK6G,QAAQ6K,aAI3BA,IACFD,EAAQ1I,UAAY2I,EACpBnO,EAAGoO,YAAYF,GAEfzR,KAAK6G,QAAQ+K,UAAY5R,KAAK6G,QAAQ+K,aAGjC,KPgsBN3L,IAAK,UACLhF,MAAO,WO5rBRjB,KAAK6R,kBPisBCtD,IAGT3O,GAAQkB,QO39BYyN,EP49BpB1O,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhBhH9D,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MQ3+BjiBwB,EAAAlG,EAAA,GR++BKmG,EAAU1F,EAAuByF,GQ9+BtCiI,EAAAnO,EAAA,GRk/BKoO,EAAY3N,EAAuB0N,GQh/BnByD,ERs/BP,WQp/BZ,QAAAA,GAAYxK,EAAQT,GAASnC,EAAA1E,KAAA8R,GAC3B9R,KAAK6G,SACHkF,MAAO,2CACPgG,YAAa,8EACbC,YAAa,4DACbxD,UAAU,EACVyD,mBAAoB,0BACpBxD,WAAW,EACXC,QACEC,MACE5C,MAAO,6CAITa,MACEb,MAAO,0CAITmG,OACEnG,MAAO,4CAKX6C,SACE3C,QACEF,MAAO,oCACP8C,QAAS,eAQbC,cAAc,EACd0C,SAAU,SAACnG,GACTK,QAAQyG,IAAI,iBAAkB9G,KAIlCtK,OAAOqG,OAAOpH,KAAK6G,QAASA,GAE5B7G,KAAK2K,QAAUrD,EACftH,KAAK4K,QAAU5K,KAAK2K,QAAQnD,KAE5BxH,KAAKyJ,gBAAkB,qCACvBzJ,KAAKoS,qBAAuB,0CAC5BpS,KAAK0N,iBAAmB,8BACxB1N,KAAKqS,iBAAmB,sCACxBrS,KAAKyJ,gBAAkB,oCACvBzJ,KAAKsS,8BAAgC,kDACrCtS,KAAKuS,qBAAuB,wCAC5BvS,KAAKwS,iBAAmB,sCAExBxS,KAAK+O,mBAAqB,aAC1B/O,KAAKyS,oBAAsB,cAC3BzS,KAAKgP,qBAAuB,eAC5BhP,KAAK0S,yBAA2B,oBAChC1S,KAAK2S,yBAA2B,oBAEhC3S,KAAK+L,MAAQ/L,KAAK6G,QAAQkF,MAC1B/L,KAAKiP,uBAAyBjP,KAAK6G,QAAQoI,uBAE3CjP,KAAKkP,cACLlP,KAAK+K,SRu+CN,MA7eApF,GAAamM,IACX7L,IAAK,SACLhF,MAAO,WQx/BD,GAAA6F,GAAA9G,IACPA,MAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKmP,cAAchE,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAG1D,SAAU,UAAWvH,KAAKoP,UAAUjE,KAAKnL,OAEzDA,KAAK2K,QAAQnB,oBAAoBpF,QAAQ,SAACC,GACxCyC,EAAK6D,QAAQM,GAAG5G,EAAQ,QAASyC,EAAKuI,YAAYlE,KAAjBrE,SR8/BlCb,IAAK,cACLhF,MAAO,SQ1/BE4M,GACV,GAAMtK,GAAKsK,EAAEhI,MACb7F,MAAKuP,gBAAgBhM,MR6/BpB0C,IAAK,kBACLhF,MAAO,SQ3/BMsC,GACd,GAAIA,EAAGK,UAAUC,SAAS7D,KAAKwS,kBAAmB,CAChD,GAAMI,GAAavM,EAAAvF,QAAMwC,wBAAwBC,EAAIvD,KAAK0N,iBACrDkF,GAAWhP,UAAUC,SAAS7D,KAAKqS,oBACtCO,EAAWhP,UAAUqF,IAAIjJ,KAAKyJ,iBAC9BzJ,KAAK4K,QAAQqC,cAAc2F,GAC3B5S,KAAK6S,mBAAqBD,ORggC7B3M,IAAK,gBACLhF,MAAO,SQ5/BI4M,GACZ,GAAMtK,GAAKsK,EAAEhI,MACb7F,MAAK4P,kBAAkBrM,MR+/BtB0C,IAAK,oBACLhF,MAAO,SQ7/BQsC,GAAI,GAAA6E,GAAApI,KAChB6P,SAAuClO,QAE3C,QAAI4B,EAAGK,UAAUC,SAAS7D,KAAKuS,wBAE/B5Q,EAAS0E,EAAAvF,QAAMkD,uBAAuBhE,KAAK2K,QAAQnB,oBAAqBxJ,KAAK0N,qBAExE/L,IAAWA,EAAOqB,UAKnBO,EAAGK,UAAUC,SAAS7D,KAAKwS,oBAC7B3C,EAAexJ,EAAAvF,QAAMwC,wBAAwBC,EAAIvD,KAAK0N,wBAGpD/L,GACFwC,MAAMnC,UAAUoC,QAAQ7D,KAAKoB,EAAQ,SAACmR,GAChCA,IAAUjD,GACZiD,EAAMlP,UAAUqI,OAAO7D,EAAKqB,yBRwgCjCxD,IAAK,sBACLhF,MAAO,SQngCUsC,GAClB,IAAKA,EAAI,OAAO,CAKhB,KAHA,GAAIuM,GAAiBvM,EAAGwM,YACpBC,SAEGF,IAAmBE,GACpBF,GAA6C,MAA3BA,EAAerL,QACnCuL,EAA0BF,EAE1BA,EAAiBA,EAAeC,WAIpC,OAAOC,MRsgCN/J,IAAK,YACLhF,MAAO,SQpgCA4M,GACR,GAAMhI,GAASgI,EAAEhI,OACXkN,EAAuBlN,GAAUA,EAAOjC,WAAaiC,EAAOjC,UAAUC,SAAS7D,KAAKuS,qBAe1F,KAZKlR,aAAaoC,KAAKiN,QAAQsC,OAAOnC,QAAQhD,EAAEoC,QAAS,GACnD8C,GACFlF,EAAEG,kBAKD3M,aAAaoC,KAAKiN,QAAQC,UAAWtP,aAAaoC,KAAKiN,QAAQE,QAAQC,QAAQhD,EAAEoC,QAAS,IAAO8C,GACpG/S,KAAK8Q,YAAYjD,GAIH,KAAZA,EAAEoC,MAAc,CAElB,GAAMC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBAEzD,IAAIyG,EAAkB,CACpB,GAAIF,GAA0BhQ,KAAKoQ,oBAAoBF,EAEvD,KAAKF,EAAyB,CAE5B,GAAMK,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBmH,EAAiBI,sBAAsB,WAAYD,GAIrDL,EAA0BhQ,KAAKoQ,oBAAoBF,GAE/CF,IACGA,EAAwBjH,YAC3BiH,EAAwBjH,UAAY,QAEtC1B,OAAOsI,eAAeY,kBACtBvQ,KAAK2K,QAAQrI,UAAUsI,QAAQqC,cAAc+C,GAC7CE,EAAiBtM,UAAUqI,OAAOjM,KAAKyJ,iBACvCpI,aAAamP,UAAUC,eAAelJ,UAAU,GAChDsG,EAAEG,mBAMR,GAAgB,KAAZH,EAAEoC,MAAc,CAChB,GAAMC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBAEzD,IAAIyG,EAAkB,CAClB,GAAMG,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBmH,EAAiBI,sBAAsB,cAAeD,GACtDhJ,OAAOsI,eAAeY,kBACtBvQ,KAAK2K,QAAQrI,UAAUsI,QAAQqC,cAAcoD,GAC7CH,EAAiBtM,UAAUqI,OAAOjM,KAAKyJ,iBACvCoE,EAAEG,sBRygCT/H,IAAK,oBACLhF,MAAO,SQrgCQsC,GAEhBgG,WAAW,WACT,GAAMwH,GAAmB1J,OAAOsI,eAC1BqB,EAAQzJ,SAAS0J,aACvBD,GAAME,SAAS3N,EAAI,GACnBwN,EAAiBR,kBACjBQ,EAAiBI,SAASH,IACzB,QRwgCF/K,IAAK,cACLhF,MAAO,WQrgCRjB,KAAKuD,GAAKvD,KAAK2K,QAAQrI,UAAUqL,gBACjC3N,KAAKuD,GAAGK,UAAUqF,IAAIjJ,KAAKqS,kBAC3BrS,KAAKuD,GAAGK,UAAUqF,IAAIjJ,KAAKoS,sBAC3BpS,KAAKuD,GAAGsI,aAAa,mBAAoB7L,KAAK6G,QAAQkL,aAEtD/R,KAAKiT,oBAAsBjT,KAAKkT,YAAY/H,KAAKnL,MACjDA,KAAKmT,sBAAwBnT,KAAKoT,cAAcjI,KAAKnL,MAErDA,KAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKiT,qBACxCjT,KAAK2K,QAAQM,GAAG1D,SAAU,UAAWvH,KAAKmT,uBAG1CnT,KAAK2K,QAAQM,GAAGjL,KAAKuD,GAAI,OAAQvD,KAAKqT,WAAWlI,KAAKnL,OAEtDA,KAAKoR,kBAAkBpR,KAAKuD,ORygC3B0C,IAAK,gBACLhF,MAAO,SQvgCIkN,GACZ,MAAkB,MAAdA,EAAI8B,OAA8B,KAAd9B,EAAI8B,OAA8B,MAAd9B,EAAI8B,OAE/B,KAAd9B,EAAI8B,OAAgBjQ,KAAK2K,QAAQgD,kBAAoB3N,KAAKuD,KAG3DvD,KAAK6R,eACE,MR0gCR5L,IAAK,cACLhF,MAAO,SQtgCEkN,GACV,GAAMmF,GAAYnF,EAAIoF,cAAcC,QAAQ,QACtCC,EAAY,GAAIC,QAAO,kBAAqB,KAC5CC,EAAa,GAAID,QAAO,WAAa,IAE3C,IAAID,EAAUG,KAAKN,IAAcK,EAAWC,KAAKN,GAC/C,CAActT,KAAK6G,QAAQmL,YAAehS,KAAK6T,OAAOP,GAAW,GAAQtT,KAAK8T,SAASR,GAAW,GAGpGtT,KAAK6R,iBRygCJ5L,IAAK,cACLhF,MAAO,SQtgCE4M,GACV,GAAMqC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBACrDyG,IACFA,EAAiBjE,YRmhClBhG,IAAK,cACLhF,MAAO,WQxgCRjB,KAAK0G,QAAU,GAAA4H,GAAAxN,SACbwG,OAAQtH,KAAK2K,QACb3D,KAAM,SACNyC,gBAAiBzJ,KAAKyJ,gBACtBxC,UACEzF,KAAM,mBACN6J,OAAQ,aACR7H,UAAW,iBACXuI,MAAO,OACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAK+O,mBAAoB,mBAAoBZ,IAC7DhD,KAAKnL,QAERwB,KAAM,qBACN6J,OAAQ,eACR7H,UAAW,mBACXuI,MAAO,SACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAKgP,qBAAsB,qBAAsBb,IACjEhD,KAAKnL,QAERwB,KAAM,0BACN6J,OAAQ,oBACR7H,UAAW,wBACXuI,MAAO,OACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAK0S,yBAA0B,0BAA2BvE,IAC1EhD,KAAKnL,QAERwB,KAAM,0BACN6J,OAAQ,oBACR7H,UAAW,wBACXuI,MAAO,OACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAK2S,yBAA0B,0BAA2BxE,IAC1EhD,KAAKnL,QAERwB,KAAM,oBACN6J,OAAQ,cACR7H,UAAW,kBACXuI,MAAO,QACPqC,QAAU,SAASD,GACjBnO,KAAKsR,YAAYtR,KAAKyS,oBAAqB,oBAAqBtE,IAC/DhD,KAAKnL,UAIZA,KAAK4K,QAAQnE,WAAWlC,KAAKvE,KAAK0G,YR4gCjCT,IAAK,cACLhF,MAAO,SQ1gCEuC,EAAW6H,EAAQ8C,GACzBA,IACFA,EAAIH,iBACJG,EAAIsB,kBAEN,IAAMlM,GAAKvD,KAAK6S,kBAChBtP,GAAGK,UAAUqI,OACXjM,KAAK+O,mBACL/O,KAAKyS,oBACLzS,KAAKgP,qBACLhP,KAAK0S,yBACL1S,KAAK2S,0BAEPpP,EAAGK,UAAUqF,IAAIzF,GAEjBxD,KAAK0G,QAAQ6K,qBAETvR,KAAK6G,QAAQ2K,UACfxR,KAAK6G,QAAQ2K,SAASnG,MRihCvBpF,IAAK,SACLhF,MAAO,SQrgCH8S,EAAKC,GAAQ,GAAA5K,GAAApJ,KAEZiU,EAASjU,KAAK6G,QAAQmL,YAAc,QAAU+B,EAC9CG,EAAM,GAAIC,eAahB,OAVAD,GAAIE,KAAK,MAAOH,GAAQ,GACxBC,EAAIG,mBAAqB,WACvB,GAAuB,IAAnBH,EAAII,YAAmC,MAAfJ,EAAIK,OAAgB,CAC9C,GAAMC,GAAOC,KAAKC,MAAMR,EAAIS,aAC5BvL,GAAK0J,MAAM0B,EAAK5I,KAAMmI,EAAKS,KAI/BN,EAAIU,QAEG,KRkhCN3O,IAAK,WACLhF,MAAO,SQxgCD8S,EAAKC,GACZ,GAAIpI,SAEJ,SAAM,GAAI8H,SAAQ,UAAW,WAAY,QAAS,YAAa,UAAW,YAAYmB,KAAK,MAAMjB,KAAKG,KAKtGnI,EAAOmI,EAAIe,QAAQ,OAAQ,IACxBA,QAAQ,+FAAgG,sJACxGA,QAAQ,2CAA4C,8LACpDA,QAAQ,oDAAqD,4MAC7DA,QAAQ,yCAA0C,0NAClDA,QAAQ,0CAA2C,uKAEjD,8BAA+BlB,KAAKhI,MAAU,IAM/CoI,EACKhU,KAAK8S,MAAMlH,EAAMmI,GAEjB/T,KAAK8S,MAAMlH,QRsgCnB3F,IAAK,QAWLhF,MAAO,SQpgCJ2K,EAAM0H,EAAWyB,GACrB,GAAIxR,UAAIyR,SAAQC,SAAsBC,SAAaC,SAAevL,SAAWwL,SAASC,SAAQhF,QAE9F,KAAKzE,EAEH,MADAF,SAAQC,MAAM,mCAAoC2H,IAC3C,CAGT,IAAIyB,GAAsB,SAAdA,EAAK/N,KAEf,MADA0E,SAAQC,MAAM,+CAAgD2H,IACvD,CAiDT,KA9CA/P,EAAKvD,KAAK2K,QAAQrI,UAAUqL,gBAC5BqH,EAASzN,SAASE,cAAc,UAChCuN,EAAOpR,UAAUqF,IAAI,oCAErBgM,EAAuB1N,SAASE,cAAc,OAC9CwN,EAAqBrR,UAAUqF,IAAIjJ,KAAKsS,+BAExC4C,EAAc3N,SAASE,cAAc,cACrCyN,EAAYtR,UAAUqF,IAAIjJ,KAAKuS,sBAC/B2C,EAAYrJ,aAAa,mBAAmB,GAC5CqJ,EAAYrJ,aAAa,mBAAoB,qCAE7CsJ,EAAgB5N,SAASE,cAAc,OACvC0N,EAAcvR,UAAUqF,IAAIjJ,KAAK0N,kBACjCyH,EAAcvR,UAAUqF,IAAIjJ,KAAKgP,sBACjCqB,EAAY9I,SAASE,cAAc,KACnC4I,EAAUtH,UAAY,OAItBoM,EAActJ,aAAa,mBAAmB,GAE9CjC,EAAYrC,SAASE,cAAc,OACnCmC,EAAUhG,UAAUqF,IAAI,8CAExBmM,EAAU7N,SAASE,cAAc,OACjC2N,EAAQxR,UAAUqF,IAAIjJ,KAAKwS,kBAE3B2C,EAActN,YAAYmN,GAC1BA,EAAOnN,YAAY+B,GACnBoL,EAAOnN,YAAYuN,GAEnBH,EAAqBrR,UAAUqF,IAAIjJ,KAAKsS,+BACxC4C,EAAYI,iBAAkB,EAC9BJ,EAAYtR,UAAUqF,IAAIjJ,KAAKuS,sBAC/B2C,EAAYK,QAAQxD,YAAc/R,KAAKiP,uBAEvC1L,EAAGoO,YAAYwD,GAEV5R,EAAGwM,aACNxM,EAAG+M,sBAAsB,WAAYD,GAIvCgF,EAASF,EAAczF,WAAW8F,UAE3BH,GAA8B,IAApBA,EAAOI,UACtBJ,EAASA,EAAOK,eAGlB,IAAIL,IAAWF,EAAe,CAC5B,GAAMQ,GAAQpO,SAASE,cAAc,IACrCkO,GAAM9N,YAAYN,SAASE,cAAc,OACzC0N,EAAczF,WAAW7H,YAAY8N,GAwBvC,MArBA/L,GAAUb,UAAY6C,EAEtB5L,KAAK4K,QAAQqC,cAAckI,GAKvBvJ,EAAKiF,QAAQ,eAAgB,GACZ,mBAAR+E,KACTrM,WAAW,WACTqM,GAAGC,MAAMnB,SACR,KAIP1U,KAAK6G,QAAQ+K,UAAY5R,KAAK6G,QAAQ+K,SAAShG,GAE/CrC,WAAW,WACT6L,EAAQU,SACP,MAEI,KR+gCN7P,IAAK,aACLhF,MAAO,WQ5gCRyK,QAAQyG,IAAI,WRihCXlM,IAAK,kBACLhF,MAAO,WQ7gCRjB,KAAKuD,GAAGwS,gBAAgB,oBACxB/V,KAAKuD,GAAGK,UAAUqI,OAAO,8CRihCxBhG,IAAK,cACLhF,MAAO,WQ9gCRjB,KAAKgW,kBACLhW,KAAKuD,GAAGK,UAAUqI,OAAOjM,KAAKyJ,iBAC9BzJ,KAAKuD,GAAGK,UAAUqI,OAAOjM,KAAKqS,kBAE9BrS,KAAK2K,QAAQsL,IAAI1O,SAAU,QAASvH,KAAKiT,qBACzCjT,KAAK2K,QAAQsL,IAAI1O,SAAU,QAASvH,KAAKkW,wBRkhCxCjQ,IAAK,UACLhF,MAAO,WQ/gCRjB,KAAK6R,kBRohCCC,IAGTlS,GAAQkB,QQ9iDYgR,ER+iDpBjS,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhBhH9D,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MS9jDjiBwB,EAAAlG,EAAA,GTkkDKmG,EAAU1F,EAAuByF,GSjkDtCiI,EAAAnO,EAAA,GTqkDKoO,EAAY3N,EAAuB0N,GSnkDnB8H,ETykDP,WSvkDZ,QAAAA,GAAY7O,EAAQT,GAASnC,EAAA1E,KAAAmW,GAC3BnW,KAAK6G,SACHkF,MAAO,qCACPqK,SAAS,EACTC,UAAW,aACXC,UAAW,aACXC,aAAc,SACdC,cACAhF,SAAU,SAACnG,GACTK,QAAQyG,IAAI,iBAAkB9G,KAIlCtK,OAAOqG,OAAOpH,KAAK6G,QAASA,GAE5B7G,KAAK2K,QAAUrD,EACftH,KAAK4K,QAAU5K,KAAK2K,QAAQnD,KAC5BxH,KAAK0N,iBAAmB,8BACxB1N,KAAKqS,iBAAmB,sCACxBrS,KAAKyJ,gBAAkB,oCACvBzJ,KAAKsS,8BAAgC,kDACrCtS,KAAKuS,qBAAuB,wCAE5BvS,KAAK+O,mBAAqB,aAC1B/O,KAAKyS,oBAAsB,cAC3BzS,KAAKgP,qBAAuB,eAC5BhP,KAAK0S,yBAA2B,oBAChC1S,KAAK2S,yBAA2B,oBAGhC3S,KAAK+L,MAAQ/L,KAAK6G,QAAQkF,MAC1B/L,KAAKiP,uBAAyBjP,KAAK6G,QAAQoI,uBAC3CjP,KAAKyW,mBAAqB,KAC1BzW,KAAK0W,iBAAkB,EACvB1W,KAAKkP,cACLlP,KAAK+K,STulEN,MA3gBApF,GAAawQ,IACXlQ,IAAK,SACLhF,MAAO,WS3kDD,GAAA6F,GAAA9G,IACPA,MAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAK2W,cAAcxL,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAG1D,SAAU,UAAWvH,KAAKoP,UAAUjE,KAAKnL,OAEzDA,KAAK2K,QAAQnB,oBAAoBpF,QAAQ,SAACC,GACxCyC,EAAK6D,QAAQM,GAAG5G,EAAQ,QAASyC,EAAK8P,YAAYzL,KAAjBrE,STilDlCb,IAAK,cACLhF,MAAO,WS9kDI,GAAAmH,GAAApI,IACZ,IAAIA,KAAK6G,QAAQgQ,oBAAqB,CACpC,GAAMC,GAAMzQ,EAAAvF,QAAMiC,sBAClB/C,MAAK6G,QAAQgQ,oBACX,SAACE,GAAD,MAAc3O,GAAK4O,YAAYD,EAAUD,GAAK,IAC9C,SAACC,GAAD,MAAc3O,GAAK4O,YAAYD,EAAUD,GAAK,SAGhD9W,MAAKiX,OAAS1P,SAASE,cAAc,SACrCzH,KAAKiX,OAAOjQ,KAAO,OACnBhH,KAAKiX,OAAOC,UAAW,EACvBlX,KAAK2K,QAAQM,GAAGjL,KAAKiX,OAAQ,SAAUjX,KAAKmX,YAAYhM,KAAKnL,OAC7DA,KAAKiX,OAAOnB,WTqlDb7P,IAAK,cACLhF,MAAO,WSjlDRjB,KAAK0G,QAAU,GAAA4H,GAAAxN,SACbwG,OAAQtH,KAAK2K,QACb3D,KAAM,SACNyC,gBAAiBzJ,KAAKyJ,gBACtBxC,UACEzF,KAAM,mBACN6J,OAAQ,aACR7H,UAAW,iBACXuI,MAAO,OACPqL,MAAO,OACPhJ,QAAU,SAASD,GACjBnO,KAAKsR,YAAY,aAAc,mBAAoBnD,IAClDhD,KAAKnL,QAERwB,KAAM,qBACN6J,OAAQ,eACR7H,UAAW,mBACXuI,MAAO,SACPqL,MAAO,SACPhJ,QAAU,SAASD,GACjBnO,KAAKsR,YAAY,eAAgB,qBAAsBnD,IACtDhD,KAAKnL,QAERwB,KAAM,0BACN6J,OAAQ,oBACR7H,UAAW,wBACXuI,MAAO,OACPqL,MAAO,OACPhJ,QAAU,SAASD,GACjBnO,KAAKsR,YAAY,oBAAqB,0BAA2BnD,IAChEhD,KAAKnL,QAERwB,KAAM,0BACN6J,OAAQ,oBACR7H,UAAW,wBACXuI,MAAO,OACPqL,MAAO,YACPhJ,QAAU,SAASD,GACjBnO,KAAKsR,YAAY,oBAAqB,0BAA2BnD,IAChEhD,KAAKnL,QAERwB,KAAM,oBACN6J,OAAQ,cACR7H,UAAW,kBACXuI,MAAO,QACPqL,MAAO,QACPhJ,QAAU,SAASD,GACjBnO,KAAKsR,YAAY,cAAe,oBAAqBnD,IACpDhD,KAAKnL,UAIZA,KAAK4K,QAAQnE,WAAWlC,KAAKvE,KAAK0G,YTqlDjCT,IAAK,cACLhF,MAAO,SSnlDEuC,EAAW6H,EAAQ8C,GACzBA,IACFA,EAAIH,iBACJG,EAAIsB,kBAEN,IAAMlM,GAAKvD,KAAKyW,kBAChBlT,GAAGK,UAAUqI,OACXjM,KAAK+O,mBACL/O,KAAKyS,oBACLzS,KAAKgP,qBACLhP,KAAK0S,yBACL1S,KAAK2S,0BAGPpP,EAAGK,UAAUqF,IAAIzF,GACjBxD,KAAK0G,QAAQ6K,qBAETvR,KAAK6G,QAAQ2K,UACfxR,KAAK6G,QAAQ2K,SAASnG,MTilDvBpF,IAAK,cACLhF,MAAO,WS9kDI,GAAAmI,GAAApJ,IACZmE,OAAMnC,UAAUoC,QAAQ7D,KAAKP,KAAKiX,OAAOI,MAAO,SAACC,GAG/C,GAAMR,GAAMzQ,EAAAvF,QAAMiC,sBAEdqG,GAAKvC,QAAQuP,SACfhN,EAAKgN,QAAQkB,EAAMR,GAGrB1N,EAAKmO,OAAOD,EAAMR,QTolDnB7Q,IAAK,UACLhF,MAAO,SSjlDFqW,EAAMR,GAAK,GAAAU,GAAAxX,KACXyX,EAAS,GAAIC,WAEnBD,GAAOE,OAAS,SAAC9J,GACf2J,EAAKR,YAAYnJ,EAAEhI,OAAO+R,OAAQd,IAGpCW,EAAOI,cAAcP,MTslDpBrR,IAAK,SACLhF,MAAO,SSplDHqW,EAAMR,GACX,GAAM5C,GAAM,GAAIC,gBACdK,EAAO,GAAIsD,UACPd,EAAchX,KAAKgX,YAAY7L,KAAKnL,KAE1CkU,GAAIE,KAAK,OAAQpU,KAAK6G,QAAQwP,WAAW,GACzCnC,EAAIG,mBAAqB,WACA,IAAnBH,EAAII,YAAmC,MAAfJ,EAAIK,QAC9ByC,EAAY9C,EAAIS,aAActO,EAAAvF,QAAMiC,yBAIxCyR,EAAKuD,OAAO,OAAQT,GACpBpD,EAAIU,KAAKJ,MTulDRvO,IAAK,cACLhF,MAAO,SSrlDE8V,EAAUD,EAAKkB,GACzB,GAAM3H,GAAYrQ,KAAK2K,QAAQrI,UAAUqL,eAIzC,IAAyC,MAArC0C,EAAU4H,SAASC,cAAuB,CAC5C,GAAMC,GAAM5Q,SAASE,cAAc,MAEnC4I,GAAUX,WAAW0I,aAAaD,EAAK9H,GACvCrQ,KAAK2K,QAAQrI,UAAU2K,cAAckL,GACrC9H,EAAUpE,SAOZ,MAFAjM,MAAK2K,QAAQrI,UAAU6K,cAEhBnN,KAAKqY,SAAStB,EAAUD,EAAKkB,MTwlDnC/R,IAAK,eACLhF,MAAO,SStlDGsC,GACX,GAAM8M,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBxF,EAAG+M,sBAAsB,WAAYD,MTylDpCpK,IAAK,WACLhF,MAAO,SSvlDD8S,EAAK+C,EAAKkB,GAAU,GAAAM,GAAAtY,IAC3B,OAAO,IAAIuY,SAAQ,SAACC,EAASC,GAC3B,GAAMlV,GAAK+U,EAAK3N,QAAQrI,UAAUqL,gBAChCqH,EAASzN,SAASE,cAAc,UAChCiR,EAAMnR,SAASE,cAAc,OAC7BwN,EAAuB1N,SAASE,cAAc,OAC9CyN,EAAc3N,SAASE,cAAc,cACnCkR;AAEJD,EAAIE,IAAM,GAEN9B,GACF4B,EAAI7M,aAAa,WAAYiL,GAG/B7B,EAAqBrR,UAAUqF,IAAIqP,EAAKhG,+BACxC4C,EAAYI,iBAAkB,EAC9BJ,EAAYtR,UAAUqF,IAAIqP,EAAK/F,sBAC/B2C,EAAYK,QAAQxD,YAAcuG,EAAKrJ,uBAInC8E,EAAI8E,MAAM,WACPb,IACHzU,EAAGwF,UAAY,GACfxF,EAAGK,UAAUqI,OAAOqM,EAAKjG,kBACzBiG,EAAK5B,iBAAkB,GAGzBgC,EAAII,IAAM/E,EACViB,EAAOnN,YAAY6Q,GACnBnV,EAAGsE,YAAYmN,KAIf2D,EAAW,GAAII,OACfJ,EAAShB,OAAS,WAChBe,EAAII,IAAMH,EAASG,IACdd,GACHU,EAAI9U,UAAUqF,IAAIqP,EAAK7O,iBAEzBuL,EAAOnN,YAAY6Q,GACnBzD,EAAqBpN,YAAYqN,GACjCF,EAAOnN,YAAYoN,GAEd+C,IACHzU,EAAGwF,UAAY,GACfxF,EAAGK,UAAUqI,OAAOqM,EAAKjG,kBACzBiG,EAAK5B,iBAAkB,GAIrBsB,IACFM,EAAK5B,iBAAkB,EACvBnT,EAAGK,UAAUqF,IAAIqP,EAAKjG,mBAGxB9O,EAAGsE,YAAYmN,GAETzR,EAAGwM,aAAgBxM,EAAGwM,YAAYA,aAAiBiI,GACvDM,EAAKU,aAAazV,GAIpBiV,EAAQG,IAGVA,EAASG,IAAM/E,GAGjBxQ,EAAGK,UAAUqF,IAAIqP,EAAK5K,kBACtBnK,EAAGK,UAAUqF,IAAIqP,EAAKtJ,sBAEtBzL,EAAG+R,iBAAkB,OT0lDtBrP,IAAK,eACLhF,MAAO,SStlDGgY,EAAOlF,GAClB,GAAM4E,GAAW,GAAII,OACfxV,EAAKvD,KAAK2K,QAAQrI,UAAUqL,eAclC,OAZKpK,GAAGwM,aAAgBxM,EAAGwM,YAAYA,aACrC/P,KAAKgZ,aAAazV,GAGpBoV,EAAShB,OAAS,WAChBsB,EAAMH,IAAMH,EAASG,IACrBG,EAAMlD,gBAAgB,aAGxB4C,EAASG,IAAM/E,EAGR4E,KTylDN1S,IAAK,cACLhF,MAAO,SSvlDE4M,GACV,GAAMtK,GAAKsK,EAAEhI,MACb7F,MAAKkZ,gBAAgB3V,MT0lDpB0C,IAAK,kBACLhF,MAAO,SSxlDMsC,GACd,GAAkC,QAA9BA,EAAG0U,SAASC,eAA2B7R,EAAAvF,QAAMwC,wBAAwBC,EAAIvD,KAAK0N,kBAAmB,CACnG,GAAMgC,GAAanM,EAAGmM,WAAWA,UAE5BA,GAAW9L,UAAUC,SAAS7D,KAAKqS,oBACtC9O,EAAGK,UAAUqF,IAAIjJ,KAAKyJ,iBAGtBzJ,KAAK4K,QAAQqC,cAAcyC,GAC3B1P,KAAKyW,mBAAqB/G,OT6lD7BzJ,IAAK,gBACLhF,MAAO,SSxlDI4M,GAAG,GAAAsL,GAAAnZ,KACTuD,EAAKsK,EAAEhI,OACTuT,SAAc1X,QAElB,QAAI6B,EAAGK,UAAUC,SAAS7D,KAAKuS,wBAGG,QAA9BhP,EAAG0U,SAASC,eAA2B3U,EAAGK,UAAUC,SAAS7D,KAAKyJ,mBACpE2P,EAAe7V,GAGjB7B,EAAS2E,EAAAvF,QAAMkD,uBAAuBhE,KAAK2K,QAAQnB,oBAAqBxJ,KAAKyJ,iBAC7EtF,MAAMnC,UAAUoC,QAAQ7D,KAAKmB,EAAQ,SAACuX,GAChCA,IAAUG,GACZH,EAAMrV,UAAUqI,OAAOkN,EAAK1P,wBAGhCzJ,KAAKqZ,YAAc,UT8lDlBpT,IAAK,sBACLhF,MAAO,SS5lDUsC,GAClB,IAAKA,EAAI,OAAO,CAKhB,KAHA,GAAIuM,GAAiBvM,EAAGwM,YACpBC,SAEGF,IAAmBE,GACpBF,GAA6C,MAA3BA,EAAerL,QACnCuL,EAA0BF,EAE1BA,EAAiBA,EAAeC,WAIpC,OAAOC,MT+lDN/J,IAAK,YACLhF,MAAO,SS7lDA4M,GACR,GAAMhI,GAASgI,EAAEhI,OACXkN,EAAuBlN,GAAUA,EAAOjC,WAAaiC,EAAOjC,UAAUC,SAAS7D,KAAKuS,qBAG1F,KAAKlR,aAAaoC,KAAKiN,QAAQsC,OAAOnC,QAAQhD,EAAEoC,QAAS,GACnD8C,EAAsB,CAIzB,GAFAlF,EAAEG,iBAEE3G,OAAOsI,aAAc,CACvB,GAAMa,GAAYnJ,OAAOsI,eACnBqB,EAAQR,EAAU8I,WAAW,GAC7BC,EAAKhS,SAASE,cAAc,MAC5B+R,EAAWjS,SAASkS,eAAe,IACzCzI,GAAM0I,iBACN1I,EAAM2I,WAAWJ,GACjBvI,EAAM4I,UAAS,GACf5I,EAAM2I,WAAWH,GACjBxI,EAAM6I,mBAAmBL,GAEzBhJ,EAAUD,kBACVC,EAAUW,SAASH,GAEpB,OAAO,EAUX,IALK3P,aAAaoC,KAAKiN,QAAQC,UAAWtP,aAAaoC,KAAKiN,QAAQE,QAAQC,QAAQhD,EAAEoC,QAAS,IAAO8C,GACpG/S,KAAK8Z,YAAYjM,GAIH,KAAZA,EAAEoC,MAAc,CAElB,GAAM8J,GAAmBxS,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,iBACnDuQ,EAAyBD,GAAoBA,EAAiBrK,WAAWA,UAC/E,IAAIsK,EAAwB,CAC1B,GAAIhK,GAA0BhQ,KAAKoQ,oBAAoB4J,EAElDhK,IAEHhQ,KAAKgZ,aAAagB,GAIpBhK,EAA0BhQ,KAAKoQ,oBAAoB4J,GAE/ChK,IACGA,EAAwBjH,YAC3BiH,EAAwBjH,UAAY,QAEtC1B,OAAOsI,eAAeY,kBACtBvQ,KAAK2K,QAAQrI,UAAUsI,QAAQqC,cAAc+C,GAC7C3O,aAAamP,UAAUC,eAAelJ,UAAU,GAChDwS,EAAiBnW,UAAUqI,OAAOjM,KAAKyJ,iBACvCoE,EAAEG,mBAMR,GAAgB,KAAZH,EAAEoC,MAAc,CAChB,GAAM8J,GAAmBxS,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,iBACnDuQ,EAAyBD,GAAoBA,EAAiBrK,WAAWA,UAC/E,IAAIsK,EAAwB,CACxB,GAAM3J,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBiR,EAAuB1J,sBAAsB,cAAeD,GAE5DhJ,OAAOsI,eAAeY,kBACtBvQ,KAAK2K,QAAQrI,UAAUsI,QAAQqC,cAAcoD,GAC7C0J,EAAiBnW,UAAUqI,OAAOjM,KAAKyJ,iBACvCoE,EAAEG,sBTkmDT/H,IAAK,cACLhF,MAAO,SS9lDE4M,GAAG,GAAAoM,GAAAja,KACP0B,EAAS2E,EAAAvF,QAAMkD,uBAAuBhE,KAAK2K,QAAQnB,oBAAqBxJ,KAAKyJ,iBACjF+G,EAAYnJ,OAAOsI,eACjBuK,QAGJ,IAAI1J,GAAaA,EAAU2J,WAAY,CACrC,GAAMnJ,GAAQ3P,aAAamP,UAAU4J,kBAAkB7S,UACrD8S,EAAiBhZ,aAAamP,UAAUjE,yBAAyByE,GACjEsJ,EAAgBjZ,aAAamP,UAAU+J,gBAAgBF,GAAgBzN,KACrE4N,QAEJ,IAAI3M,EAAEoC,QAAU5O,aAAaoC,KAAKiN,QAAQC,WAA+B,IAAlB2J,EAAqB,CAC1E,GAAiC,SAA7BD,EAAetR,UAEf,OAAO,CAEXyR,GAAUH,EAAeI,2BAEhB5M,GAAEoC,QAAU5O,aAAaoC,KAAKiN,QAAQE,QAAU0J,IAAkBD,EAAe9M,UAAUvK,SACpGwX,EAAUH,EAAeK,mBAG3B,IAAIF,GAAWA,EAAQ5W,UAAUC,SAAS,+BAAgC,CACxE,GAAM8W,GAAYH,EAAQhW,qBAAqB,MAC/CL,OAAMnC,UAAUoC,QAAQ7D,KAAKoa,EAAW,SAAC1B,GACvCvX,EAAO6C,KAAK0U,KAMhB,GADAiB,EAAe7Y,aAAamP,UAAUoK,iBAAiBrT,UACrC,CAChB,GAAMsT,GAAOtT,SAASE,cAAc,OAChCqT,SAAUH,QACdE,GAAK9R,UAAYmR,EAEjBY,EAAWD,EAAK7W,uBAAuB,+BACvC2W,EAAYtU,EAAAvF,QAAM0D,qBAAqBsW,EAAU,OAEjD3W,MAAMnC,UAAUoC,QAAQ7D,KAAKoa,EAAW,SAAC1B,GACvCvX,EAAO6C,KAAK0U,MAKdvX,EAAOsB,SACJkX,GACHrM,EAAEG,iBAGJtM,EAAO0C,QAAQ,SAAC6U,GACd,GAAM8B,GAAU1U,EAAAvF,QAAMwC,wBAAwB2V,EAAO,8BAMrD,IALAgB,EAAKe,WAAW/B,EAAMH,KAEtBG,EAAMvJ,WAAWzD,SAGiB,IAA9B8O,EAAQE,kBAAyB,CACnC,GAAMC,GAAOH,EAAQL,mBACnBS,EAAOJ,EAAQN,sBAEjBM,GAAQ9O,SAIHiO,IACCgB,GAAQC,KACLD,GAAQrN,EAAEoC,QAAU5O,aAAaoC,KAAKiN,QAAQE,SAAYuK,EAC7D9Z,aAAamP,UAAU4K,WAAW7T,SAAU2T,EAAM,GAElD7Z,aAAamP,UAAU4K,WAAW7T,SAAU4T,EAAK3F,UAAW2F,EAAK3F,UAAU6F,YAAYrY,gBT0mDlGiD,IAAK,aACLhF,MAAO,SSlmDCgY,GACT,GAAIjZ,KAAK6G,QAAQyP,UAAW,CAC1B,GAAMpC,GAAM,GAAIC,gBACdK,EAAOzT,OAAOqG,WACZkQ,KAAM2B,GACLjZ,KAAK6G,QAAQ2P,WAElBtC,GAAIE,KAAKpU,KAAK6G,QAAQ0P,aAAcvW,KAAK6G,QAAQyP,WAAW,GAC5DpC,EAAIU,KAAKJ,OTsmDVvO,IAAK,UACLhF,MAAO,gBAGFkV,IAGTvW,GAAQkB,QS/nEYqV,ETgoEpBtW,EAAOD,QAAUA,EAAiB,SAI7B,SAAUC,EAAQD,EAASM,GAEhC,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAEvF,QAAS8D,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhBhH9D,OAAOC,eAAepB,EAAS,cAC7BqB,OAAO,GAGT,IAAI0E,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAM9C,OAAQ+C,IAAK,CAAE,GAAIC,GAAaF,EAAMC,EAAIC,GAAWV,WAAaU,EAAWV,aAAc,EAAOU,EAAWR,cAAe,EAAU,SAAWQ,KAAYA,EAAWT,UAAW,GAAMxE,OAAOC,eAAe6E,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAUpB,EAAasB,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBhB,EAAY5C,UAAWkE,GAAiBC,GAAaP,EAAiBhB,EAAauB,GAAqBvB,MU/oEjiBwB,EAAAlG,EAAA,GVmpEKmG,EAAU1F,EAAuByF,GUlpEtCiI,EAAAnO,EAAA,GAEqBob,GVopEJ3a,EAAuB0N,GAMzB,WUxpEb,QAAAiN,GAAYhU,EAAQT,GAASnC,EAAA1E,KAAAsb,GAC3Btb,KAAK6G,SACHkF,MAAO,uCACPyC,UAAU,EACVC,WAAW,EACXC,QACE9B,MACEb,MAAO,0CAET4C,MACE5C,MAAO,8CAGX6C,SACE3C,QACEF,MAAO,oCACP8C,QAAS,eAQbC,cAAc,GAGhB/N,OAAOqG,OAAOpH,KAAK6G,QAASA,GAE5B7G,KAAK2K,QAAUrD,EACftH,KAAK4K,QAAU5K,KAAK2K,QAAQnD,KAE5BxH,KAAKyJ,gBAAkB,4CACvBzJ,KAAK0N,iBAAmB,qCAExB1N,KAAK+O,mBAAqB,aAC1B/O,KAAKgP,qBAAuB,oBAE5BhP,KAAK+L,MAAQ/L,KAAK6G,QAAQkF,MAC1B/L,KAAKiP,uBAAyBjP,KAAK6G,QAAQoI,uBAE3CjP,KAAK+K,SV42EN,MA9MApF,GAAa2V,IACXrV,IAAK,SACLhF,MAAO,WU5pED,GAAA6F,GAAA9G,IACPA,MAAK2K,QAAQM,GAAG1D,SAAU,QAASvH,KAAKmP,cAAchE,KAAKnL,OAC3DA,KAAK2K,QAAQM,GAAG1D,SAAU,UAAWvH,KAAKoP,UAAUjE,KAAKnL,OAEzDA,KAAK2K,QAAQnB,oBAAoBpF,QAAQ,SAACC,GACxCyC,EAAK6D,QAAQM,GAAG5G,EAAQ,QAASyC,EAAKuI,YAAYlE,KAAjBrE,SVkqElCb,IAAK,cACLhF,MAAO,SU/pEE4M,GACV,GAAMtK,GAAKsK,EAAEhI,MACT7F,MAAKsP,6BAA6B/L,EAAIvD,KAAK0N,oBAC7C1N,KAAKuP,gBAAgBhM,EAAIiM,OACzB3B,GAAKA,EAAE4B,kBACP5B,GAAKA,EAAEG,qBVmqER/H,IAAK,+BACLhF,MAAO,SUhqEmBsC,EAAIC,GAC/B,KAAOD,GAAI,CACT,GAAIA,EAAGK,WAAaL,EAAGK,UAAUC,SAASL,GAAY,MAAOD,EAC7DA,GAAKA,EAAGmM,eVoqETzJ,IAAK,kBACLhF,MAAO,SUhqEMsC,GACd,GAAMI,GAAU3D,KAAKsP,6BAA6B/L,EAAIvD,KAAK0N,iBAC3D/J,GAAQC,UAAUqF,IAAIjJ,KAAKyJ,gBACFpC,QAAOsI,kBVmqE/B1J,IAAK,gBACLhF,MAAO,SUjqEI4M,GACZ,GAAMtK,GAAKsK,EAAEhI,MACb7F,MAAK4P,kBAAkBrM,MVoqEtB0C,IAAK,oBACLhF,MAAO,SUlqEQsC,GAAI,GAAA6E,GAAApI,KAChB6P,SAAuChO,QAG3C,OADAA,GAAUwE,EAAAvF,QAAMkD,uBAAuBhE,KAAK2K,QAAQnB,oBAAqBxJ,KAAK0N,qBACzE7L,IAAYA,EAAQmB,cAIrBnB,GACFsC,MAAMnC,UAAUoC,QAAQ7D,KAAKsB,EAAS,SAACA,GACjCA,IAAYgO,GACdhO,EAAQ+B,UAAUqI,OAAO7D,EAAKqB,uBV6qEnCxD,IAAK,sBACLhF,MAAO,SUxqEUsC,GAClB,IAAKA,EAAI,OAAO,CAKhB,KAHA,GAAIuM,GAAiBvM,EAAGwM,YACpBC,SAEGF,IAAmBE,GACpBF,GAA6C,MAA3BA,EAAerL,QACnCuL,EAA0BF,EAE1BA,EAAiBA,EAAeC,WAIpC,OAAOC,MV2qEN/J,IAAK,YACLhF,MAAO,SUzqEA4M,GACOA,EAAEhI,QAGZxE,aAAaoC,KAAKiN,QAAQC,UAAWtP,aAAaoC,KAAKiN,QAAQE,QAAQC,QAAQhD,EAAEoC,QAAS,EAC7FjQ,KAAK8Q,YAAYjD,GACRtG,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,kBAEzCoE,EAAEG,oBV6qEH/H,IAAK,oBACLhF,MAAO,SU1qEQsC,GAEhBgG,WAAW,WACT,GAAMwH,GAAmB1J,OAAOsI,eAC1BqB,EAAQzJ,SAAS0J,aACvBD,GAAME,SAAS3N,EAAI,GACnBwN,EAAiBR,kBACjBQ,EAAiBI,SAASH,IACzB,QV6qEF/K,IAAK,cACLhF,MAAO,WU1qERjB,KAAKuD,GAAKvD,KAAK2K,QAAQrI,UAAUqL,gBACjC3N,KAAKoR,kBAAkBpR,KAAKuD,IAC5BvD,KAAKub,aAAavb,KAAKuD,OV8qEtB0C,IAAK,cACLhF,MAAO,SU5qEE4M,GACV,GAAMqC,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBACrDyG,KACFA,EAAiBjE,SACjB4B,EAAEG,iBACFH,EAAE4B,sBVyrEHxJ,IAAK,cACLhF,MAAO,eAEPgF,IAAK,cACLhF,MAAO,SU/qEEuC,EAAW6H,EAAQ8C,GACzBA,IACFA,EAAIH,iBACJG,EAAIsB,kBAGN,IAAMlM,GAAKgE,SAAS4I,cAAT,IAA2BnQ,KAAKyJ,gBAC3ClG,GAAGK,UAAUqI,OACXjM,KAAK+O,mBACL/O,KAAKgP,sBAEPzL,EAAGK,UAAUqF,IAAIzF,GAEjBxD,KAAK0G,QAAQ6K,qBAETvR,KAAK6G,QAAQ2K,UACfxR,KAAK6G,QAAQ2K,SAASnG,MVyrEvBpF,IAAK,eACLhF,MAAO,SU7qEGsC,GAEX,GAAMiY,GAAiBjU,SAAS4I,cAAT,IAA2BnQ,KAAK0N,iBACnD8N,IACFA,EAAevP,QAIjB,IAAMpK,GAAU0F,SAASE,cAAc,MACvC5F,GAAQgK,aAAa,mBAAmB,GACxChK,EAAQkH,UAAY,cACpBlH,EAAQ+B,UAAUqF,IAAIjJ,KAAK0N,kBAE3BnK,EAAGoO,YAAY9P,EAEf,IAAMqO,GAAmB3I,SAAS4I,cAAT,IAA2BnQ,KAAK0N,iBAEzD,IAAIwC,EAAkB,CACpB,GAAIF,GAA0BhQ,KAAKoQ,oBAAoBF,EAEvD,KAAKF,EAAyB,CAE5B,GAAMK,GAAY9I,SAASE,cAAc,IACzC4I,GAAUtH,UAAY,OACtBmH,EAAiBI,sBAAsB,WAAYD,IAMvD,MAFArQ,MAAK6G,QAAQ+K,UAAY5R,KAAK6G,QAAQ+K,YAE/B,KVgrEN3L,IAAK,UACLhF,MAAO,WU5qERjB,KAAK6R,kBVirECyJ,KAGT1b,GAAQkB,QU15EYwa,EV25EpBzb,EAAOD,QAAUA,EAAiB","file":"medium-editor-insert.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MediumEditorInsert\"] = factory();\n\telse\n\t\troot[\"MediumEditorInsert\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MediumEditorInsert\"] = factory();\n\telse\n\t\troot[\"MediumEditorInsert\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _Core = __webpack_require__(3);\n\t\n\tvar _Core2 = _interopRequireDefault(_Core);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar MediumEditorInsert = MediumEditor.Extension.extend({\n\t  name: 'insert',\n\t\n\t  addons: {\n\t    images: true,\n\t    embeds: true,\n\t    chapters: true,\n\t    paywall: true\n\t  },\n\t\n\t  _initializedAddons: {},\n\t\n\t  init: function init() {\n\t    MediumEditor.Extension.prototype.init.apply(this, arguments);\n\t\n\t    this.core = new _Core2.default(this);\n\t  },\n\t\n\t  destroy: function destroy() {\n\t    this.core.removeButtons();\n\t  },\n\t\n\t  getCore: function getCore() {\n\t    return this.core;\n\t  },\n\t\n\t  getAddons: function getAddons() {\n\t    return this._initializedAddons;\n\t  },\n\t\n\t  getAddon: function getAddon(name) {\n\t    return this._initializedAddons[name];\n\t  }\n\t});\n\t\n\texports.default = MediumEditorInsert;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar utils = {\n\t  ucfirst: function ucfirst(str) {\n\t    return str.charAt(0).toUpperCase() + str.slice(1);\n\t  },\n\t\n\t  generateRandomString: function generateRandomString() {\n\t    var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 15;\n\t\n\t    return Math.random().toString(36).substr(2, length);\n\t  },\n\t\n\t  getClosestWithClassName: function getClosestWithClassName(el, className) {\n\t    return MediumEditor.util.traverseUp(el, function (element) {\n\t      return element.classList.contains(className);\n\t    });\n\t  },\n\t\n\t  isChildOf: function isChildOf(el, parent) {\n\t    return MediumEditor.util.traverseUp(el, function (element) {\n\t      return element === parent;\n\t    }) ? true : false;\n\t  },\n\t\n\t  getElementsByClassName: function getElementsByClassName(parents, className) {\n\t    var results = [];\n\t\n\t    Array.prototype.forEach.call(parents, function (editor) {\n\t      var elements = editor.getElementsByClassName(className);\n\t\n\t      Array.prototype.forEach.call(elements, function (element) {\n\t        results.push(element);\n\t      });\n\t    });\n\t\n\t    return results;\n\t  },\n\t\n\t  getElementsByTagName: function getElementsByTagName(parents, tagName) {\n\t    var results = [];\n\t\n\t    Array.prototype.forEach.call(parents, function (editor) {\n\t      var elements = editor.getElementsByTagName(tagName);\n\t\n\t      Array.prototype.forEach.call(elements, function (element) {\n\t        results.push(element);\n\t      });\n\t    });\n\t\n\t    return results;\n\t  }\n\t};\n\t\n\texports.default = utils;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _ToolbarButton = __webpack_require__(4);\n\t\n\tvar _ToolbarButton2 = _interopRequireDefault(_ToolbarButton);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar MediumEditorToolbar = MediumEditor.extensions.toolbar;\n\t\n\tvar Toolbar = function (_MediumEditorToolbar) {\n\t  _inherits(Toolbar, _MediumEditorToolbar);\n\t\n\t  function Toolbar(options) {\n\t    _classCallCheck(this, Toolbar);\n\t\n\t    var _this = _possibleConstructorReturn(this, (Toolbar.__proto__ || Object.getPrototypeOf(Toolbar)).call(this, options));\n\t\n\t    _this.name = options.type + 'Toolbar';\n\t\n\t    options.buttons.forEach(function (buttonOptions) {\n\t      var button = new _ToolbarButton2.default(Object.assign({}, {\n\t        window: _this.plugin.window,\n\t        document: _this.plugin.document,\n\t        base: _this.plugin.base\n\t      }, buttonOptions));\n\t\n\t      button.init();\n\t      _this.plugin.base.extensions.push(button);\n\t    });\n\t\n\t    _this.window = options.plugin.window;\n\t    _this.document = options.plugin.document;\n\t    _this.base = options.plugin.base;\n\t\n\t    _this.init();\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Toolbar, [{\n\t    key: 'createToolbar',\n\t    value: function createToolbar() {\n\t      var toolbar = this.document.createElement('div');\n\t\n\t      toolbar.id = 'medium-editor-insert-' + this.type + '-toolbar-' + this.getEditorId();\n\t      toolbar.className = 'medium-editor-toolbar';\n\t\n\t      if (this.static) {\n\t        toolbar.className += ' static-toolbar';\n\t      } else if (this.relativeContainer) {\n\t        toolbar.className += ' medium-editor-relative-toolbar';\n\t      } else {\n\t        toolbar.className += ' medium-editor-stalker-toolbar';\n\t      }\n\t\n\t      toolbar.appendChild(this.createToolbarButtons());\n\t\n\t      // Add any forms that extensions may have\n\t      this.forEachExtension(function (extension) {\n\t        if (extension.hasForm) {\n\t          toolbar.appendChild(extension.getForm());\n\t        }\n\t      });\n\t\n\t      this.attachEventHandlers();\n\t\n\t      return toolbar;\n\t    }\n\t  }, {\n\t    key: 'createToolbarButtons',\n\t    value: function createToolbarButtons() {\n\t      var _this2 = this;\n\t\n\t      var ul = this.document.createElement('ul');\n\t      var li = void 0,\n\t          btn = void 0,\n\t          buttons = void 0,\n\t          extension = void 0,\n\t          buttonName = void 0,\n\t          buttonOpts = void 0;\n\t\n\t      ul.id = 'medium-editor-insert-' + this.type + '-toolbar-actions' + this.getEditorId();\n\t      ul.className = 'medium-editor-toolbar-actions';\n\t      ul.style.display = 'block';\n\t\n\t      this.buttons.forEach(function (button) {\n\t        if (typeof button === 'string') {\n\t          buttonName = button;\n\t          buttonOpts = null;\n\t        } else {\n\t          buttonName = button.name;\n\t          buttonOpts = button;\n\t        }\n\t\n\t        // If the button already exists as an extension, it'll be returned\n\t        // othwerise it'll create the default built-in button\n\t        extension = _this2.base.addBuiltInExtension(buttonName, buttonOpts);\n\t\n\t        if (extension && typeof extension.getButton === 'function') {\n\t          btn = extension.getButton(_this2.base);\n\t          li = _this2.document.createElement('li');\n\t          if (MediumEditor.util.isElement(btn)) {\n\t            li.appendChild(btn);\n\t          } else {\n\t            li.innerHTML = btn;\n\t          }\n\t          ul.appendChild(li);\n\t        }\n\t      }, this);\n\t\n\t      buttons = ul.querySelectorAll('button');\n\t      if (buttons.length > 0) {\n\t        buttons[0].classList.add(this.firstButtonClass);\n\t        buttons[buttons.length - 1].classList.add(this.lastButtonClass);\n\t      }\n\t\n\t      return ul;\n\t    }\n\t  }, {\n\t    key: 'checkState',\n\t    value: function checkState() {\n\t      var _this3 = this;\n\t\n\t      var activeElements = void 0;\n\t\n\t      if (this.base.preventSelectionUpdates) {\n\t        return;\n\t      }\n\t\n\t      // Wait for elements to be selected\n\t      setTimeout(function () {\n\t        activeElements = _utils2.default.getElementsByClassName(_this3.getEditorElements(), _this3.activeClassName);\n\t\n\t        // Hide toolbar when no elements are selected\n\t        if (activeElements.length === 0) {\n\t          return _this3.hideToolbar();\n\t        }\n\t\n\t        // Now we know there's a focused editable with a selection\n\t        _this3.showAndUpdateToolbar();\n\t      }, 10);\n\t    }\n\t  }, {\n\t    key: 'setToolbarPosition',\n\t    value: function setToolbarPosition() {\n\t      var container = _utils2.default.getElementsByClassName(this.getEditorElements(), this.activeClassName)[0];\n\t      var anchorPreview = void 0;\n\t\n\t      // If there isn't a valid selection, bail\n\t      if (!container) {\n\t        return this;\n\t      }\n\t\n\t      this.showToolbar();\n\t      this.positionStaticToolbar(container);\n\t\n\t      anchorPreview = this.base.getExtensionByName('anchor-preview');\n\t\n\t      if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n\t        anchorPreview.hidePreview();\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Toolbar;\n\t}(MediumEditorToolbar);\n\t\n\texports.default = Toolbar;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Images = __webpack_require__(7);\n\t\n\tvar _Images2 = _interopRequireDefault(_Images);\n\t\n\tvar _Embeds = __webpack_require__(6);\n\t\n\tvar _Embeds2 = _interopRequireDefault(_Embeds);\n\t\n\tvar _Chapters = __webpack_require__(5);\n\t\n\tvar _Chapters2 = _interopRequireDefault(_Chapters);\n\t\n\tvar _PayWall = __webpack_require__(8);\n\t\n\tvar _PayWall2 = _interopRequireDefault(_PayWall);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Core = function () {\n\t  function Core(plugin) {\n\t    _classCallCheck(this, Core);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t\n\t    this.initAddons();\n\t    this.addButtons();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Core, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      var addonActions = void 0;\n\t\n\t      // This could be chained when medium-editor 5.15.2 is released\n\t      // https://github.com/yabwe/medium-editor/pull/1046\n\t      this._plugin.on(document, 'click', this.toggleButtons.bind(this));\n\t      this._plugin.on(document, 'keyup', this.toggleButtons.bind(this));\n\t      this._plugin.on(this.buttons.getElementsByClassName('medium-editor-insert-buttons-show')[0], 'click', this.toggleAddons.bind(this));\n\t\n\t      // This could be written in one statement when medium-editor 5.15.2 is released\n\t      // https://github.com/yabwe/medium-editor/pull/1046\n\t      addonActions = this.buttons.getElementsByClassName('medium-editor-insert-action');\n\t      Array.prototype.forEach.call(addonActions, function (action) {\n\t        // this._plugin.on(action, 'mousedown', this.handleAddonMouseDown.bind(this));\n\t        _this._plugin.on(action, 'click', _this.handleAddonClick.bind(_this));\n\t      });\n\t\n\t      this._plugin.on(window, 'resize', this.positionButtons.bind(this));\n\t    }\n\t  }, {\n\t    key: 'initAddons',\n\t    value: function initAddons() {\n\t      var _this2 = this;\n\t\n\t      // Initialize all default addons, we'll delete ones we don't need later\n\t      this._plugin._initializedAddons = {\n\t        images: new _Images2.default(this._plugin, this._plugin.addons.images),\n\t        embeds: new _Embeds2.default(this._plugin, this._plugin.addons.embeds),\n\t        chapters: new _Chapters2.default(this._plugin, this._plugin.addons.chapters),\n\t        paywall: new _PayWall2.default(this._plugin, this._plugin.addons.paywall)\n\t      };\n\t\n\t      Object.keys(this._plugin.addons).forEach(function (name) {\n\t        var addonOptions = _this2._plugin.addons[name];\n\t\n\t        // If the addon is custom one\n\t        if (!_this2._plugin._initializedAddons[name]) {\n\t          if (typeof addonOptions === 'function') {\n\t            _this2._plugin._initializedAddons[name] = new addonOptions(_this2._plugin);\n\t          } else {\n\t            window.console.error('I don\\'t know how to initialize custom \"' + name + '\" addon!');\n\t          }\n\t        }\n\t\n\t        // Delete disabled addon\n\t        if (!addonOptions) {\n\t          delete _this2._plugin._initializedAddons[name];\n\t        }\n\t      });\n\t    }\n\t  }, {\n\t    key: 'addButtons',\n\t    value: function addButtons() {\n\t      var addons = this._plugin.getAddons();\n\t      var html = void 0;\n\t\n\t      this.buttons = document.createElement('div');\n\t      this.buttons.id = 'medium-editor-insert-' + this._plugin.getEditorId();\n\t      this.buttons.classList.add('medium-editor-insert-buttons');\n\t      this.buttons.setAttribute('contentediable', false);\n\t\n\t      html = '<a class=\"medium-editor-insert-buttons-show\">+</a>\\n            <ul class=\"medium-editor-insert-buttons-addons\">';\n\t\n\t      Object.keys(addons).forEach(function (name) {\n\t        var addon = addons[name];\n\t\n\t        html += '<li><a class=\"medium-editor-insert-action\" data-addon=\"' + name + '\">' + addon.label + '</a></li>';\n\t      });\n\t\n\t      html += '</ul>';\n\t\n\t      this.buttons.innerHTML = html;\n\t\n\t      document.body.appendChild(this.buttons);\n\t    }\n\t  }, {\n\t    key: 'removeButtons',\n\t    value: function removeButtons() {\n\t      this.buttons.remove();\n\t    }\n\t  }, {\n\t    key: 'positionButtons',\n\t    value: function positionButtons() {\n\t      var el = void 0,\n\t          elPosition = void 0,\n\t          addons = void 0,\n\t          addonButton = void 0,\n\t          addonsStyle = void 0,\n\t          addonButtonStyle = void 0,\n\t          position = void 0;\n\t\n\t      // Don't position buttons if they aren't active\n\t      if (this.buttons.classList.contains('medium-editor-insert-buttons-active') === false) {\n\t        return;\n\t      }\n\t\n\t      el = this._editor.getSelectedParentElement();\n\t      elPosition = el.getBoundingClientRect();\n\t      addons = this.buttons.getElementsByClassName('medium-editor-insert-buttons-addons')[0];\n\t      addonButton = this.buttons.getElementsByClassName('medium-editor-insert-action')[0];\n\t      addonsStyle = window.getComputedStyle(addons);\n\t      addonButtonStyle = window.getComputedStyle(addonButton);\n\t\n\t      // Calculate position\n\t      position = {\n\t        top: window.scrollY + elPosition.top,\n\t        left: window.scrollX + elPosition.left - parseInt(addonsStyle.left, 10) - parseInt(addonButtonStyle.marginLeft, 10)\n\t      };\n\t\n\t      // If left position is lower than 0, the buttons would be out of the viewport.\n\t      // In that case, align buttons with the editor\n\t      position.left = position.left < 0 ? elPosition.left : position.left;\n\t\n\t      this.buttons.style.left = position.left + 'px';\n\t      this.buttons.style.top = position.top + 'px';\n\t    }\n\t  }, {\n\t    key: 'toggleButtons',\n\t    value: function toggleButtons() {\n\t      var el = this._editor.getSelectedParentElement();\n\t\n\t      if (this.shouldDisplayButtonsOnElement(el)) {\n\t        this.selectElement(el);\n\t        this.showButtons();\n\t      } else {\n\t        this.hideButtons();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'shouldDisplayButtonsOnElement',\n\t    value: function shouldDisplayButtonsOnElement(el) {\n\t      var addons = this._plugin.getAddons(),\n\t          addonClassNames = [];\n\t      var isAddon = false,\n\t          belongsToEditor = false;\n\t\n\t      // Don't show buttons when the element has text\n\t      if (el.innerText.trim() !== '') {\n\t        return false;\n\t      }\n\t\n\t      // Don't show buttons when the editor doesn't belong to editor\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        if (_utils2.default.isChildOf(el, editor)) {\n\t          belongsToEditor = true;\n\t          return;\n\t        }\n\t      });\n\t\n\t      if (!belongsToEditor) {\n\t        return false;\n\t      }\n\t\n\t      // Get class names used by addons\n\t      Object.keys(addons).forEach(function (addonName) {\n\t        var addon = addons[addonName];\n\t        if (addon.elementClassName) {\n\t          addonClassNames.push(addon.elementClassName);\n\t        }\n\t      });\n\t\n\t      // Don't show buttons if the element is an addon element\n\t      // - when the element has an addon class, or some of its parents have it\n\t      addonClassNames.forEach(function (className) {\n\t        if (el.classList.contains(className) || _utils2.default.getClosestWithClassName(el, className)) {\n\t          isAddon = true;\n\t          return;\n\t        }\n\t      });\n\t\n\t      return !isAddon;\n\t    }\n\t  }, {\n\t    key: 'selectElement',\n\t    value: function selectElement(el) {\n\t      this.selectedElement = el;\n\t    }\n\t  }, {\n\t    key: 'showButtons',\n\t    value: function showButtons() {\n\t      this.buttons.classList.add('medium-editor-insert-buttons-active');\n\t      this.positionButtons();\n\t    }\n\t  }, {\n\t    key: 'hideButtons',\n\t    value: function hideButtons() {\n\t      this.buttons.classList.remove('medium-editor-insert-buttons-active');\n\t      this.buttons.classList.remove('medium-editor-insert-addons-active');\n\t    }\n\t  }, {\n\t    key: 'toggleAddons',\n\t    value: function toggleAddons() {\n\t      this.buttons.classList.toggle('medium-editor-insert-addons-active');\n\t    }\n\t\n\t    // handleAddonMouseDown(e) {\n\t    //     const name = e.currentTarget.getAttribute('data-addon');\n\t    //     e.preventDefault();\n\t\n\t    //     console.log(this._plugin.getAddon(name));\n\t    //     this._plugin.getAddon(name).handleMouseDown(e);\n\t    // }\n\t\n\t  }, {\n\t    key: 'handleAddonClick',\n\t    value: function handleAddonClick(e) {\n\t      var name = e.currentTarget.getAttribute('data-addon');\n\t      e.preventDefault();\n\t\n\t      this._plugin.getAddon(name).handleClick(e);\n\t      this.hideButtons();\n\t    }\n\t  }]);\n\t\n\t  return Core;\n\t}();\n\t\n\texports.default = Core;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar ToolbarButton = MediumEditor.extensions.button.extend({\n\t  init: function init() {\n\t    this.button = this.document.createElement('button');\n\t    this.button.classList.add('medium-editor-action');\n\t    this.button.classList.add(this.className);\n\t    this.button.innerHTML = '<b>' + this.label + '</b>';\n\t\n\t    this.on(this.button, 'click', this.handleClick.bind(this));\n\t  },\n\t\n\t  getButton: function getButton() {\n\t    return this.button;\n\t  },\n\t\n\t  handleClick: function handleClick(evt) {\n\t    this.onClick(evt);\n\t  }\n\t});\n\t\n\texports.default = ToolbarButton;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Chapters = function () {\n\t  function Chapters(plugin, options) {\n\t    _classCallCheck(this, Chapters);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-bars\"></span>',\n\t      captions: true,\n\t      storeMeta: false,\n\t      styles: {\n\t        left: {\n\t          label: '<span class=\"fa fa-align-left\"></span>'\n\t        },\n\t        wide: {\n\t          label: '<span class=\"fa fa-align-justify\"></span>'\n\t        }\n\t      },\n\t      actions: {\n\t        remove: {\n\t          label: '<span class=\"fa fa-times\"></span>',\n\t          clicked: function clicked() {\n\t            // var $event = $.Event('keydown');\n\t\n\t            // $event.which = 8;\n\t            // $(document).trigger($event);\n\t          }\n\t        }\n\t      },\n\t      parseOnPaste: false\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t\n\t    this.activeClassName = 'medium-editor-insert-embed-chapters-active';\n\t    this.elementClassName = 'medium-editor-insert-embed-chapters';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignCenterClassName = 'align-center-wide';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t\n\t    this.initToolbar();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Chapters, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectEmbed.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'selectEmbed',\n\t    value: function selectEmbed(e) {\n\t      var el = e.target;\n\t      if (this.getClosestElementByClassName(el, this.elementClassName)) {\n\t        this.selectEmbedCore(el, event);\n\t        e && e.stopPropagation();\n\t        e && e.preventDefault();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getClosestElementByClassName',\n\t    value: function getClosestElementByClassName(el, className) {\n\t      while (el) {\n\t        if (el.classList && el.classList.contains(className)) return el;\n\t        el = el.parentNode;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'selectEmbedCore',\n\t    value: function selectEmbedCore(el) {\n\t      var element = this.getClosestElementByClassName(el, this.elementClassName);\n\t      element.classList.add(this.activeClassName);\n\t      var currentSelection = window.getSelection();\n\t    }\n\t  }, {\n\t    key: 'unselectEmbed',\n\t    value: function unselectEmbed(e) {\n\t      var el = e.target;\n\t      this.unselectEmbedCore(el);\n\t    }\n\t  }, {\n\t    key: 'unselectEmbedCore',\n\t    value: function unselectEmbedCore(el) {\n\t      var _this2 = this;\n\t\n\t      var clickedEmbed = void 0,\n\t          clickedEmbedPlaceholder = void 0,\n\t          chapters = void 0,\n\t          embedsPlaceholders = void 0;\n\t\n\t      chapters = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\t      if (!chapters || !chapters.length) {\n\t        return false;\n\t      }\n\t\n\t      if (chapters) {\n\t        Array.prototype.forEach.call(chapters, function (chapters) {\n\t          if (chapters !== clickedEmbed) {\n\t            chapters.classList.remove(_this2.activeClassName);\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t\n\t      // Enter key\n\t      if (e.which === 40 || e.which === 13) {\n\t        // Detect selected chapters\n\t        var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t\n\t        if (selectedEmbedDOM) {\n\t          var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (!nextSiblingParagraphDOM) {\n\t            // Insert paragraph and focus\n\t            var paragraph = document.createElement('p');\n\t            paragraph.innerHTML = '<br>';\n\t            selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n\t          }\n\t\n\t          // Focus next paragraph\n\t          nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (nextSiblingParagraphDOM) {\n\t            if (!nextSiblingParagraphDOM.innerHTML) {\n\t              nextSiblingParagraphDOM.innerHTML = '<br>';\n\t            }\n\t            window.getSelection().removeAllRanges();\n\t            this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n\t            selectedEmbedDOM.classList.remove(this.activeClassName);\n\t            MediumEditor.selection.clearSelection(document, true);\n\t            selectedEmbedDOM.classList.remove(this.activeClassName);\n\t            e.preventDefault();\n\t          }\n\t        }\n\t      }\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1) {\n\t        this.removeEmbed(e);\n\t      } else if (document.querySelector('.' + this.activeClassName)) {\n\t        // Block all keys\n\t        e.preventDefault();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setFocusOnElement',\n\t    value: function setFocusOnElement(el) {\n\t      // this._editor.elements[0].focus();\n\t      setTimeout(function () {\n\t        var currentSelection = window.getSelection();\n\t        var range = document.createRange();\n\t        range.setStart(el, 0);\n\t        currentSelection.removeAllRanges();\n\t        currentSelection.addRange(range);\n\t      }, 300);\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      this.el = this._plugin.getCore().selectedElement;\n\t      this.setFocusOnElement(this.el);\n\t      this.embedChapter(this.el);\n\t    }\n\t  }, {\n\t    key: 'removeEmbed',\n\t    value: function removeEmbed(e) {\n\t      var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t      if (selectedEmbedDOM) {\n\t        selectedEmbedDOM.remove();\n\t        e.preventDefault();\n\t        e.stopPropagation();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Init Toolbar for tuning chapters position\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {\n\t      this.toolbar = new _Toolbar2.default({\n\t        plugin: this._plugin,\n\t        type: 'chapters',\n\t        activeClassName: this.activeClassName,\n\t        buttons: [{\n\t          name: 'chapters-align-left',\n\t          action: 'align-left',\n\t          className: 'btn-align-left',\n\t          label: 'Left',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignLeftClassName, 'chapters-align-left', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'chapters-align-center-wide',\n\t          action: 'align-center-wide',\n\t          className: 'btn-align-center-wide',\n\t          label: 'Center',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignCenterClassName, 'chapters-align-center', evt);\n\t          }.bind(this)\n\t        }]\n\t      });\n\t\n\t      this._editor.extensions.push(this.toolbar);\n\t    }\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action, evt) {\n\t      if (evt) {\n\t        evt.preventDefault();\n\t        evt.stopPropagation();\n\t      }\n\t\n\t      var el = document.querySelector('.' + this.activeClassName);\n\t      el.classList.remove(this.alignLeftClassName, this.alignCenterClassName);\n\t      el.classList.add(className);\n\t\n\t      this.toolbar.setToolbarPosition();\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Add html to page\n\t     *\n\t     * @param {string} html\n\t     * @param {string} pastedUrl\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'embedChapter',\n\t    value: function embedChapter(el) {\n\t      var chapter = document.createElement('div');\n\t      chapter.classList.add(this.elementClassName);\n\t\n\t      var contentHTML = void 0;\n\t      if (this.options.contentHTML) {\n\t        if (typeof this.options.contentHTML === 'function') {\n\t          contentHTML = this.options.contentHTML();\n\t        } else {\n\t          contentHTML = this.options.contentHTML;\n\t        }\n\t      }\n\t\n\t      if (contentHTML) {\n\t        chapter.innerHTML = contentHTML;\n\t        el.replaceWith(chapter);\n\t\n\t        this.options.onInsert && this.options.onInsert();\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this.cancelEmbed();\n\t    }\n\t  }]);\n\t\n\t  return Chapters;\n\t}();\n\t\n\texports.default = Chapters;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Embeds = function () {\n\t  function Embeds(plugin, options) {\n\t    _classCallCheck(this, Embeds);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-youtube-play\"></span>',\n\t      placeholder: 'Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter',\n\t      oembedProxy: 'http://medium.iframe.ly/api/oembed?omit_script=1&iframe=1',\n\t      captions: true,\n\t      captionPlaceholder: 'Type caption (optional)',\n\t      storeMeta: false,\n\t      styles: {\n\t        wide: {\n\t          label: '<span class=\"fa fa-align-justify\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        },\n\t        left: {\n\t          label: '<span class=\"fa fa-align-left\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        },\n\t        right: {\n\t          label: '<span class=\"fa fa-align-right\"></span>'\n\t          // added: function ($el) {},\n\t          // removed: function ($el) {}\n\t        }\n\t      },\n\t      actions: {\n\t        remove: {\n\t          label: '<span class=\"fa fa-times\"></span>',\n\t          clicked: function clicked() {\n\t            // var $event = $.Event('keydown');\n\t\n\t            // $event.which = 8;\n\t            // $(document).trigger($event);\n\t          }\n\t        }\n\t      },\n\t      parseOnPaste: false,\n\t      onChange: function onChange(action) {\n\t        console.log('Embed change: ', action);\n\t      }\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t\n\t    this.activeClassName = 'medium-editor-insert-embeds-active';\n\t    this.placeholderClassName = 'medium-editor-insert-embeds-placeholder';\n\t    this.elementClassName = 'medium-editor-insert-embeds';\n\t    this.loadingClassName = 'medium-editor-insert-embeds-loading';\n\t    this.activeClassName = 'medium-editor-insert-embed-active';\n\t    this.descriptionContainerClassName = 'medium-editor-embed-embed-description-container';\n\t    this.descriptionClassName = 'medium-editor-embed-embed-description';\n\t    this.overlayClassName = 'medium-editor-insert-embeds-overlay';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignRightClassName = 'align-right';\n\t    this.alignCenterClassName = 'align-center';\n\t    this.alignCenterWideClassName = 'align-center-wide';\n\t    this.alignCenterFullClassName = 'align-center-full';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t\n\t    this.initToolbar();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Embeds, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectEmbed.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'selectEmbed',\n\t    value: function selectEmbed(e) {\n\t      var el = e.target;\n\t      this.selectEmbedCore(el);\n\t    }\n\t  }, {\n\t    key: 'selectEmbedCore',\n\t    value: function selectEmbedCore(el) {\n\t      if (el.classList.contains(this.overlayClassName)) {\n\t        var selectedEl = _utils2.default.getClosestWithClassName(el, this.elementClassName);\n\t        if (!selectedEl.classList.contains(this.loadingClassName)) {\n\t          selectedEl.classList.add(this.activeClassName);\n\t          this._editor.selectElement(selectedEl);\n\t          this.activeEmbedElement = selectedEl;\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'unselectEmbed',\n\t    value: function unselectEmbed(e) {\n\t      var el = e.target;\n\t      this.unselectEmbedCore(el);\n\t    }\n\t  }, {\n\t    key: 'unselectEmbedCore',\n\t    value: function unselectEmbedCore(el) {\n\t      var _this2 = this;\n\t\n\t      var clickedEmbed = void 0,\n\t          clickedEmbedPlaceholder = void 0,\n\t          embeds = void 0,\n\t          embedsPlaceholders = void 0;\n\t\n\t      if (el.classList.contains(this.descriptionClassName)) return false;\n\t\n\t      embeds = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\t\n\t      if (!embeds || !embeds.length) {\n\t        return false;\n\t      }\n\t\n\t      // Unselect all selected images. If an image is clicked, unselect all except this one.\n\t      if (el.classList.contains(this.overlayClassName)) {\n\t        clickedEmbed = _utils2.default.getClosestWithClassName(el, this.elementClassName);\n\t      }\n\t\n\t      if (embeds) {\n\t        Array.prototype.forEach.call(embeds, function (embed) {\n\t          if (embed !== clickedEmbed) {\n\t            embed.classList.remove(_this2.activeClassName);\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t      var isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\t\n\t      // Enter key in description\n\t      if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n\t        if (isDescriptionElement) {\n\t          e.preventDefault();\n\t        }\n\t      }\n\t\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n\t        this.removeEmbed(e);\n\t      }\n\t\n\t      // Down\n\t      if (e.which === 40) {\n\t        // Detect selected image\n\t        var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t\n\t        if (selectedEmbedDOM) {\n\t          var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (!nextSiblingParagraphDOM) {\n\t            // Insert paragraph and focus\n\t            var paragraph = document.createElement('p');\n\t            paragraph.innerHTML = '<br>';\n\t            selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n\t          }\n\t\n\t          // Focus next paragraph\n\t          nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t          if (nextSiblingParagraphDOM) {\n\t            if (!nextSiblingParagraphDOM.innerHTML) {\n\t              nextSiblingParagraphDOM.innerHTML = '<br>';\n\t            }\n\t            window.getSelection().removeAllRanges();\n\t            this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n\t            selectedEmbedDOM.classList.remove(this.activeClassName);\n\t            MediumEditor.selection.clearSelection(document, true);\n\t            e.preventDefault();\n\t          }\n\t        }\n\t      }\n\t\n\t      // Enter\n\t      if (e.which === 13) {\n\t        var _selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t\n\t        if (_selectedEmbedDOM) {\n\t          var _paragraph = document.createElement('p');\n\t          _paragraph.innerHTML = '<br>';\n\t          _selectedEmbedDOM.insertAdjacentElement('beforeBegin', _paragraph);\n\t          window.getSelection().removeAllRanges();\n\t          this._plugin.getCore()._editor.selectElement(_paragraph);\n\t          _selectedEmbedDOM.classList.remove(this.activeClassName);\n\t          e.preventDefault();\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setFocusOnElement',\n\t    value: function setFocusOnElement(el) {\n\t      // this._editor.elements[0].focus();\n\t      setTimeout(function () {\n\t        var currentSelection = window.getSelection();\n\t        var range = document.createRange();\n\t        range.setStart(el, 0);\n\t        currentSelection.removeAllRanges();\n\t        currentSelection.addRange(range);\n\t      }, 300);\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      this.el = this._plugin.getCore().selectedElement;\n\t      this.el.classList.add(this.loadingClassName);\n\t      this.el.classList.add(this.placeholderClassName);\n\t      this.el.setAttribute('data-placeholder', this.options.placeholder);\n\t\n\t      this.instanceHandlePaste = this.handlePaste.bind(this);\n\t      this.instanceHandleKeyDown = this.handleKeyDown.bind(this);\n\t\n\t      this._plugin.on(document, 'paste', this.instanceHandlePaste);\n\t      this._plugin.on(document, 'keydown', this.instanceHandleKeyDown);\n\t\n\t      // FIXME: it doesn't work yet.  :(\n\t      this._plugin.on(this.el, 'blur', this.handleBlur.bind(this));\n\t\n\t      this.setFocusOnElement(this.el);\n\t    }\n\t  }, {\n\t    key: 'handleKeyDown',\n\t    value: function handleKeyDown(evt) {\n\t      if (evt.which !== 17 && evt.which !== 91 && evt.which !== 224 // Cmd or Ctrl pressed (user probably preparing to paste url via hot keys)\n\t      && (evt.which === 27 || this._plugin.selectedElement !== this.el)) {\n\t        // Escape\n\t        this.cancelEmbed();\n\t        return false;\n\t      }\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'handlePaste',\n\t    value: function handlePaste(evt) {\n\t      var pastedUrl = evt.clipboardData.getData('text');\n\t      var linkRegEx = new RegExp('^(http(s?):)?\\/\\/', 'i');\n\t      var linkRegEx2 = new RegExp('^(www\\.)?', 'i');\n\t\n\t      if (linkRegEx.test(pastedUrl) || linkRegEx2.test(pastedUrl)) {\n\t        var html = this.options.oembedProxy ? this.oembed(pastedUrl, true) : this.parseUrl(pastedUrl, true);\n\t      }\n\t\n\t      this.cancelEmbed();\n\t    }\n\t  }, {\n\t    key: 'removeEmbed',\n\t    value: function removeEmbed(e) {\n\t      var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t      if (selectedEmbedDOM) {\n\t        selectedEmbedDOM.remove();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Init Toolbar for tuning embed position\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {\n\t      this.toolbar = new _Toolbar2.default({\n\t        plugin: this._plugin,\n\t        type: 'embeds',\n\t        activeClassName: this.activeClassName,\n\t        buttons: [{\n\t          name: 'embed-align-left',\n\t          action: 'align-left',\n\t          className: 'btn-align-left',\n\t          label: 'Left',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignLeftClassName, 'embed-align-left', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center',\n\t          action: 'align-center',\n\t          className: 'btn-align-center',\n\t          label: 'Center',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignCenterClassName, 'embed-align-center', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center-wide',\n\t          action: 'align-center-wide',\n\t          className: 'btn-align-center-wide',\n\t          label: 'Wide',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignCenterWideClassName, 'embed-align-center-wide', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-center-full',\n\t          action: 'align-center-full',\n\t          className: 'btn-align-center-full',\n\t          label: 'Full',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignCenterFullClassName, 'embed-align-center-full', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'embed-align-right',\n\t          action: 'align-right',\n\t          className: 'btn-align-right',\n\t          label: 'Right',\n\t          onClick: function (evt) {\n\t            this.changeAlign(this.alignRightClassName, 'embed-align-right', evt);\n\t          }.bind(this)\n\t        }]\n\t      });\n\t\n\t      this._editor.extensions.push(this.toolbar);\n\t    }\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action, evt) {\n\t      if (evt) {\n\t        evt.preventDefault();\n\t        evt.stopPropagation();\n\t      }\n\t      var el = this.activeEmbedElement;\n\t      el.classList.remove(this.alignLeftClassName, this.alignRightClassName, this.alignCenterClassName, this.alignCenterWideClassName, this.alignCenterFullClassName);\n\t      el.classList.add(className);\n\t\n\t      this.toolbar.setToolbarPosition();\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Get HTML via oEmbed proxy\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'oembed',\n\t    value: function oembed(url, pasted) {\n\t      var _this3 = this;\n\t\n\t      var urlOut = this.options.oembedProxy + '&url=' + url;\n\t      var xhr = new XMLHttpRequest();\n\t\n\t      // console.log(urlOut);\n\t      xhr.open(\"GET\", urlOut, true);\n\t      xhr.onreadystatechange = function () {\n\t        if (xhr.readyState === 4 && xhr.status === 200) {\n\t          var data = JSON.parse(xhr.responseText);\n\t          _this3.embed(data.html, url, data);\n\t        }\n\t      };\n\t\n\t      xhr.send();\n\t\n\t      return true;\n\t    }\n\t\n\t    /**\n\t     * Get HTML using regexp\n\t     *\n\t     * @param {string} url\n\t     * @param {bool} pasted\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'parseUrl',\n\t    value: function parseUrl(url, pasted) {\n\t      var html = void 0;\n\t\n\t      if (!new RegExp(['youtube', 'youtu.be', 'vimeo', 'instagram', 'twitter', 'facebook'].join('|')).test(url)) {\n\t        // $.proxy(this, 'convertBadEmbed', url)();\n\t        return false;\n\t      }\n\t\n\t      html = url.replace(/\\n?/g, '').replace(/^((http(s)?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be)\\/(watch\\?v=|v\\/)?)([a-zA-Z0-9\\-_]+)(.*)?$/, '<div class=\"video video-youtube\"><iframe width=\"420\" height=\"315\" src=\"//www.youtube.com/embed/$7\" frameborder=\"0\" allowfullscreen></iframe></div>').replace(/^https?:\\/\\/vimeo\\.com(\\/.+)?\\/([0-9]+)$/, '<div class=\"video video-vimeo\"><iframe src=\"//player.vimeo.com/video/$2\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').replace(/^https:\\/\\/twitter\\.com\\/(\\w+)\\/status\\/(\\d+)\\/?$/, '<blockquote class=\"twitter-tweet\" align=\"center\" lang=\"en\"><a href=\"https://twitter.com/$1/statuses/$2\"></a></blockquote><script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>').replace(/^(https:\\/\\/www\\.facebook\\.com\\/(.*))$/, '<script src=\"//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2\" async></script><div class=\"fb-post\" data-href=\"$1\"><div class=\"fb-xfbml-parse-ignore\"><a href=\"$1\">Loading Facebook post...</a></div></div>').replace(/^https?:\\/\\/instagram\\.com\\/p\\/(.+)\\/?$/, '<span class=\"instagram\"><iframe src=\"//instagram.com/p/$1/embed/\" width=\"612\" height=\"710\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe></span>');\n\t\n\t      if (/<(\"[^\"]*\"|'[^']*'|[^'\">])*>/.test(html) === false) {\n\t        // $.proxy(this, 'convertBadEmbed', url)();\n\t        return false;\n\t      }\n\t\n\t      if (pasted) {\n\t        return this.embed(html, url);\n\t      } else {\n\t        return this.embed(html);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'embed',\n\t\n\t\n\t    /**\n\t     * Add html to page\n\t     *\n\t     * @param {string} html\n\t     * @param {string} pastedUrl\n\t     * @return {void}\n\t     */\n\t\n\t    value: function embed(html, pastedUrl, info) {\n\t      var el = void 0,\n\t          figure = void 0,\n\t          descriptionContainer = void 0,\n\t          description = void 0,\n\t          metacontainer = void 0,\n\t          container = void 0,\n\t          overlay = void 0,\n\t          lastEl = void 0,\n\t          paragraph = void 0;\n\t\n\t      if (!html) {\n\t        console.error('Incorrect URL format specified: ', pastedUrl);\n\t        return false;\n\t      }\n\t\n\t      if (info && info.type === 'link') {\n\t        console.error('Just common link  no any embeds to insert: ', pastedUrl);\n\t        return false;\n\t      }\n\t\n\t      el = this._plugin.getCore().selectedElement;\n\t      figure = document.createElement('figure');\n\t      figure.classList.add('medium-editor-insert-embeds-item');\n\t\n\t      descriptionContainer = document.createElement('div');\n\t      descriptionContainer.classList.add(this.descriptionContainerClassName);\n\t\n\t      description = document.createElement('figcaption');\n\t      description.classList.add(this.descriptionClassName);\n\t      description.setAttribute('contenteditable', true);\n\t      description.setAttribute('data-placeholder', 'Type caption for embed (optional)');\n\t\n\t      metacontainer = document.createElement('div');\n\t      metacontainer.classList.add(this.elementClassName);\n\t      metacontainer.classList.add(this.alignCenterClassName);\n\t      paragraph = document.createElement('p');\n\t      paragraph.innerHTML = '<br>';\n\t\n\t      // metacontainer.classList.add(this.activeClassName);\n\t\n\t      metacontainer.setAttribute('contenteditable', false);\n\t\n\t      container = document.createElement('div');\n\t      container.classList.add('medium-editor-insert-embeds-item-container');\n\t\n\t      overlay = document.createElement('div');\n\t      overlay.classList.add(this.overlayClassName);\n\t\n\t      metacontainer.appendChild(figure);\n\t      figure.appendChild(container);\n\t      figure.appendChild(overlay);\n\t\n\t      descriptionContainer.classList.add(this.descriptionContainerClassName);\n\t      description.contentEditable = true;\n\t      description.classList.add(this.descriptionClassName);\n\t      description.dataset.placeholder = this.descriptionPlaceholder;\n\t\n\t      el.replaceWith(metacontainer);\n\t      // Insert a empty paragraph\n\t      if (!el.nextSibling) {\n\t        el.insertAdjacentElement('afterend', paragraph);\n\t      }\n\t\n\t      // check if embed is last element, then add one more p after it\n\t      lastEl = metacontainer.parentNode.lastChild;\n\t\n\t      while (lastEl && lastEl.nodeType !== 1) {\n\t        lastEl = lastEl.previousSibling;\n\t      }\n\t\n\t      if (lastEl === metacontainer) {\n\t        var lastP = document.createElement('p');\n\t        lastP.appendChild(document.createElement('br'));\n\t        metacontainer.parentNode.appendChild(lastP);\n\t      }\n\t\n\t      container.innerHTML = html;\n\t\n\t      this._editor.selectElement(metacontainer);\n\t\n\t      // console.log(html);\n\t      // this.core.triggerInput();\n\t\n\t      if (html.indexOf('facebook') !== -1) {\n\t        if (typeof FB !== 'undefined') {\n\t          setTimeout(function () {\n\t            FB.XFBML.parse();\n\t          }, 2000);\n\t        }\n\t      }\n\t\n\t      this.options.onInsert && this.options.onInsert(html);\n\t\n\t      setTimeout(function () {\n\t        overlay.click();\n\t      }, 100);\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'handleBlur',\n\t    value: function handleBlur() {\n\t      console.log('blur');\n\t      // this.cancelEmbed();\n\t    }\n\t  }, {\n\t    key: 'hidePlaceholder',\n\t    value: function hidePlaceholder() {\n\t      this.el.removeAttribute('data-placeholder');\n\t      this.el.classList.remove('medium-editor-insert-embeds-placeholder');\n\t    }\n\t  }, {\n\t    key: 'cancelEmbed',\n\t    value: function cancelEmbed() {\n\t      this.hidePlaceholder();\n\t      this.el.classList.remove(this.activeClassName);\n\t      this.el.classList.remove(this.loadingClassName);\n\t\n\t      this._plugin.off(document, 'paste', this.instanceHandlePaste);\n\t      this._plugin.off(document, 'keyup', this.instanceHandleKeyUp);\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this.cancelEmbed();\n\t    }\n\t  }]);\n\t\n\t  return Embeds;\n\t}();\n\t\n\texports.default = Embeds;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Images = function () {\n\t  function Images(plugin, options) {\n\t    _classCallCheck(this, Images);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-camera\"></span>',\n\t      preview: true,\n\t      uploadUrl: 'upload.php',\n\t      deleteUrl: 'delete.php',\n\t      deleteMethod: 'DELETE',\n\t      deleteData: {},\n\t      onChange: function onChange(action) {\n\t        console.log('Image change: ', action);\n\t      }\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t    this.elementClassName = 'medium-editor-insert-images';\n\t    this.loadingClassName = 'medium-editor-insert-images-loading';\n\t    this.activeClassName = 'medium-editor-insert-image-active';\n\t    this.descriptionContainerClassName = 'medium-editor-embed-image-description-container';\n\t    this.descriptionClassName = 'medium-editor-embed-image-description';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignRightClassName = 'align-right';\n\t    this.alignCenterClassName = 'align-center';\n\t    this.alignCenterWideClassName = 'align-center-wide';\n\t    this.alignCenterFullClassName = 'align-center-full';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t    this.activeImageElement = null;\n\t    this.isLoaderShowing = false;\n\t    this.initToolbar();\n\t    this.events();\n\t  }\n\t\n\t  _createClass(Images, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectImage.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectImage.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      var _this2 = this;\n\t\n\t      if (this.options.onInsertButtonClick) {\n\t        var uid = _utils2.default.generateRandomString();\n\t        this.options.onInsertButtonClick(function (imageUrl) {\n\t          return _this2.insertImage(imageUrl, uid, false);\n\t        }, function (imageUrl) {\n\t          return _this2.insertImage(imageUrl, uid, true);\n\t        });\n\t      } else {\n\t        this._input = document.createElement('input');\n\t        this._input.type = 'file';\n\t        this._input.multiple = true;\n\t        this._plugin.on(this._input, 'change', this.uploadFiles.bind(this));\n\t        this._input.click();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {\n\t      this.toolbar = new _Toolbar2.default({\n\t        plugin: this._plugin,\n\t        type: 'images',\n\t        activeClassName: this.activeClassName,\n\t        buttons: [{\n\t          name: 'image-align-left',\n\t          action: 'align-left',\n\t          className: 'btn-align-left',\n\t          label: 'Left',\n\t          title: 'Left',\n\t          onClick: function (evt) {\n\t            this.changeAlign('align-left', 'image-align-left', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center',\n\t          action: 'align-center',\n\t          className: 'btn-align-center',\n\t          label: 'Center',\n\t          title: 'Center',\n\t          onClick: function (evt) {\n\t            this.changeAlign('align-center', 'image-align-center', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center-wide',\n\t          action: 'align-center-wide',\n\t          className: 'btn-align-center-wide',\n\t          label: 'Wide',\n\t          title: 'Wide',\n\t          onClick: function (evt) {\n\t            this.changeAlign('align-center-wide', 'image-align-center-wide', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-center-full',\n\t          action: 'align-center-full',\n\t          className: 'btn-align-center-full',\n\t          label: 'Full',\n\t          title: 'Full wide',\n\t          onClick: function (evt) {\n\t            this.changeAlign('align-center-full', 'image-align-center-full', evt);\n\t          }.bind(this)\n\t        }, {\n\t          name: 'image-align-right',\n\t          action: 'align-right',\n\t          className: 'btn-align-right',\n\t          label: 'Right',\n\t          title: 'Right',\n\t          onClick: function (evt) {\n\t            this.changeAlign('align-right', 'image-align-right', evt);\n\t          }.bind(this)\n\t        }]\n\t      });\n\t\n\t      this._editor.extensions.push(this.toolbar);\n\t    }\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action, evt) {\n\t      if (evt) {\n\t        evt.preventDefault();\n\t        evt.stopPropagation();\n\t      }\n\t      var el = this.activeImageElement;\n\t      el.classList.remove(this.alignLeftClassName, this.alignRightClassName, this.alignCenterClassName, this.alignCenterWideClassName, this.alignCenterFullClassName);\n\t\n\t      el.classList.add(className);\n\t      this.toolbar.setToolbarPosition();\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'uploadFiles',\n\t    value: function uploadFiles() {\n\t      var _this3 = this;\n\t\n\t      Array.prototype.forEach.call(this._input.files, function (file) {\n\t        // Generate uid for this image, so we can identify it later\n\t        // and we can replace preview image with uploaded one\n\t        var uid = _utils2.default.generateRandomString();\n\t\n\t        if (_this3.options.preview) {\n\t          _this3.preview(file, uid);\n\t        }\n\t\n\t        _this3.upload(file, uid);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'preview',\n\t    value: function preview(file, uid) {\n\t      var _this4 = this;\n\t\n\t      var reader = new FileReader();\n\t\n\t      reader.onload = function (e) {\n\t        _this4.insertImage(e.target.result, uid);\n\t      };\n\t\n\t      reader.readAsDataURL(file);\n\t    }\n\t  }, {\n\t    key: 'upload',\n\t    value: function upload(file, uid) {\n\t      var xhr = new XMLHttpRequest(),\n\t          data = new FormData();\n\t      var insertImage = this.insertImage.bind(this);\n\t\n\t      xhr.open(\"POST\", this.options.uploadUrl, true);\n\t      xhr.onreadystatechange = function () {\n\t        if (xhr.readyState === 4 && xhr.status === 200) {\n\t          insertImage(xhr.responseText, _utils2.default.generateRandomString());\n\t        }\n\t      };\n\t\n\t      data.append(\"file\", file);\n\t      xhr.send(data);\n\t    }\n\t  }, {\n\t    key: 'insertImage',\n\t    value: function insertImage(imageUrl, uid, isLoader) {\n\t      var paragraph = this._plugin.getCore().selectedElement;\n\t\n\t      // Replace paragraph with div, because figure is a block element\n\t      // and can't be nested inside paragraphs\n\t      if (paragraph.nodeName.toLowerCase() === 'p') {\n\t        var div = document.createElement('div');\n\t\n\t        paragraph.parentNode.insertBefore(div, paragraph);\n\t        this._plugin.getCore().selectElement(div);\n\t        paragraph.remove();\n\t      }\n\t      // const el = this._plugin.getCore().selectedElement\n\t      // const image = el.querySelector(`[data-uid=\"${uid}\"]`);\n\t\n\t      this._plugin.getCore().hideButtons();\n\t\n\t      return this.addImage(imageUrl, uid, isLoader);\n\t    }\n\t  }, {\n\t    key: 'addParagraph',\n\t    value: function addParagraph(el) {\n\t      var paragraph = document.createElement('p');\n\t      paragraph.innerHTML = '<br>';\n\t      el.insertAdjacentElement('afterend', paragraph);\n\t    }\n\t  }, {\n\t    key: 'addImage',\n\t    value: function addImage(url, uid, isLoader) {\n\t      var _this5 = this;\n\t\n\t      return new Promise(function (resolve, reject) {\n\t        var el = _this5._plugin.getCore().selectedElement,\n\t            figure = document.createElement('figure'),\n\t            img = document.createElement('img'),\n\t            descriptionContainer = document.createElement('div'),\n\t            description = document.createElement('figcaption');\n\t        var domImage = void 0;\n\t\n\t        img.alt = '';\n\t\n\t        if (uid) {\n\t          img.setAttribute('data-uid', uid);\n\t        }\n\t\n\t        descriptionContainer.classList.add(_this5.descriptionContainerClassName);\n\t        description.contentEditable = true;\n\t        description.classList.add(_this5.descriptionClassName);\n\t        description.dataset.placeholder = _this5.descriptionPlaceholder;\n\t\n\t        // If we're dealing with a preview image,\n\t        // we don't have to preload it before displaying\n\t        if (url.match(/^data:/)) {\n\t          if (!isLoader) {\n\t            el.innerHTML = '';\n\t            el.classList.remove(_this5.loadingClassName);\n\t            _this5.isLoaderShowing = false;\n\t          }\n\t\n\t          img.src = url;\n\t          figure.appendChild(img);\n\t          el.appendChild(figure);\n\t        } else {\n\t          domImage = new Image();\n\t          domImage.onload = function () {\n\t            img.src = domImage.src;\n\t            if (!isLoader) {\n\t              img.classList.add(_this5.activeClassName);\n\t            }\n\t            figure.appendChild(img);\n\t            descriptionContainer.appendChild(description);\n\t            figure.appendChild(descriptionContainer);\n\t\n\t            if (!isLoader) {\n\t              el.innerHTML = '';\n\t              el.classList.remove(_this5.loadingClassName);\n\t              _this5.isLoaderShowing = false;\n\t            }\n\t\n\t            if (isLoader) {\n\t              _this5.isLoaderShowing = true;\n\t              el.classList.add(_this5.loadingClassName);\n\t            }\n\t\n\t            el.appendChild(figure);\n\t\n\t            if ((!el.nextSibling || !el.nextSibling.nextSibling) && !isLoader) {\n\t              _this5.addParagraph(el);\n\t            }\n\t\n\t            // Resolve with domImage so we can test this function easily\n\t            resolve(domImage);\n\t          };\n\t\n\t          domImage.src = url;\n\t        }\n\t\n\t        el.classList.add(_this5.elementClassName);\n\t        el.classList.add(_this5.alignCenterClassName);\n\t\n\t        el.contentEditable = false;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'replaceImage',\n\t    value: function replaceImage(image, url) {\n\t      var domImage = new Image();\n\t      var el = this._plugin.getCore().selectedElement;\n\t\n\t      if (!el.nextSibling || !el.nextSibling.nextSibling) {\n\t        this.addParagraph(el);\n\t      }\n\t\n\t      domImage.onload = function () {\n\t        image.src = domImage.src;\n\t        image.removeAttribute('data-uid');\n\t      };\n\t\n\t      domImage.src = url;\n\t\n\t      // Return domImage so we can test this function easily\n\t      return domImage;\n\t    }\n\t  }, {\n\t    key: 'selectImage',\n\t    value: function selectImage(e) {\n\t      var el = e.target;\n\t      this.selectImageCore(el);\n\t    }\n\t  }, {\n\t    key: 'selectImageCore',\n\t    value: function selectImageCore(el) {\n\t      if (el.nodeName.toLowerCase() === 'img' && _utils2.default.getClosestWithClassName(el, this.elementClassName)) {\n\t        var parentNode = el.parentNode.parentNode;\n\t\n\t        if (!parentNode.classList.contains(this.loadingClassName)) {\n\t          el.classList.add(this.activeClassName);\n\t          // parentNode.classList.add(this.activeClassName);\n\t          // TODO: The value is correct, but the medium sometimes change\n\t          this._editor.selectElement(parentNode);\n\t          this.activeImageElement = parentNode;\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'unselectImage',\n\t    value: function unselectImage(e) {\n\t      var _this6 = this;\n\t\n\t      var el = e.target;\n\t      var clickedImage = void 0,\n\t          images = void 0;\n\t\n\t      if (el.classList.contains(this.descriptionClassName)) return false;\n\t\n\t      // Unselect all selected images. If an image is clicked, unselect all except this one.\n\t      if (el.nodeName.toLowerCase() === 'img' && el.classList.contains(this.activeClassName)) {\n\t        clickedImage = el;\n\t      }\n\t\n\t      images = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName);\n\t      Array.prototype.forEach.call(images, function (image) {\n\t        if (image !== clickedImage) {\n\t          image.classList.remove(_this6.activeClassName);\n\t        }\n\t      });\n\t      this.activeImage = null;\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t      var isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\t\n\t      // Enter key in description\n\t      if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n\t        if (isDescriptionElement) {\n\t          // Enter in description\n\t          e.preventDefault(); //Prevent default browser behavior\n\t\n\t          if (window.getSelection) {\n\t            var selection = window.getSelection();\n\t            var range = selection.getRangeAt(0);\n\t            var br = document.createElement(\"br\");\n\t            var textNode = document.createTextNode('\\xA0');\n\t            range.deleteContents();\n\t            range.insertNode(br);\n\t            range.collapse(false);\n\t            range.insertNode(textNode);\n\t            range.selectNodeContents(textNode);\n\t\n\t            selection.removeAllRanges();\n\t            selection.addRange(range);\n\t          }\n\t          return false;\n\t        }\n\t      }\n\t\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n\t        this.removeImage(e);\n\t      }\n\t\n\t      // Down\n\t      if (e.which === 40) {\n\t        // Detect selected image\n\t        var selectedImageDOM = document.querySelector('.' + this.activeClassName);\n\t        var selectedImageParentDOM = selectedImageDOM && selectedImageDOM.parentNode.parentNode;\n\t        if (selectedImageParentDOM) {\n\t          var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\t\n\t          if (!nextSiblingParagraphDOM) {\n\t            // Insert paragraph and focus\n\t            this.addParagraph(selectedImageParentDOM);\n\t          }\n\t\n\t          // Focus next paragraph\n\t          nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\t\n\t          if (nextSiblingParagraphDOM) {\n\t            if (!nextSiblingParagraphDOM.innerHTML) {\n\t              nextSiblingParagraphDOM.innerHTML = '<br>';\n\t            }\n\t            window.getSelection().removeAllRanges();\n\t            this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n\t            MediumEditor.selection.clearSelection(document, true);\n\t            selectedImageDOM.classList.remove(this.activeClassName);\n\t            e.preventDefault();\n\t          }\n\t        }\n\t      }\n\t\n\t      // Enter\n\t      if (e.which === 13) {\n\t        var _selectedImageDOM = document.querySelector('.' + this.activeClassName);\n\t        var _selectedImageParentDOM = _selectedImageDOM && _selectedImageDOM.parentNode.parentNode;\n\t        if (_selectedImageParentDOM) {\n\t          var paragraph = document.createElement('p');\n\t          paragraph.innerHTML = '<br>';\n\t          _selectedImageParentDOM.insertAdjacentElement('beforeBegin', paragraph);\n\t\n\t          window.getSelection().removeAllRanges();\n\t          this._plugin.getCore()._editor.selectElement(paragraph);\n\t          _selectedImageDOM.classList.remove(this.activeClassName);\n\t          e.preventDefault();\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'removeImage',\n\t    value: function removeImage(e) {\n\t      var _this7 = this;\n\t\n\t      var images = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName),\n\t          selection = window.getSelection();\n\t      var selectedHtml = void 0;\n\t\n\t      // Remove image even if it's not selected, but backspace/del is pressed in text\n\t      if (selection && selection.rangeCount) {\n\t        var range = MediumEditor.selection.getSelectionRange(document),\n\t            focusedElement = MediumEditor.selection.getSelectedParentElement(range),\n\t            caretPosition = MediumEditor.selection.getCaretOffsets(focusedElement).left;\n\t        var sibling = void 0;\n\t        // Is backspace pressed and caret is at the beginning of a paragraph, get previous element\n\t        if (e.which === MediumEditor.util.keyCode.BACKSPACE && caretPosition === 0) {\n\t          if (focusedElement.innerHTML === '<br>') {\n\t            // If it is a empty paragraph than not remove prev image\n\t            return false;\n\t          }\n\t          sibling = focusedElement.previousElementSibling;\n\t          // Is del pressed and caret is at the end of a paragraph, get next element\n\t        } else if (e.which === MediumEditor.util.keyCode.DELETE && caretPosition === focusedElement.innerText.length) {\n\t          sibling = focusedElement.nextElementSibling;\n\t        }\n\t\n\t        if (sibling && sibling.classList.contains('medium-editor-insert-images')) {\n\t          var newImages = sibling.getElementsByTagName('img');\n\t          Array.prototype.forEach.call(newImages, function (image) {\n\t            images.push(image);\n\t          });\n\t        }\n\t\n\t        // If text is selected, find images in the selection\n\t        selectedHtml = MediumEditor.selection.getSelectionHtml(document);\n\t        if (selectedHtml) {\n\t          var temp = document.createElement('div');\n\t          var wrappers = void 0,\n\t              _newImages = void 0;\n\t          temp.innerHTML = selectedHtml;\n\t\n\t          wrappers = temp.getElementsByClassName('medium-editor-insert-images');\n\t          _newImages = _utils2.default.getElementsByTagName(wrappers, 'img');\n\t\n\t          Array.prototype.forEach.call(_newImages, function (image) {\n\t            images.push(image);\n\t          });\n\t        }\n\t      }\n\t\n\t      if (images.length) {\n\t        if (!selectedHtml) {\n\t          e.preventDefault();\n\t        }\n\t\n\t        images.forEach(function (image) {\n\t          var wrapper = _utils2.default.getClosestWithClassName(image, 'medium-editor-insert-images');\n\t          _this7.deleteFile(image.src);\n\t\n\t          image.parentNode.remove();\n\t\n\t          // If wrapper has no images anymore, remove it\n\t          if (wrapper.childElementCount === 0) {\n\t            var next = wrapper.nextElementSibling,\n\t                prev = wrapper.previousElementSibling;\n\t\n\t            wrapper.remove();\n\t\n\t            // If there is no selection, move cursor at the beginning of next paragraph (if delete is pressed),\n\t            // or nove it at the end of previous paragraph (if backspace is pressed)\n\t            if (!selectedHtml) {\n\t              if (next || prev) {\n\t                if (next && e.which === MediumEditor.util.keyCode.DELETE || !prev) {\n\t                  MediumEditor.selection.moveCursor(document, next, 0);\n\t                } else {\n\t                  MediumEditor.selection.moveCursor(document, prev.lastChild, prev.lastChild.textContent.length);\n\t                }\n\t              }\n\t            }\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'deleteFile',\n\t    value: function deleteFile(image) {\n\t      if (this.options.deleteUrl) {\n\t        var xhr = new XMLHttpRequest(),\n\t            data = Object.assign({}, {\n\t          file: image\n\t        }, this.options.deleteData);\n\t\n\t        xhr.open(this.options.deleteMethod, this.options.deleteUrl, true);\n\t        xhr.send(data);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {}\n\t  }]);\n\t\n\t  return Images;\n\t}();\n\t\n\texports.default = Images;\n\tmodule.exports = exports['default'];\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _utils = __webpack_require__(1);\n\t\n\tvar _utils2 = _interopRequireDefault(_utils);\n\t\n\tvar _Toolbar = __webpack_require__(2);\n\t\n\tvar _Toolbar2 = _interopRequireDefault(_Toolbar);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar PayWall = function () {\n\t  function PayWall(plugin, options) {\n\t    _classCallCheck(this, PayWall);\n\t\n\t    this.options = {\n\t      label: '<span class=\"fa fa-scissors\"></span>',\n\t      captions: true,\n\t      storeMeta: false,\n\t      styles: {\n\t        left: {\n\t          label: '<span class=\"fa fa-align-left\"></span>'\n\t        },\n\t        wide: {\n\t          label: '<span class=\"fa fa-align-justify\"></span>'\n\t        }\n\t      },\n\t      actions: {\n\t        remove: {\n\t          label: '<span class=\"fa fa-times\"></span>',\n\t          clicked: function clicked() {\n\t            // var $event = $.Event('keydown');\n\t\n\t            // $event.which = 8;\n\t            // $(document).trigger($event);\n\t          }\n\t        }\n\t      },\n\t      parseOnPaste: false\n\t    };\n\t\n\t    Object.assign(this.options, options);\n\t\n\t    this._plugin = plugin;\n\t    this._editor = this._plugin.base;\n\t\n\t    this.activeClassName = 'medium-editor-insert-embed-paywall-active';\n\t    this.elementClassName = 'medium-editor-insert-embed-paywall';\n\t\n\t    this.alignLeftClassName = 'align-left';\n\t    this.alignCenterClassName = 'align-center-wide';\n\t\n\t    this.label = this.options.label;\n\t    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\t\n\t    this.events();\n\t  }\n\t\n\t  _createClass(PayWall, [{\n\t    key: 'events',\n\t    value: function events() {\n\t      var _this = this;\n\t\n\t      this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n\t      this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\t\n\t      this._plugin.getEditorElements().forEach(function (editor) {\n\t        _this._plugin.on(editor, 'click', _this.selectEmbed.bind(_this));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'selectEmbed',\n\t    value: function selectEmbed(e) {\n\t      var el = e.target;\n\t      if (this.getClosestElementByClassName(el, this.elementClassName)) {\n\t        this.selectEmbedCore(el, event);\n\t        e && e.stopPropagation();\n\t        e && e.preventDefault();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getClosestElementByClassName',\n\t    value: function getClosestElementByClassName(el, className) {\n\t      while (el) {\n\t        if (el.classList && el.classList.contains(className)) return el;\n\t        el = el.parentNode;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'selectEmbedCore',\n\t    value: function selectEmbedCore(el) {\n\t      var element = this.getClosestElementByClassName(el, this.elementClassName);\n\t      element.classList.add(this.activeClassName);\n\t      var currentSelection = window.getSelection();\n\t    }\n\t  }, {\n\t    key: 'unselectEmbed',\n\t    value: function unselectEmbed(e) {\n\t      var el = e.target;\n\t      this.unselectEmbedCore(el);\n\t    }\n\t  }, {\n\t    key: 'unselectEmbedCore',\n\t    value: function unselectEmbedCore(el) {\n\t      var _this2 = this;\n\t\n\t      var clickedEmbed = void 0,\n\t          clickedEmbedPlaceholder = void 0,\n\t          paywall = void 0,\n\t          embedsPlaceholders = void 0;\n\t\n\t      paywall = _utils2.default.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\t      if (!paywall || !paywall.length) {\n\t        return false;\n\t      }\n\t\n\t      if (paywall) {\n\t        Array.prototype.forEach.call(paywall, function (paywall) {\n\t          if (paywall !== clickedEmbed) {\n\t            paywall.classList.remove(_this2.activeClassName);\n\t          }\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'getSiblingParagraph',\n\t    value: function getSiblingParagraph(el) {\n\t      if (!el) return false;\n\t\n\t      var nextSiblingDOM = el.nextSibling;\n\t      var nextSiblingParagraphDOM = void 0;\n\t\n\t      while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n\t        if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n\t          nextSiblingParagraphDOM = nextSiblingDOM;\n\t        } else {\n\t          nextSiblingDOM = nextSiblingDOM.nextSibling;\n\t        }\n\t      }\n\t\n\t      return nextSiblingParagraphDOM;\n\t    }\n\t  }, {\n\t    key: 'handleKey',\n\t    value: function handleKey(e) {\n\t      var target = e.target;\n\t\n\t      // Backspace, delete\n\t      if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1) {\n\t        this.removeEmbed(e);\n\t      } else if (document.querySelector('.' + this.activeClassName)) {\n\t        // Block all keys\n\t        e.preventDefault();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setFocusOnElement',\n\t    value: function setFocusOnElement(el) {\n\t      // this._editor.elements[0].focus();\n\t      setTimeout(function () {\n\t        var currentSelection = window.getSelection();\n\t        var range = document.createRange();\n\t        range.setStart(el, 0);\n\t        currentSelection.removeAllRanges();\n\t        currentSelection.addRange(range);\n\t      }, 300);\n\t    }\n\t  }, {\n\t    key: 'handleClick',\n\t    value: function handleClick() {\n\t      this.el = this._plugin.getCore().selectedElement;\n\t      this.setFocusOnElement(this.el);\n\t      this.embedPaywall(this.el);\n\t    }\n\t  }, {\n\t    key: 'removeEmbed',\n\t    value: function removeEmbed(e) {\n\t      var selectedEmbedDOM = document.querySelector('.' + this.activeClassName);\n\t      if (selectedEmbedDOM) {\n\t        selectedEmbedDOM.remove();\n\t        e.preventDefault();\n\t        e.stopPropagation();\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Init Toolbar for tuning paywall position\n\t     *\n\t     * @param {string} url\n\t     * @param {pasted} boolean\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'initToolbar',\n\t    value: function initToolbar() {}\n\t  }, {\n\t    key: 'changeAlign',\n\t    value: function changeAlign(className, action, evt) {\n\t      if (evt) {\n\t        evt.preventDefault();\n\t        evt.stopPropagation();\n\t      }\n\t\n\t      var el = document.querySelector('.' + this.activeClassName);\n\t      el.classList.remove(this.alignLeftClassName, this.alignCenterClassName);\n\t      el.classList.add(className);\n\t\n\t      this.toolbar.setToolbarPosition();\n\t\n\t      if (this.options.onChange) {\n\t        this.options.onChange(action);\n\t      }\n\t    }\n\t\n\t    /**\n\t     * Add html to page\n\t     *\n\t     * @param {string} html\n\t     * @param {string} pastedUrl\n\t     * @return {void}\n\t     */\n\t\n\t  }, {\n\t    key: 'embedPaywall',\n\t    value: function embedPaywall(el) {\n\t      // Remove old paywall\n\t      var prevPaywallDOM = document.querySelector('.' + this.elementClassName);\n\t      if (prevPaywallDOM) {\n\t        prevPaywallDOM.remove();\n\t      }\n\t\n\t      // Insert new paywall\n\t      var paywall = document.createElement('div');\n\t      paywall.setAttribute(\"contenteditable\", false);\n\t      paywall.innerHTML = '<div></div>';\n\t      paywall.classList.add(this.elementClassName);\n\t\n\t      el.replaceWith(paywall);\n\t\n\t      var selectedEmbedDOM = document.querySelector('.' + this.elementClassName);\n\t\n\t      if (selectedEmbedDOM) {\n\t        var nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\t\n\t        if (!nextSiblingParagraphDOM) {\n\t          // Insert paragraph and focus\n\t          var paragraph = document.createElement('p');\n\t          paragraph.innerHTML = '<br>';\n\t          selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n\t        }\n\t      }\n\t\n\t      this.options.onInsert && this.options.onInsert();\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'destroy',\n\t    value: function destroy() {\n\t      this.cancelEmbed();\n\t    }\n\t  }]);\n\t\n\t  return PayWall;\n\t}();\n\t\n\texports.default = PayWall;\n\tmodule.exports = exports['default'];\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// medium-editor-insert.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d91b91cba537fb3f4b23","import Core from './Core';\n\nconst MediumEditorInsert = MediumEditor.Extension.extend({\n  name: 'insert',\n\n  addons: {\n    images: true,\n    embeds: true,\n    chapters: true,\n    paywall: true,\n  },\n\n  _initializedAddons: {},\n\n  init: function() {\n    MediumEditor.Extension.prototype.init.apply(this, arguments);\n\n    this.core = new Core(this);\n  },\n\n  destroy: function() {\n    this.core.removeButtons();\n  },\n\n  getCore: function() {\n    return this.core;\n  },\n\n  getAddons: function() {\n    return this._initializedAddons;\n  },\n\n  getAddon: function(name) {\n    return this._initializedAddons[name];\n  }\n});\n\nexport default MediumEditorInsert;\n\n\n// WEBPACK FOOTER //\n// ./src/js/Plugin.js","const utils = {\n  ucfirst: (str) => {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  },\n\n  generateRandomString: (length = 15) => {\n    return Math.random().toString(36).substr(2, length);\n  },\n\n  getClosestWithClassName: (el, className) => {\n    return MediumEditor.util.traverseUp(el, (element) => {\n      return element.classList.contains(className);\n    });\n  },\n\n  isChildOf: (el, parent) => {\n    return MediumEditor.util.traverseUp(el, (element) => {\n      return element === parent;\n    }) ? true : false;\n  },\n\n  getElementsByClassName: (parents, className) => {\n    const results = [];\n\n    Array.prototype.forEach.call(parents, (editor) => {\n      const elements = editor.getElementsByClassName(className);\n\n      Array.prototype.forEach.call(elements, (element) => {\n        results.push(element);\n      });\n    });\n\n    return results;\n  },\n\n  getElementsByTagName: (parents, tagName) => {\n    const results = [];\n\n    Array.prototype.forEach.call(parents, (editor) => {\n      const elements = editor.getElementsByTagName(tagName);\n\n      Array.prototype.forEach.call(elements, (element) => {\n        results.push(element);\n      });\n    });\n\n    return results;\n  }\n};\n\nexport default utils;\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils.js","import utils from './utils';\nimport ToolbarButton from './ToolbarButton';\n\nconst MediumEditorToolbar = MediumEditor.extensions.toolbar;\n\nexport default class Toolbar extends MediumEditorToolbar {\n\n  constructor(options) {\n    super(options);\n\n    this.name = `${options.type}Toolbar`;\n\n    options.buttons.forEach((buttonOptions) => {\n      const button = new ToolbarButton(Object.assign({}, {\n        window: this.plugin.window,\n        document: this.plugin.document,\n        base: this.plugin.base\n      }, buttonOptions));\n\n      button.init();\n      this.plugin.base.extensions.push(button);\n    });\n\n    this.window = options.plugin.window;\n    this.document = options.plugin.document;\n    this.base = options.plugin.base;\n\n    this.init();\n  }\n\n  createToolbar() {\n    const toolbar = this.document.createElement('div');\n\n    toolbar.id = `medium-editor-insert-${this.type}-toolbar-${this.getEditorId()}`;\n    toolbar.className = 'medium-editor-toolbar';\n\n    if (this.static) {\n      toolbar.className += ' static-toolbar';\n    } else if (this.relativeContainer) {\n      toolbar.className += ' medium-editor-relative-toolbar';\n    } else {\n      toolbar.className += ' medium-editor-stalker-toolbar';\n    }\n\n    toolbar.appendChild(this.createToolbarButtons());\n\n    // Add any forms that extensions may have\n    this.forEachExtension((extension) => {\n      if (extension.hasForm) {\n        toolbar.appendChild(extension.getForm());\n      }\n    });\n\n    this.attachEventHandlers();\n\n    return toolbar;\n  }\n\n  createToolbarButtons() {\n    const ul = this.document.createElement('ul');\n    let li,\n      btn,\n      buttons,\n      extension,\n      buttonName,\n      buttonOpts;\n\n    ul.id = `medium-editor-insert-${this.type}-toolbar-actions${this.getEditorId()}`;\n    ul.className = 'medium-editor-toolbar-actions';\n    ul.style.display = 'block';\n\n    this.buttons.forEach((button) => {\n      if (typeof button === 'string') {\n        buttonName = button;\n        buttonOpts = null;\n      } else {\n        buttonName = button.name;\n        buttonOpts = button;\n      }\n\n      // If the button already exists as an extension, it'll be returned\n      // othwerise it'll create the default built-in button\n      extension = this.base.addBuiltInExtension(buttonName, buttonOpts);\n\n      if (extension && typeof extension.getButton === 'function') {\n        btn = extension.getButton(this.base);\n        li = this.document.createElement('li');\n        if (MediumEditor.util.isElement(btn)) {\n          li.appendChild(btn);\n        } else {\n          li.innerHTML = btn;\n        }\n        ul.appendChild(li);\n      }\n    }, this);\n\n    buttons = ul.querySelectorAll('button');\n    if (buttons.length > 0) {\n      buttons[0].classList.add(this.firstButtonClass);\n      buttons[buttons.length - 1].classList.add(this.lastButtonClass);\n    }\n\n    return ul;\n  }\n\n  checkState() {\n    let activeElements;\n\n    if (this.base.preventSelectionUpdates) {\n      return;\n    }\n\n    // Wait for elements to be selected\n    setTimeout(() => {\n      activeElements = utils.getElementsByClassName(this.getEditorElements(), this.activeClassName);\n\n      // Hide toolbar when no elements are selected\n      if (activeElements.length === 0) {\n        return this.hideToolbar();\n      }\n\n      // Now we know there's a focused editable with a selection\n      this.showAndUpdateToolbar();\n    }, 10);\n  }\n\n  setToolbarPosition() {\n    const container = utils.getElementsByClassName(this.getEditorElements(), this.activeClassName)[0];\n    let anchorPreview;\n\n    // If there isn't a valid selection, bail\n    if (!container) {\n      return this;\n    }\n\n    this.showToolbar();\n    this.positionStaticToolbar(container);\n\n    anchorPreview = this.base.getExtensionByName('anchor-preview');\n\n    if (anchorPreview && typeof anchorPreview.hidePreview === 'function') {\n      anchorPreview.hidePreview();\n    }\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/Toolbar.js","import utils from './utils';\nimport Images from './addons/Images';\nimport Embeds from './addons/Embeds';\nimport Chapters from './addons/Chapters';\nimport PayWall from './addons/PayWall';\n\nexport default class Core {\n\n  constructor(plugin) {\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n\n    this.initAddons();\n    this.addButtons();\n    this.events();\n  }\n\n  events() {\n    let addonActions;\n\n    // This could be chained when medium-editor 5.15.2 is released\n    // https://github.com/yabwe/medium-editor/pull/1046\n    this._plugin.on(document, 'click', this.toggleButtons.bind(this));\n    this._plugin.on(document, 'keyup', this.toggleButtons.bind(this));\n    this._plugin.on(this.buttons.getElementsByClassName('medium-editor-insert-buttons-show')[0], 'click', this.toggleAddons.bind(this));\n\n    // This could be written in one statement when medium-editor 5.15.2 is released\n    // https://github.com/yabwe/medium-editor/pull/1046\n    addonActions = this.buttons.getElementsByClassName('medium-editor-insert-action');\n    Array.prototype.forEach.call(addonActions, (action) => {\n      // this._plugin.on(action, 'mousedown', this.handleAddonMouseDown.bind(this));\n      this._plugin.on(action, 'click', this.handleAddonClick.bind(this));\n    });\n\n    this._plugin.on(window, 'resize', this.positionButtons.bind(this));\n  }\n\n  initAddons() {\n    // Initialize all default addons, we'll delete ones we don't need later\n    this._plugin._initializedAddons = {\n      images: new Images(this._plugin, this._plugin.addons.images),\n      embeds: new Embeds(this._plugin, this._plugin.addons.embeds),\n      chapters: new Chapters(this._plugin, this._plugin.addons.chapters),\n      paywall: new PayWall(this._plugin, this._plugin.addons.paywall),\n    };\n\n    Object.keys(this._plugin.addons).forEach((name) => {\n      const addonOptions = this._plugin.addons[name];\n\n      // If the addon is custom one\n      if (!this._plugin._initializedAddons[name]) {\n        if (typeof addonOptions === 'function') {\n          this._plugin._initializedAddons[name] = new addonOptions(this._plugin);\n        } else {\n          window.console.error(`I don't know how to initialize custom \"${name}\" addon!`);\n        }\n      }\n\n      // Delete disabled addon\n      if (!addonOptions) {\n        delete this._plugin._initializedAddons[name];\n      }\n    });\n  }\n\n  addButtons() {\n    const addons = this._plugin.getAddons();\n    let html;\n\n    this.buttons = document.createElement('div');\n    this.buttons.id = `medium-editor-insert-${this._plugin.getEditorId()}`;\n    this.buttons.classList.add('medium-editor-insert-buttons');\n    this.buttons.setAttribute('contentediable', false);\n\n    html = `<a class=\"medium-editor-insert-buttons-show\">+</a>\n            <ul class=\"medium-editor-insert-buttons-addons\">`;\n\n    Object.keys(addons).forEach((name) => {\n      const addon = addons[name];\n\n      html += `<li><a class=\"medium-editor-insert-action\" data-addon=\"${name}\">${addon.label}</a></li>`;\n    });\n\n    html += `</ul>`;\n\n    this.buttons.innerHTML = html;\n\n    document.body.appendChild(this.buttons);\n  }\n\n  removeButtons() {\n    this.buttons.remove();\n  }\n\n  positionButtons() {\n    let el, elPosition, addons, addonButton, addonsStyle, addonButtonStyle, position;\n\n    // Don't position buttons if they aren't active\n    if (this.buttons.classList.contains('medium-editor-insert-buttons-active') === false) {\n      return;\n    }\n\n    el = this._editor.getSelectedParentElement();\n    elPosition = el.getBoundingClientRect();\n    addons = this.buttons.getElementsByClassName('medium-editor-insert-buttons-addons')[0];\n    addonButton = this.buttons.getElementsByClassName('medium-editor-insert-action')[0];\n    addonsStyle = window.getComputedStyle(addons);\n    addonButtonStyle = window.getComputedStyle(addonButton);\n\n    // Calculate position\n    position = {\n      top: window.scrollY + elPosition.top,\n      left: window.scrollX + elPosition.left - parseInt(addonsStyle.left, 10) - parseInt(addonButtonStyle.marginLeft, 10)\n    };\n\n    // If left position is lower than 0, the buttons would be out of the viewport.\n    // In that case, align buttons with the editor\n    position.left = position.left < 0 ? elPosition.left : position.left;\n\n    this.buttons.style.left = `${position.left}px`;\n    this.buttons.style.top = `${position.top}px`;\n  }\n\n  toggleButtons() {\n    const el = this._editor.getSelectedParentElement();\n\n    if (this.shouldDisplayButtonsOnElement(el)) {\n      this.selectElement(el);\n      this.showButtons();\n    } else {\n      this.hideButtons();\n    }\n  }\n\n  shouldDisplayButtonsOnElement(el) {\n    const addons = this._plugin.getAddons(),\n      addonClassNames = [];\n    let isAddon = false,\n      belongsToEditor = false;\n\n    // Don't show buttons when the element has text\n    if (el.innerText.trim() !== '') {\n      return false;\n    }\n\n    // Don't show buttons when the editor doesn't belong to editor\n    this._plugin.getEditorElements().forEach((editor) => {\n      if (utils.isChildOf(el, editor)) {\n        belongsToEditor = true;\n        return;\n      }\n    });\n\n    if (!belongsToEditor) {\n      return false;\n    }\n\n    // Get class names used by addons\n    Object.keys(addons).forEach((addonName) => {\n      const addon = addons[addonName];\n      if (addon.elementClassName) {\n        addonClassNames.push(addon.elementClassName);\n      }\n    });\n\n    // Don't show buttons if the element is an addon element\n    // - when the element has an addon class, or some of its parents have it\n    addonClassNames.forEach((className) => {\n      if (el.classList.contains(className) || utils.getClosestWithClassName(el, className)) {\n        isAddon = true;\n        return;\n      }\n    });\n\n    return !isAddon;\n  }\n\n  selectElement(el) {\n    this.selectedElement = el;\n  }\n\n  showButtons() {\n    this.buttons.classList.add('medium-editor-insert-buttons-active');\n    this.positionButtons();\n  }\n\n  hideButtons() {\n    this.buttons.classList.remove('medium-editor-insert-buttons-active');\n    this.buttons.classList.remove('medium-editor-insert-addons-active');\n  }\n\n  toggleAddons() {\n    this.buttons.classList.toggle('medium-editor-insert-addons-active');\n  }\n\n  // handleAddonMouseDown(e) {\n  //     const name = e.currentTarget.getAttribute('data-addon');\n  //     e.preventDefault();\n\n  //     console.log(this._plugin.getAddon(name));\n  //     this._plugin.getAddon(name).handleMouseDown(e);\n  // }\n\n  handleAddonClick(e) {\n    const name = e.currentTarget.getAttribute('data-addon');\n    e.preventDefault();\n\n    this._plugin.getAddon(name).handleClick(e);\n    this.hideButtons();\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/Core.js","const ToolbarButton = MediumEditor.extensions.button.extend({\n  init: function() {\n    this.button = this.document.createElement('button');\n    this.button.classList.add('medium-editor-action');\n    this.button.classList.add(this.className);\n    this.button.innerHTML = `<b>${this.label}</b>`;\n\n    this.on(this.button, 'click', this.handleClick.bind(this));\n  },\n\n  getButton: function() {\n    return this.button;\n  },\n\n  handleClick: function(evt) {\n    this.onClick(evt);\n  }\n});\n\nexport default ToolbarButton;\n\n\n// WEBPACK FOOTER //\n// ./src/js/ToolbarButton.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class Chapters {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-bars\"></span>',\n      captions: true,\n      storeMeta: false,\n      styles: {\n        left: {\n          label: '<span class=\"fa fa-align-left\"></span>'\n        },\n        wide: {\n          label: '<span class=\"fa fa-align-justify\"></span>'\n        },\n      },\n      actions: {\n        remove: {\n          label: '<span class=\"fa fa-times\"></span>',\n          clicked: function() {\n            // var $event = $.Event('keydown');\n\n            // $event.which = 8;\n            // $(document).trigger($event);\n          }\n        }\n      },\n      parseOnPaste: false,\n    };\n\n    Object.assign(this.options, options);\n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n\n    this.activeClassName = 'medium-editor-insert-embed-chapters-active';\n    this.elementClassName = 'medium-editor-insert-embed-chapters';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignCenterClassName = 'align-center-wide';\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\n    this.initToolbar();\n    this.events();\n\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectEmbed.bind(this));\n    });\n  }\n\n  selectEmbed(e) {\n    const el = e.target;\n    if (this.getClosestElementByClassName(el, this.elementClassName)) {\n      this.selectEmbedCore(el, event);\n      e && e.stopPropagation();\n      e && e.preventDefault();\n    }\n  }\n\n  getClosestElementByClassName(el, className) {\n    while (el) {\n      if (el.classList && el.classList.contains(className)) return el;\n      el = el.parentNode;\n    }\n  }\n\n\n  selectEmbedCore(el) {\n    const element = this.getClosestElementByClassName(el, this.elementClassName);\n    element.classList.add(this.activeClassName);\n    const currentSelection = window.getSelection();\n  }\n\n  unselectEmbed(e) {\n    const el = e.target;\n    this.unselectEmbedCore(el);\n  }\n\n  unselectEmbedCore(el) {\n    let clickedEmbed, clickedEmbedPlaceholder, chapters, embedsPlaceholders;\n\n    chapters = utils.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n    if (!chapters || !chapters.length) {\n      return false;\n    }\n\n    if (chapters) {\n      Array.prototype.forEach.call(chapters, (chapters) => {\n        if (chapters !== clickedEmbed) {\n          chapters.classList.remove(this.activeClassName);\n        }\n      });\n    }\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n\n\n    // Enter key\n    if (e.which === 40 || e.which === 13) {\n      // Detect selected chapters\n      const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n\n      if (selectedEmbedDOM) {\n        let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (!nextSiblingParagraphDOM) {\n          // Insert paragraph and focus\n          const paragraph = document.createElement('p');\n          paragraph.innerHTML = '<br>';\n          selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n        }\n\n        // Focus next paragraph\n        nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (nextSiblingParagraphDOM) {\n          if (!nextSiblingParagraphDOM.innerHTML) {\n            nextSiblingParagraphDOM.innerHTML = '<br>';\n          }\n          window.getSelection().removeAllRanges();\n          this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n          selectedEmbedDOM.classList.remove(this.activeClassName);\n          MediumEditor.selection.clearSelection(document, true);\n          selectedEmbedDOM.classList.remove(this.activeClassName);\n          e.preventDefault();\n        }\n      }\n    }\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1) {\n      this.removeEmbed(e);\n    } else if (document.querySelector(`.${this.activeClassName}`)) {\n      // Block all keys\n      e.preventDefault();\n    }\n  }\n\n  setFocusOnElement(el) {\n    // this._editor.elements[0].focus();\n    setTimeout(() => {\n      const currentSelection = window.getSelection();\n      const range = document.createRange();\n      range.setStart(el, 0);\n      currentSelection.removeAllRanges();\n      currentSelection.addRange(range);\n    }, 300);\n  }\n\n  handleClick() {\n    this.el = this._plugin.getCore().selectedElement;\n    this.setFocusOnElement(this.el);\n    this.embedChapter(this.el);\n  }\n\n  removeEmbed(e) {\n    const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n    if (selectedEmbedDOM) {\n      selectedEmbedDOM.remove();\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Init Toolbar for tuning chapters position\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n  initToolbar() {\n    this.toolbar = new Toolbar({\n      plugin: this._plugin,\n      type: 'chapters',\n      activeClassName: this.activeClassName,\n      buttons: [{\n          name: 'chapters-align-left',\n          action: 'align-left',\n          className: 'btn-align-left',\n          label: 'Left',\n          onClick: (function(evt) {\n            this.changeAlign(this.alignLeftClassName, 'chapters-align-left', evt);\n          }).bind(this),\n        },\n        {\n          name: 'chapters-align-center-wide',\n          action: 'align-center-wide',\n          className: 'btn-align-center-wide',\n          label: 'Center',\n          onClick: (function(evt) {\n            this.changeAlign(this.alignCenterClassName, 'chapters-align-center', evt);\n          }).bind(this),\n        },\n      ]\n    });\n\n    this._editor.extensions.push(this.toolbar);\n  }\n\n  changeAlign(className, action, evt) {\n    if (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n    }\n\n    const el = document.querySelector(`.${this.activeClassName}`);\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignCenterClassName,\n    );\n    el.classList.add(className);\n\n    this.toolbar.setToolbarPosition();\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n\n  }\n\n  /**\n   * Add html to page\n   *\n   * @param {string} html\n   * @param {string} pastedUrl\n   * @return {void}\n   */\n\n  embedChapter(el) {\n    const chapter = document.createElement('div');\n    chapter.classList.add(this.elementClassName);\n\n    let contentHTML;\n    if (this.options.contentHTML) {\n      if (typeof this.options.contentHTML === 'function') {\n        contentHTML = this.options.contentHTML();\n      } else {\n        contentHTML = this.options.contentHTML;\n      }\n    }\n\n    if (contentHTML) {\n      chapter.innerHTML = contentHTML;\n      el.replaceWith(chapter);\n\n      this.options.onInsert && this.options.onInsert();\n    }\n\n    return true;\n  }\n\n\n  destroy() {\n    this.cancelEmbed();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/Chapters.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class Embeds {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-youtube-play\"></span>',\n      placeholder: 'Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter',\n      oembedProxy: 'http://medium.iframe.ly/api/oembed?omit_script=1&iframe=1',\n      captions: true,\n      captionPlaceholder: 'Type caption (optional)',\n      storeMeta: false,\n      styles: {\n        wide: {\n          label: '<span class=\"fa fa-align-justify\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        },\n        left: {\n          label: '<span class=\"fa fa-align-left\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        },\n        right: {\n          label: '<span class=\"fa fa-align-right\"></span>'\n          // added: function ($el) {},\n          // removed: function ($el) {}\n        }\n      },\n      actions: {\n        remove: {\n          label: '<span class=\"fa fa-times\"></span>',\n          clicked: function() {\n            // var $event = $.Event('keydown');\n\n            // $event.which = 8;\n            // $(document).trigger($event);\n          }\n        }\n      },\n      parseOnPaste: false,\n      onChange: (action) => {\n        console.log('Embed change: ', action);\n      },\n    };\n\n    Object.assign(this.options, options);\n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n\n    this.activeClassName = 'medium-editor-insert-embeds-active';\n    this.placeholderClassName = 'medium-editor-insert-embeds-placeholder';\n    this.elementClassName = 'medium-editor-insert-embeds';\n    this.loadingClassName = 'medium-editor-insert-embeds-loading';\n    this.activeClassName = 'medium-editor-insert-embed-active';\n    this.descriptionContainerClassName = 'medium-editor-embed-embed-description-container';\n    this.descriptionClassName = 'medium-editor-embed-embed-description';\n    this.overlayClassName = 'medium-editor-insert-embeds-overlay';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignRightClassName = 'align-right';\n    this.alignCenterClassName = 'align-center';\n    this.alignCenterWideClassName = 'align-center-wide';\n    this.alignCenterFullClassName = 'align-center-full';\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\n    this.initToolbar();\n    this.events();\n\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectEmbed.bind(this));\n    });\n  }\n\n\n  selectEmbed(e) {\n    const el = e.target;\n    this.selectEmbedCore(el);\n  }\n\n  selectEmbedCore(el) {\n    if (el.classList.contains(this.overlayClassName)) {\n      const selectedEl = utils.getClosestWithClassName(el, this.elementClassName);\n      if (!selectedEl.classList.contains(this.loadingClassName)) {\n        selectedEl.classList.add(this.activeClassName);\n        this._editor.selectElement(selectedEl);\n        this.activeEmbedElement = selectedEl;\n      }\n    }\n  }\n\n  unselectEmbed(e) {\n    const el = e.target;\n    this.unselectEmbedCore(el);\n  }\n\n  unselectEmbedCore(el) {\n    let clickedEmbed, clickedEmbedPlaceholder, embeds, embedsPlaceholders;\n\n    if (el.classList.contains(this.descriptionClassName)) return false;\n\n    embeds = utils.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n\n    if (!embeds || !embeds.length) {\n      return false;\n    }\n\n    // Unselect all selected images. If an image is clicked, unselect all except this one.\n    if (el.classList.contains(this.overlayClassName)) {\n      clickedEmbed = utils.getClosestWithClassName(el, this.elementClassName);\n    }\n\n    if (embeds) {\n      Array.prototype.forEach.call(embeds, (embed) => {\n        if (embed !== clickedEmbed) {\n          embed.classList.remove(this.activeClassName);\n        }\n      });\n    }\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n    const isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\n    // Enter key in description\n    if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n      if (isDescriptionElement) {\n        e.preventDefault();\n      }\n    }\n\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n      this.removeEmbed(e);\n    }\n\n    // Down\n    if (e.which === 40) {\n      // Detect selected image\n      const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n\n      if (selectedEmbedDOM) {\n        let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (!nextSiblingParagraphDOM) {\n          // Insert paragraph and focus\n          const paragraph = document.createElement('p');\n          paragraph.innerHTML = '<br>';\n          selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n        }\n\n        // Focus next paragraph\n        nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n        if (nextSiblingParagraphDOM) {\n          if (!nextSiblingParagraphDOM.innerHTML) {\n            nextSiblingParagraphDOM.innerHTML = '<br>';\n          }\n          window.getSelection().removeAllRanges();\n          this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n          selectedEmbedDOM.classList.remove(this.activeClassName);\n          MediumEditor.selection.clearSelection(document, true);\n          e.preventDefault();\n        }\n      }\n    }\n\n    // Enter\n    if (e.which === 13) {\n        const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n\n        if (selectedEmbedDOM) {\n            const paragraph = document.createElement('p');\n            paragraph.innerHTML = '<br>';\n            selectedEmbedDOM.insertAdjacentElement('beforeBegin', paragraph);\n            window.getSelection().removeAllRanges();\n            this._plugin.getCore()._editor.selectElement(paragraph);\n            selectedEmbedDOM.classList.remove(this.activeClassName);\n            e.preventDefault();\n        }\n    }\n  }\n\n  setFocusOnElement(el) {\n    // this._editor.elements[0].focus();\n    setTimeout(() => {\n      const currentSelection = window.getSelection();\n      const range = document.createRange();\n      range.setStart(el, 0);\n      currentSelection.removeAllRanges();\n      currentSelection.addRange(range);\n    }, 300);\n  }\n\n  handleClick() {\n    this.el = this._plugin.getCore().selectedElement;\n    this.el.classList.add(this.loadingClassName);\n    this.el.classList.add(this.placeholderClassName);\n    this.el.setAttribute('data-placeholder', this.options.placeholder);\n\n    this.instanceHandlePaste = this.handlePaste.bind(this);\n    this.instanceHandleKeyDown = this.handleKeyDown.bind(this);\n\n    this._plugin.on(document, 'paste', this.instanceHandlePaste);\n    this._plugin.on(document, 'keydown', this.instanceHandleKeyDown);\n\n    // FIXME: it doesn't work yet.  :(\n    this._plugin.on(this.el, 'blur', this.handleBlur.bind(this));\n\n    this.setFocusOnElement(this.el);\n  }\n\n  handleKeyDown(evt) {\n    if (evt.which !== 17 && evt.which !== 91 && evt.which !== 224 // Cmd or Ctrl pressed (user probably preparing to paste url via hot keys)\n      &&\n      (evt.which === 27 || this._plugin.selectedElement !== this.el)\n    ) {\n      // Escape\n      this.cancelEmbed();\n      return false;\n    }\n    return true;\n  }\n\n  handlePaste(evt) {\n    const pastedUrl = evt.clipboardData.getData('text');\n    const linkRegEx = new RegExp('^(http(s?):)?\\/\\/', 'i');\n    const linkRegEx2 = new RegExp('^(www\\.)?', 'i');\n\n    if (linkRegEx.test(pastedUrl) || linkRegEx2.test(pastedUrl)) {\n      const html = (this.options.oembedProxy) ? this.oembed(pastedUrl, true) : this.parseUrl(pastedUrl, true);\n    }\n\n    this.cancelEmbed();\n  }\n\n\n  removeEmbed(e) {\n    const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n    if (selectedEmbedDOM) {\n      selectedEmbedDOM.remove();\n    }\n  }\n\n  /**\n   * Init Toolbar for tuning embed position\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n  initToolbar() {\n    this.toolbar = new Toolbar({\n      plugin: this._plugin,\n      type: 'embeds',\n      activeClassName: this.activeClassName,\n      buttons: [{\n        name: 'embed-align-left',\n        action: 'align-left',\n        className: 'btn-align-left',\n        label: 'Left',\n        onClick: (function(evt) {\n          this.changeAlign(this.alignLeftClassName, 'embed-align-left', evt);\n        }).bind(this),\n      }, {\n        name: 'embed-align-center',\n        action: 'align-center',\n        className: 'btn-align-center',\n        label: 'Center',\n        onClick: (function(evt) {\n          this.changeAlign(this.alignCenterClassName, 'embed-align-center', evt);\n        }).bind(this),\n      }, {\n        name: 'embed-align-center-wide',\n        action: 'align-center-wide',\n        className: 'btn-align-center-wide',\n        label: 'Wide',\n        onClick: (function(evt) {\n          this.changeAlign(this.alignCenterWideClassName, 'embed-align-center-wide', evt);\n        }).bind(this),\n      }, {\n        name: 'embed-align-center-full',\n        action: 'align-center-full',\n        className: 'btn-align-center-full',\n        label: 'Full',\n        onClick: (function(evt) {\n          this.changeAlign(this.alignCenterFullClassName, 'embed-align-center-full', evt);\n        }).bind(this),\n      }, {\n        name: 'embed-align-right',\n        action: 'align-right',\n        className: 'btn-align-right',\n        label: 'Right',\n        onClick: (function(evt) {\n          this.changeAlign(this.alignRightClassName, 'embed-align-right', evt);\n        }).bind(this),\n      }, ]\n    });\n\n    this._editor.extensions.push(this.toolbar);\n  }\n\n  changeAlign(className, action, evt) {\n    if (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n    }\n    const el = this.activeEmbedElement;\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignRightClassName,\n      this.alignCenterClassName,\n      this.alignCenterWideClassName,\n      this.alignCenterFullClassName\n    );\n    el.classList.add(className);\n\n    this.toolbar.setToolbarPosition();\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n\n  }\n\n  /**\n   * Get HTML via oEmbed proxy\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n\n  oembed(url, pasted) {\n\n    const urlOut = this.options.oembedProxy + '&url=' + url;\n    const xhr = new XMLHttpRequest();\n\n    // console.log(urlOut);\n    xhr.open(\"GET\", urlOut, true);\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        const data = JSON.parse(xhr.responseText);\n        this.embed(data.html, url, data);\n      }\n    };\n\n    xhr.send();\n\n    return true;\n  }\n\n  /**\n   * Get HTML using regexp\n   *\n   * @param {string} url\n   * @param {bool} pasted\n   * @return {void}\n   */\n\n  parseUrl(url, pasted) {\n    let html;\n\n    if (!(new RegExp(['youtube', 'youtu.be', 'vimeo', 'instagram', 'twitter', 'facebook'].join('|')).test(url))) {\n      // $.proxy(this, 'convertBadEmbed', url)();\n      return false;\n    }\n\n    html = url.replace(/\\n?/g, '')\n      .replace(/^((http(s)?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be)\\/(watch\\?v=|v\\/)?)([a-zA-Z0-9\\-_]+)(.*)?$/, '<div class=\"video video-youtube\"><iframe width=\"420\" height=\"315\" src=\"//www.youtube.com/embed/$7\" frameborder=\"0\" allowfullscreen></iframe></div>')\n      .replace(/^https?:\\/\\/vimeo\\.com(\\/.+)?\\/([0-9]+)$/, '<div class=\"video video-vimeo\"><iframe src=\"//player.vimeo.com/video/$2\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>')\n      .replace(/^https:\\/\\/twitter\\.com\\/(\\w+)\\/status\\/(\\d+)\\/?$/, '<blockquote class=\"twitter-tweet\" align=\"center\" lang=\"en\"><a href=\"https://twitter.com/$1/statuses/$2\"></a></blockquote><script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>')\n      .replace(/^(https:\\/\\/www\\.facebook\\.com\\/(.*))$/, '<script src=\"//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2\" async></script><div class=\"fb-post\" data-href=\"$1\"><div class=\"fb-xfbml-parse-ignore\"><a href=\"$1\">Loading Facebook post...</a></div></div>')\n      .replace(/^https?:\\/\\/instagram\\.com\\/p\\/(.+)\\/?$/, '<span class=\"instagram\"><iframe src=\"//instagram.com/p/$1/embed/\" width=\"612\" height=\"710\" frameborder=\"0\" scrolling=\"no\" allowtransparency=\"true\"></iframe></span>');\n\n    if ((/<(\"[^\"]*\"|'[^']*'|[^'\">])*>/).test(html) === false) {\n      // $.proxy(this, 'convertBadEmbed', url)();\n      return false;\n    }\n\n\n    if (pasted) {\n      return this.embed(html, url);\n    } else {\n      return this.embed(html);\n    }\n  };\n\n\n  /**\n   * Add html to page\n   *\n   * @param {string} html\n   * @param {string} pastedUrl\n   * @return {void}\n   */\n\n  embed(html, pastedUrl, info) {\n    let el, figure, descriptionContainer, description, metacontainer, container, overlay, lastEl, paragraph;\n\n    if (!html) {\n      console.error('Incorrect URL format specified: ', pastedUrl);\n      return false;\n    }\n\n    if (info && info.type === 'link') {\n      console.error('Just common link  no any embeds to insert: ', pastedUrl);\n      return false;\n    }\n\n    el = this._plugin.getCore().selectedElement;\n    figure = document.createElement('figure');\n    figure.classList.add('medium-editor-insert-embeds-item');\n\n    descriptionContainer = document.createElement('div');\n    descriptionContainer.classList.add(this.descriptionContainerClassName);\n\n    description = document.createElement('figcaption');\n    description.classList.add(this.descriptionClassName);\n    description.setAttribute('contenteditable', true);\n    description.setAttribute('data-placeholder', 'Type caption for embed (optional)');\n\n    metacontainer = document.createElement('div');\n    metacontainer.classList.add(this.elementClassName);\n    metacontainer.classList.add(this.alignCenterClassName);\n    paragraph = document.createElement('p');\n    paragraph.innerHTML = '<br>';\n\n    // metacontainer.classList.add(this.activeClassName);\n\n    metacontainer.setAttribute('contenteditable', false);\n\n    container = document.createElement('div');\n    container.classList.add('medium-editor-insert-embeds-item-container');\n\n    overlay = document.createElement('div');\n    overlay.classList.add(this.overlayClassName);\n\n    metacontainer.appendChild(figure);\n    figure.appendChild(container);\n    figure.appendChild(overlay);\n\n    descriptionContainer.classList.add(this.descriptionContainerClassName);\n    description.contentEditable = true;\n    description.classList.add(this.descriptionClassName);\n    description.dataset.placeholder = this.descriptionPlaceholder;\n\n    el.replaceWith(metacontainer);\n    // Insert a empty paragraph\n    if (!el.nextSibling) {\n      el.insertAdjacentElement('afterend', paragraph);\n    }\n\n    // check if embed is last element, then add one more p after it\n    lastEl = metacontainer.parentNode.lastChild;\n\n    while (lastEl && lastEl.nodeType !== 1) {\n      lastEl = lastEl.previousSibling;\n    }\n\n    if (lastEl === metacontainer) {\n      const lastP = document.createElement('p');\n      lastP.appendChild(document.createElement('br'));\n      metacontainer.parentNode.appendChild(lastP);\n    }\n\n    container.innerHTML = html;\n\n    this._editor.selectElement(metacontainer);\n\n    // console.log(html);\n    // this.core.triggerInput();\n\n    if (html.indexOf('facebook') !== -1) {\n      if (typeof(FB) !== 'undefined') {\n        setTimeout(function() {\n          FB.XFBML.parse();\n        }, 2000);\n      }\n    }\n\n    this.options.onInsert && this.options.onInsert(html);\n\n    setTimeout(() => {\n      overlay.click();\n    }, 100);\n\n    return true;\n  }\n\n  handleBlur() {\n    console.log('blur');\n    // this.cancelEmbed();\n  }\n\n  hidePlaceholder() {\n    this.el.removeAttribute('data-placeholder');\n    this.el.classList.remove('medium-editor-insert-embeds-placeholder');\n  }\n\n  cancelEmbed() {\n    this.hidePlaceholder();\n    this.el.classList.remove(this.activeClassName);\n    this.el.classList.remove(this.loadingClassName);\n\n    this._plugin.off(document, 'paste', this.instanceHandlePaste);\n    this._plugin.off(document, 'keyup', this.instanceHandleKeyUp);\n  }\n\n  destroy() {\n    this.cancelEmbed();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/Embeds.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class Images {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-camera\"></span>',\n      preview: true,\n      uploadUrl: 'upload.php',\n      deleteUrl: 'delete.php',\n      deleteMethod: 'DELETE',\n      deleteData: {},\n      onChange: (action) => {\n        console.log('Image change: ', action);\n      },\n    };\n\n    Object.assign(this.options, options);\n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n    this.elementClassName = 'medium-editor-insert-images';\n    this.loadingClassName = 'medium-editor-insert-images-loading';\n    this.activeClassName = 'medium-editor-insert-image-active';\n    this.descriptionContainerClassName = 'medium-editor-embed-image-description-container';\n    this.descriptionClassName = 'medium-editor-embed-image-description';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignRightClassName = 'align-right';\n    this.alignCenterClassName = 'align-center';\n    this.alignCenterWideClassName = 'align-center-wide';\n    this.alignCenterFullClassName = 'align-center-full';\n\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n    this.activeImageElement = null;\n    this.isLoaderShowing = false;\n    this.initToolbar();\n    this.events();\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectImage.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectImage.bind(this));\n    });\n  }\n\n  handleClick() {\n    if (this.options.onInsertButtonClick) {\n      const uid = utils.generateRandomString();\n      this.options.onInsertButtonClick(\n        (imageUrl) => this.insertImage(imageUrl, uid, false),\n        (imageUrl) => this.insertImage(imageUrl, uid, true)\n      );\n    } else {\n      this._input = document.createElement('input');\n      this._input.type = 'file';\n      this._input.multiple = true;\n      this._plugin.on(this._input, 'change', this.uploadFiles.bind(this));\n      this._input.click();\n    }\n  }\n\n  initToolbar() {\n    this.toolbar = new Toolbar({\n      plugin: this._plugin,\n      type: 'images',\n      activeClassName: this.activeClassName,\n      buttons: [{\n        name: 'image-align-left',\n        action: 'align-left',\n        className: 'btn-align-left',\n        label: 'Left',\n        title: 'Left',\n        onClick: (function(evt) {\n          this.changeAlign('align-left', 'image-align-left', evt);\n        }).bind(this),\n      }, {\n        name: 'image-align-center',\n        action: 'align-center',\n        className: 'btn-align-center',\n        label: 'Center',\n        title: 'Center',\n        onClick: (function(evt) {\n          this.changeAlign('align-center', 'image-align-center', evt);\n        }).bind(this),\n      }, {\n        name: 'image-align-center-wide',\n        action: 'align-center-wide',\n        className: 'btn-align-center-wide',\n        label: 'Wide',\n        title: 'Wide',\n        onClick: (function(evt) {\n          this.changeAlign('align-center-wide', 'image-align-center-wide', evt);\n        }).bind(this),\n      }, {\n        name: 'image-align-center-full',\n        action: 'align-center-full',\n        className: 'btn-align-center-full',\n        label: 'Full',\n        title: 'Full wide',\n        onClick: (function(evt) {\n          this.changeAlign('align-center-full', 'image-align-center-full', evt);\n        }).bind(this),\n      }, {\n        name: 'image-align-right',\n        action: 'align-right',\n        className: 'btn-align-right',\n        label: 'Right',\n        title: 'Right',\n        onClick: (function(evt) {\n          this.changeAlign('align-right', 'image-align-right', evt);\n        }).bind(this),\n      }, ]\n    });\n\n    this._editor.extensions.push(this.toolbar);\n  }\n\n  changeAlign(className, action, evt) {\n    if (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n    }\n    const el = this.activeImageElement;\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignRightClassName,\n      this.alignCenterClassName,\n      this.alignCenterWideClassName,\n      this.alignCenterFullClassName\n    );\n\n    el.classList.add(className);\n    this.toolbar.setToolbarPosition();\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n  }\n\n  uploadFiles() {\n    Array.prototype.forEach.call(this._input.files, (file) => {\n      // Generate uid for this image, so we can identify it later\n      // and we can replace preview image with uploaded one\n      const uid = utils.generateRandomString();\n\n      if (this.options.preview) {\n        this.preview(file, uid);\n      }\n\n      this.upload(file, uid);\n    });\n  }\n\n  preview(file, uid) {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      this.insertImage(e.target.result, uid);\n    };\n\n    reader.readAsDataURL(file);\n  }\n\n  upload(file, uid) {\n    const xhr = new XMLHttpRequest(),\n      data = new FormData();\n    const insertImage = this.insertImage.bind(this);\n\n    xhr.open(\"POST\", this.options.uploadUrl, true);\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        insertImage(xhr.responseText, utils.generateRandomString());\n      }\n    };\n\n    data.append(\"file\", file);\n    xhr.send(data);\n  }\n\n  insertImage(imageUrl, uid, isLoader) {\n    const paragraph = this._plugin.getCore().selectedElement;\n\n    // Replace paragraph with div, because figure is a block element\n    // and can't be nested inside paragraphs\n    if (paragraph.nodeName.toLowerCase() === 'p') {\n      const div = document.createElement('div');\n\n      paragraph.parentNode.insertBefore(div, paragraph);\n      this._plugin.getCore().selectElement(div);\n      paragraph.remove();\n    }\n    // const el = this._plugin.getCore().selectedElement\n    // const image = el.querySelector(`[data-uid=\"${uid}\"]`);\n\n    this._plugin.getCore().hideButtons();\n\n    return this.addImage(imageUrl, uid, isLoader);\n  }\n\n  addParagraph(el) {\n    const paragraph = document.createElement('p');\n    paragraph.innerHTML = '<br>';\n    el.insertAdjacentElement('afterend', paragraph);\n  }\n\n  addImage(url, uid, isLoader) {\n    return new Promise((resolve, reject) => {\n      const el = this._plugin.getCore().selectedElement,\n        figure = document.createElement('figure'),\n        img = document.createElement('img'),\n        descriptionContainer = document.createElement('div'),\n        description = document.createElement('figcaption');\n      let domImage;\n\n      img.alt = '';\n\n      if (uid) {\n        img.setAttribute('data-uid', uid);\n      }\n\n      descriptionContainer.classList.add(this.descriptionContainerClassName);\n      description.contentEditable = true;\n      description.classList.add(this.descriptionClassName);\n      description.dataset.placeholder = this.descriptionPlaceholder;\n\n      // If we're dealing with a preview image,\n      // we don't have to preload it before displaying\n      if (url.match(/^data:/)) {\n        if (!isLoader) {\n          el.innerHTML = '';\n          el.classList.remove(this.loadingClassName);\n          this.isLoaderShowing = false;\n        }\n\n        img.src = url;\n        figure.appendChild(img);\n        el.appendChild(figure);\n\n\n      } else {\n        domImage = new Image();\n        domImage.onload = () => {\n          img.src = domImage.src;\n          if (!isLoader) {\n            img.classList.add(this.activeClassName);\n          }\n          figure.appendChild(img);\n          descriptionContainer.appendChild(description);\n          figure.appendChild(descriptionContainer);\n\n          if (!isLoader) {\n            el.innerHTML = '';\n            el.classList.remove(this.loadingClassName);\n            this.isLoaderShowing = false;\n          }\n\n\n          if (isLoader) {\n            this.isLoaderShowing = true;\n            el.classList.add(this.loadingClassName);\n          }\n\n          el.appendChild(figure);\n\n          if ((!el.nextSibling || !el.nextSibling.nextSibling) && !isLoader) {\n            this.addParagraph(el);\n          }\n\n          // Resolve with domImage so we can test this function easily\n          resolve(domImage);\n        };\n\n        domImage.src = url;\n      }\n\n      el.classList.add(this.elementClassName);\n      el.classList.add(this.alignCenterClassName);\n\n      el.contentEditable = false;\n\n    });\n  }\n\n  replaceImage(image, url) {\n    const domImage = new Image();\n    const el = this._plugin.getCore().selectedElement;\n\n    if (!el.nextSibling || !el.nextSibling.nextSibling) {\n      this.addParagraph(el);\n    }\n\n    domImage.onload = () => {\n      image.src = domImage.src;\n      image.removeAttribute('data-uid');\n    };\n\n    domImage.src = url;\n\n    // Return domImage so we can test this function easily\n    return domImage;\n  }\n\n  selectImage(e) {\n    const el = e.target;\n    this.selectImageCore(el);\n  }\n\n  selectImageCore(el) {\n    if (el.nodeName.toLowerCase() === 'img' && utils.getClosestWithClassName(el, this.elementClassName)) {\n      const parentNode = el.parentNode.parentNode;\n\n      if (!parentNode.classList.contains(this.loadingClassName)) {\n        el.classList.add(this.activeClassName);\n        // parentNode.classList.add(this.activeClassName);\n        // TODO: The value is correct, but the medium sometimes change\n        this._editor.selectElement(parentNode);\n        this.activeImageElement = parentNode;\n      }\n    }\n  }\n\n\n  unselectImage(e) {\n    const el = e.target;\n    let clickedImage, images;\n\n    if (el.classList.contains(this.descriptionClassName)) return false;\n\n    // Unselect all selected images. If an image is clicked, unselect all except this one.\n    if (el.nodeName.toLowerCase() === 'img' && el.classList.contains(this.activeClassName)) {\n      clickedImage = el;\n    }\n\n    images = utils.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName);\n    Array.prototype.forEach.call(images, (image) => {\n      if (image !== clickedImage) {\n        image.classList.remove(this.activeClassName);\n      }\n    });\n    this.activeImage = null;\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n    const isDescriptionElement = target && target.classList && target.classList.contains(this.descriptionClassName);\n\n    // Enter key in description\n    if ([MediumEditor.util.keyCode.ENTER].indexOf(e.which) > -1) {\n      if (isDescriptionElement) {\n        // Enter in description\n       e.preventDefault(); //Prevent default browser behavior\n\n       if (window.getSelection) {\n         const selection = window.getSelection();\n         const range = selection.getRangeAt(0);\n         const br = document.createElement(\"br\");\n         const textNode = document.createTextNode(\"\\u00a0\");\n         range.deleteContents();\n         range.insertNode(br);\n         range.collapse(false);\n         range.insertNode(textNode);\n         range.selectNodeContents(textNode);\n\n         selection.removeAllRanges();\n         selection.addRange(range);\n       }\n        return false;\n      }\n    }\n\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1 && !isDescriptionElement) {\n      this.removeImage(e);\n    }\n\n  // Down\n    if (e.which === 40) {\n      // Detect selected image\n      const selectedImageDOM = document.querySelector(`.${this.activeClassName}`);\n      const selectedImageParentDOM = selectedImageDOM && selectedImageDOM.parentNode.parentNode;\n      if (selectedImageParentDOM) {\n        let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\n        if (!nextSiblingParagraphDOM) {\n          // Insert paragraph and focus\n          this.addParagraph(selectedImageParentDOM);\n        }\n\n        // Focus next paragraph\n        nextSiblingParagraphDOM = this.getSiblingParagraph(selectedImageParentDOM);\n\n        if (nextSiblingParagraphDOM) {\n          if (!nextSiblingParagraphDOM.innerHTML) {\n            nextSiblingParagraphDOM.innerHTML = '<br>';\n          }\n          window.getSelection().removeAllRanges();\n          this._plugin.getCore()._editor.selectElement(nextSiblingParagraphDOM);\n          MediumEditor.selection.clearSelection(document, true);\n          selectedImageDOM.classList.remove(this.activeClassName);\n          e.preventDefault();\n        }\n      }\n    }\n\n    // Enter\n    if (e.which === 13) {\n        const selectedImageDOM = document.querySelector(`.${this.activeClassName}`);\n        const selectedImageParentDOM = selectedImageDOM && selectedImageDOM.parentNode.parentNode;\n        if (selectedImageParentDOM) {\n            const paragraph = document.createElement('p');\n            paragraph.innerHTML = '<br>';\n            selectedImageParentDOM.insertAdjacentElement('beforeBegin', paragraph);\n\n            window.getSelection().removeAllRanges();\n            this._plugin.getCore()._editor.selectElement(paragraph);\n            selectedImageDOM.classList.remove(this.activeClassName);\n            e.preventDefault();\n        }\n    }\n  }\n\n  removeImage(e) {\n    const images = utils.getElementsByClassName(this._plugin.getEditorElements(), this.activeClassName),\n      selection = window.getSelection();\n    let selectedHtml;\n\n    // Remove image even if it's not selected, but backspace/del is pressed in text\n    if (selection && selection.rangeCount) {\n      const range = MediumEditor.selection.getSelectionRange(document),\n        focusedElement = MediumEditor.selection.getSelectedParentElement(range),\n        caretPosition = MediumEditor.selection.getCaretOffsets(focusedElement).left;\n      let sibling;\n      // Is backspace pressed and caret is at the beginning of a paragraph, get previous element\n      if (e.which === MediumEditor.util.keyCode.BACKSPACE && caretPosition === 0) {\n        if (focusedElement.innerHTML === '<br>') {\n            // If it is a empty paragraph than not remove prev image\n            return false;\n        }\n        sibling = focusedElement.previousElementSibling;\n        // Is del pressed and caret is at the end of a paragraph, get next element\n      } else if (e.which === MediumEditor.util.keyCode.DELETE && caretPosition === focusedElement.innerText.length) {\n        sibling = focusedElement.nextElementSibling;\n      }\n\n      if (sibling && sibling.classList.contains('medium-editor-insert-images')) {\n        const newImages = sibling.getElementsByTagName('img');\n        Array.prototype.forEach.call(newImages, (image) => {\n          images.push(image);\n        });\n      }\n\n      // If text is selected, find images in the selection\n      selectedHtml = MediumEditor.selection.getSelectionHtml(document);\n      if (selectedHtml) {\n        const temp = document.createElement('div');\n        let wrappers, newImages;\n        temp.innerHTML = selectedHtml;\n\n        wrappers = temp.getElementsByClassName('medium-editor-insert-images');\n        newImages = utils.getElementsByTagName(wrappers, 'img');\n\n        Array.prototype.forEach.call(newImages, (image) => {\n          images.push(image);\n        });\n      }\n    }\n\n    if (images.length) {\n      if (!selectedHtml) {\n        e.preventDefault();\n      }\n\n      images.forEach((image) => {\n        const wrapper = utils.getClosestWithClassName(image, 'medium-editor-insert-images');\n        this.deleteFile(image.src);\n\n        image.parentNode.remove();\n\n        // If wrapper has no images anymore, remove it\n        if (wrapper.childElementCount === 0) {\n          const next = wrapper.nextElementSibling,\n            prev = wrapper.previousElementSibling;\n\n          wrapper.remove();\n\n          // If there is no selection, move cursor at the beginning of next paragraph (if delete is pressed),\n          // or nove it at the end of previous paragraph (if backspace is pressed)\n          if (!selectedHtml) {\n            if (next || prev) {\n              if ((next && e.which === MediumEditor.util.keyCode.DELETE) || !prev) {\n                MediumEditor.selection.moveCursor(document, next, 0);\n              } else {\n                MediumEditor.selection.moveCursor(document, prev.lastChild, prev.lastChild.textContent.length);\n              }\n            }\n          }\n        }\n      });\n    }\n  }\n\n  deleteFile(image) {\n    if (this.options.deleteUrl) {\n      const xhr = new XMLHttpRequest(),\n        data = Object.assign({}, {\n          file: image\n        }, this.options.deleteData);\n\n      xhr.open(this.options.deleteMethod, this.options.deleteUrl, true);\n      xhr.send(data);\n    }\n  }\n\n  destroy() {\n\n  }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/Images.js","import utils from '../utils';\nimport Toolbar from '../Toolbar';\n\nexport default class PayWall {\n\n  constructor(plugin, options) {\n    this.options = {\n      label: '<span class=\"fa fa-scissors\"></span>',\n      captions: true,\n      storeMeta: false,\n      styles: {\n        left: {\n          label: '<span class=\"fa fa-align-left\"></span>'\n        },\n        wide: {\n          label: '<span class=\"fa fa-align-justify\"></span>'\n        },\n      },\n      actions: {\n        remove: {\n          label: '<span class=\"fa fa-times\"></span>',\n          clicked: function() {\n            // var $event = $.Event('keydown');\n\n            // $event.which = 8;\n            // $(document).trigger($event);\n          }\n        }\n      },\n      parseOnPaste: false,\n    };\n\n    Object.assign(this.options, options);\n\n    this._plugin = plugin;\n    this._editor = this._plugin.base;\n\n    this.activeClassName = 'medium-editor-insert-embed-paywall-active';\n    this.elementClassName = 'medium-editor-insert-embed-paywall';\n\n    this.alignLeftClassName = 'align-left';\n    this.alignCenterClassName = 'align-center-wide';\n\n    this.label = this.options.label;\n    this.descriptionPlaceholder = this.options.descriptionPlaceholder;\n\n    this.events();\n\n  }\n\n  events() {\n    this._plugin.on(document, 'click', this.unselectEmbed.bind(this));\n    this._plugin.on(document, 'keydown', this.handleKey.bind(this));\n\n    this._plugin.getEditorElements().forEach((editor) => {\n      this._plugin.on(editor, 'click', this.selectEmbed.bind(this));\n    });\n  }\n\n  selectEmbed(e) {\n    const el = e.target;\n    if (this.getClosestElementByClassName(el, this.elementClassName)) {\n      this.selectEmbedCore(el, event);\n      e && e.stopPropagation();\n      e && e.preventDefault();\n    }\n  }\n\n  getClosestElementByClassName(el, className) {\n    while (el) {\n      if (el.classList && el.classList.contains(className)) return el;\n      el = el.parentNode;\n    }\n  }\n\n\n  selectEmbedCore(el) {\n    const element = this.getClosestElementByClassName(el, this.elementClassName);\n    element.classList.add(this.activeClassName);\n    const currentSelection = window.getSelection();\n  }\n\n  unselectEmbed(e) {\n    const el = e.target;\n    this.unselectEmbedCore(el);\n  }\n\n  unselectEmbedCore(el) {\n    let clickedEmbed, clickedEmbedPlaceholder, paywall, embedsPlaceholders;\n\n    paywall = utils.getElementsByClassName(this._plugin.getEditorElements(), this.elementClassName);\n    if (!paywall || !paywall.length) {\n      return false;\n    }\n\n    if (paywall) {\n      Array.prototype.forEach.call(paywall, (paywall) => {\n        if (paywall !== clickedEmbed) {\n          paywall.classList.remove(this.activeClassName);\n        }\n      });\n    }\n  }\n\n  getSiblingParagraph(el) {\n    if (!el) return false;\n\n    let nextSiblingDOM = el.nextSibling;\n    let nextSiblingParagraphDOM;\n\n    while (nextSiblingDOM && !nextSiblingParagraphDOM) {\n      if (nextSiblingDOM && nextSiblingDOM.tagName === 'P') {\n        nextSiblingParagraphDOM = nextSiblingDOM;\n      } else {\n        nextSiblingDOM = nextSiblingDOM.nextSibling;\n      }\n    }\n\n    return nextSiblingParagraphDOM;\n  }\n\n  handleKey(e) {\n    const target = e.target;\n\n    // Backspace, delete\n    if ([MediumEditor.util.keyCode.BACKSPACE, MediumEditor.util.keyCode.DELETE].indexOf(e.which) > -1) {\n      this.removeEmbed(e);\n    } else if (document.querySelector(`.${this.activeClassName}`)) {\n      // Block all keys\n      e.preventDefault();\n    }\n  }\n\n  setFocusOnElement(el) {\n    // this._editor.elements[0].focus();\n    setTimeout(() => {\n      const currentSelection = window.getSelection();\n      const range = document.createRange();\n      range.setStart(el, 0);\n      currentSelection.removeAllRanges();\n      currentSelection.addRange(range);\n    }, 300);\n  }\n\n  handleClick() {\n    this.el = this._plugin.getCore().selectedElement;\n    this.setFocusOnElement(this.el);\n    this.embedPaywall(this.el);\n  }\n\n  removeEmbed(e) {\n    const selectedEmbedDOM = document.querySelector(`.${this.activeClassName}`);\n    if (selectedEmbedDOM) {\n      selectedEmbedDOM.remove();\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n\n  /**\n   * Init Toolbar for tuning paywall position\n   *\n   * @param {string} url\n   * @param {pasted} boolean\n   * @return {void}\n   */\n  initToolbar() {\n  }\n\n  changeAlign(className, action, evt) {\n    if (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n    }\n\n    const el = document.querySelector(`.${this.activeClassName}`);\n    el.classList.remove(\n      this.alignLeftClassName,\n      this.alignCenterClassName,\n    );\n    el.classList.add(className);\n\n    this.toolbar.setToolbarPosition();\n\n    if (this.options.onChange) {\n      this.options.onChange(action);\n    }\n\n  }\n\n  /**\n   * Add html to page\n   *\n   * @param {string} html\n   * @param {string} pastedUrl\n   * @return {void}\n   */\n\n  embedPaywall(el) {\n    // Remove old paywall\n    const prevPaywallDOM = document.querySelector(`.${this.elementClassName}`);\n    if (prevPaywallDOM) {\n      prevPaywallDOM.remove();\n    }\n\n    // Insert new paywall\n    const paywall = document.createElement('div');\n    paywall.setAttribute(\"contenteditable\", false);\n    paywall.innerHTML = '<div></div>';\n    paywall.classList.add(this.elementClassName);\n\n    el.replaceWith(paywall);\n\n    const selectedEmbedDOM = document.querySelector(`.${this.elementClassName}`);\n\n    if (selectedEmbedDOM) {\n      let nextSiblingParagraphDOM = this.getSiblingParagraph(selectedEmbedDOM);\n\n      if (!nextSiblingParagraphDOM) {\n        // Insert paragraph and focus\n        const paragraph = document.createElement('p');\n        paragraph.innerHTML = '<br>';\n        selectedEmbedDOM.insertAdjacentElement('afterend', paragraph);\n      }\n    }\n\n    this.options.onInsert && this.options.onInsert();\n\n    return true;\n  }\n\n\n  destroy() {\n    this.cancelEmbed();\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/addons/PayWall.js"],"sourceRoot":""}